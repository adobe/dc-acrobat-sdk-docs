
<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Learn how to integrate PDF product and features in your apps with the Acrobat and PDFL APIs. Create apps that integrate with and leverage features across Adobe's enterprise-class product lineup."
  
  <!-- Ben removed the title tag -->
  

  
   <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link href="../../_static/jquery-ui.css" rel="stylesheet" />  
  <link href="../../_static/copybutton.css" rel="stylesheet" />
  <link rel="stylesheet" href="../../_static/theme_overrides.css" type="text/css" />

      <link rel="shortcut icon" href="../../_static/favicon.ico" />  
  
  
  <link rel="canonical" href="https://www.adobe.com/go/acrobatsdk_homeIAC_DevApp_OLE_Support.html" />
  

  
  
  
  <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
  <script type="text/javascript" src="../../_static/jquery.js"></script>
  <script type="text/javascript" src="../../_static/underscore.js"></script>
  <script type="text/javascript" src="../../_static/doctools.js"></script>
  <script type="text/javascript" src="../../_static/language_data.js"></script>
  <script type="text/javascript" src="../../_static/searchtools.js"></script>
  <script type="text/javascript" src="../../_static/clipboard.min.js"></script>
  <script type="text/javascript" src="../../_static/copybutton.js"></script>
  <script type="text/javascript" src="../../_static/js/theme.js"></script>
   
  
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Using DDE" href="IAC_DevApp_DDE_Support.html" />
    <link rel="prev" title="Developing for Interapplication Communication" href="index.html" /> 
  
<script type='text/javascript'> window.marketingtech = { adobe: { launch: { property: "global", environment: "production" } }, };</script>
<script src="https://www.adobe.com/marketingtech/main.min.js"></script>

	<script>
    $(document).ready(function () {
      $(window).scroll(function () {
        if ($(this).scrollTop() >= 50) {
          $('.fixedbar, .wy-nav-side').addClass('scroll');
          $('.wy-top-menu-wrapper').fadeOut();
        } else {
          $('.fixedbar, .wy-nav-side').removeClass('scroll');
          $('.wy-top-menu-wrapper').fadeIn();
        }
      });
      $(window).scroll(function () {
        if ($(this).scrollTop() > 100) {
          $('#scroll').fadeIn();
        } else {
          $('#scroll').fadeOut();
        }
      });
      $('#scroll').click(function () {
        $("html, body").animate({ scrollTop: 0 }, 600);
        return false;
      });
    });
  </script>

<style>
  .wy-nav-content {max-width:90%}
  </style>
</head>

<body class="wy-body-for-nav">

  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
	  
	  	  
<!-- @@@@@@@@@@@@@@@@ Custom @@@@@@@@@@@@@@@@ -->
        <div class="wy-logo-wrapper"> 
          <a href="https://www.adobe.com/go/dc_developer">
            <img src="../../_static/acrobaticon.png" class="logo"/> 
          Acrobat and PDFL Developer Guides
          </a>
        </div> 
 <!-- @@@@@@@@@@@@@@@@ Custom @@@@@@@@@@@@@@@@ -->
 
        <div class="wy-side-nav-search" >
          

          
            <a href="toc.html" class="icon icon-home"> Acrobat-PDFL SDK: Interapplication Communication
          

          
          </a>

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="index.html">Developing for Interapplication Communication</a><ul>
<li class="toctree-l2"><a class="reference internal" href="index.html#about-the-api-object-layers">About the API object layers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#object-reference-syntax">Object reference syntax</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#objects-in-the-acrobat-application-layer">Objects in the Acrobat application layer</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#objects-in-the-portable-document-layer">Objects in the portable document layer</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#plugins-for-extending-the-iac-interfaces">Plugins for extending the IAC interfaces</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#developing-for-acrobat-reader">Developing for Acrobat Reader</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#dde-messages">DDE messages</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#apple-events">Apple events</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Using OLE</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#ole-capabilities-in-acrobat">OLE capabilities in Acrobat</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#on-screen-rendering">On-screen rendering</a></li>
<li class="toctree-l3"><a class="reference internal" href="#remote-control-of-acrobat">Remote control of Acrobat</a></li>
<li class="toctree-l3"><a class="reference internal" href="#pdf-browser-controls">PDF browser controls</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#development-environment-considerations">Development environment considerations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#environment-configuration">Environment configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="#necessary-c-knowledge">Necessary C knowledge</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#using-the-acrobat-ole-interfaces">Using the Acrobat OLE interfaces</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#about-the-cacro-classes">About the CAcro classes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#about-the-coledispatchdriver-class">About the COleDispatchDriver class</a></li>
<li class="toctree-l3"><a class="reference internal" href="#using-coledispatchdriver-objects-and-methods">Using COleDispatchDriver objects and methods</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#using-the-jsobject-interface">Using the JSObject interface</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#adding-a-reference-to-the-acrobat-type-library">Adding a reference to the Acrobat type library</a></li>
<li class="toctree-l3"><a class="reference internal" href="#creating-a-simple-application">Creating a simple application</a></li>
<li class="toctree-l3"><a class="reference internal" href="#working-with-annotations">Working with annotations</a></li>
<li class="toctree-l3"><a class="reference internal" href="#spell-checking-a-document">Spell-checking a document</a></li>
<li class="toctree-l3"><a class="reference internal" href="#tips-for-translating-javascript-to-jsobject">Tips for translating JavaScript to JSObject</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#other-development-topics">Other development topics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#synchronous-messaging">Synchronous messaging</a></li>
<li class="toctree-l3"><a class="reference internal" href="#mdi-applications">MDI applications</a></li>
<li class="toctree-l3"><a class="reference internal" href="#event-handling-in-child-windows">Event handling in child windows</a></li>
<li class="toctree-l3"><a class="reference internal" href="#determining-if-an-acrobat-application-is-running">Determining if an Acrobat application is running</a></li>
<li class="toctree-l3"><a class="reference internal" href="#exiting-from-an-application">Exiting from an application</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#summary-of-ole-objects-and-methods">Summary of OLE objects and methods</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="IAC_DevApp_DDE_Support.html">Using DDE</a></li>
<li class="toctree-l1"><a class="reference internal" href="IAC_DevApp_AppleEvents.html">Using Apple Events</a></li>
<li class="toctree-l1"><a class="reference internal" href="IAC_API_OLE_Objects.html">OLE Automation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="IAC_API_OLE_Objects.html#acroexch-app">AcroExch.App</a><ul>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#methods">Methods</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#closealldocs">CloseAllDocs</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#exit">Exit</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#getactivedoc">GetActiveDoc</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#getactivetool">GetActiveTool</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#getavdoc">GetAVDoc</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#getframe">GetFrame</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#getinterface">GetInterface</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#getlanguage">GetLanguage</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#getnumavdocs">GetNumAVDocs</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#getpreferenceex">GetPreferenceEx</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#hide">Hide</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#lock">Lock</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#minimize">Minimize</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#maximize">Maximize</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#menuitemexecute">MenuItemExecute</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#menuitemisenabled">MenuItemIsEnabled</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#menuitemismarked">MenuItemIsMarked</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#menuitemremove">MenuItemRemove</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#restore">Restore</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#setactivetool">SetActiveTool</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#setframe">SetFrame</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#setpreference">SetPreference</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#setpreferenceex">SetPreferenceEx</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#show">Show</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#toolbuttonisenabled">ToolButtonIsEnabled</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#toolbuttonremove">ToolButtonRemove</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#unlock">Unlock</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#unlockex">UnlockEx</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="IAC_API_OLE_Objects.html#acroexch-avdoc">AcroExch.AVDoc</a><ul>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#methods-1">Methods</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#bringtofront">BringToFront</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#clearselection">ClearSelection</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#close">Close</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#findtext">FindText</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#getavpageview">GetAVPageView</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#getframe-1">GetFrame</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#getpddoc">GetPDDoc</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#gettitle">GetTitle</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#getviewmode">GetViewMode</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#isvalid">IsValid</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#maximize-1">Maximize</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#open">Open</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#openinwindow">OpenInWindow</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#openinwindowex">OpenInWindowEx</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#printpages">PrintPages</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#printpagesex">PrintPagesEx</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#printpagessilent">PrintPagesSilent</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#printpagessilentex">PrintPagesSilentEx</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#setframe-1">SetFrame</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#settextselection">SetTextSelection</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#settitle">SetTitle</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#setviewmode">SetViewMode</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#showtextselect">ShowTextSelect</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="IAC_API_OLE_Objects.html#acroexch-avpageview">AcroExch.AVPageView</a><ul>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#methods-2">Methods</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#devicepointtopage">DevicePointToPage</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#dogoback">DoGoBack</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#dogoforward">DoGoForward</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#getaperture">GetAperture</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#getavdoc-1">GetAVDoc</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#getdoc">GetDoc</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#getpage">GetPage</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#getpagenum">GetPageNum</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#getzoom">GetZoom</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#getzoomtype">GetZoomType</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#goto">Goto</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#pointtodevice">PointToDevice</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#readpagedown">ReadPageDown</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#readpageup">ReadPageUp</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#scrollto">ScrollTo</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#zoomto">ZoomTo</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="IAC_API_OLE_Objects.html#acroexch-hilitelist">AcroExch.HiliteList</a><ul>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#add">Add</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="IAC_API_OLE_Objects.html#acroexch-pdannot">AcroExch.PDAnnot</a><ul>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#methods-3">Methods</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#getcolor">GetColor</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#getcontents">GetContents</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#getdate">GetDate</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#getrect">GetRect</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#getsubtype">GetSubtype</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#gettitle-1">GetTitle</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#isequal">IsEqual</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#isopen">IsOpen</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#isvalid-1">IsValid</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#perform">Perform</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#setcolor">SetColor</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#setcontents">SetContents</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#setdate">SetDate</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#setopen">SetOpen</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#setrect">SetRect</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#settitle-1">SetTitle</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="IAC_API_OLE_Objects.html#acroexch-pdbookmark">AcroExch.PDBookmark</a><ul>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#methods-4">Methods</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#destroy">Destroy</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#getbytitle">GetByTitle</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#gettitle-2">GetTitle</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#isvalid-2">IsValid</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#perform-1">Perform</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#settitle-2">SetTitle</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="IAC_API_OLE_Objects.html#acroexch-pddoc">AcroExch.PDDoc</a><ul>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#methods-5">Methods</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#acquirepage">AcquirePage</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#clearflags">ClearFlags</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#close-1">Close</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#create">Create</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#createtextselect">CreateTextSelect</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#createthumbs">CreateThumbs</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#croppages">CropPages</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#deletepages">DeletePages</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#deletethumbs">DeleteThumbs</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#getfilename">GetFileName</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#getflags">GetFlags</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#getinfo">GetInfo</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#getinstanceid">GetInstanceID</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#getjsobject">GetJSObject</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#getnumpages">GetNumPages</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#getpagemode">GetPageMode</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#getpermanentid">GetPermanentID</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#insertpages">InsertPages</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#movepage">MovePage</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#open-1">Open</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#openavdoc">OpenAVDoc</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#replacepages">ReplacePages</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#save">Save</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#setflags">SetFlags</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#setinfo">SetInfo</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="IAC_API_OLE_Objects.html#acroexch-pdpage">AcroExch.PDPage</a><ul>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#methods-6">Methods</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#addannot">AddAnnot</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#addnewannot">AddNewAnnot</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#copytoclipboard">CopyToClipboard</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#createpagehilite">CreatePageHilite</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#createwordhilite">CreateWordHilite</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#croppage">CropPage</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#draw">Draw</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#drawex">DrawEx</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#getannot">GetAnnot</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#getannotindex">GetAnnotIndex</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#getdoc-1">GetDoc</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#getnumannots">GetNumAnnots</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#getnumber">GetNumber</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#getrotate">GetRotate</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#getsize">GetSize</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#removeannot">RemoveAnnot</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#setrotate">SetRotate</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="IAC_API_OLE_Objects.html#acroexch-pdtextselect">AcroExch.PDTextSelect</a><ul>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#methods-7">Methods</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#destroy-1">Destroy</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#getboundingrect">GetBoundingRect</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#getnumtext">GetNumText</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#getpage-1">GetPage</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#gettext">GetText</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="IAC_API_OLE_Objects.html#acroexch-point">AcroExch.Point</a><ul>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#x">X</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#y">Y</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="IAC_API_OLE_Objects.html#acroexch-rect">AcroExch.Rect</a><ul>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#bottom">Bottom</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#left">Left</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#right">Right</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#top">Top</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="IAC_API_OLE_Objects.html#acroexch-time">AcroExch.Time</a><ul>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#date">Date</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#hour">Hour</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#millisecond">Millisecond</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#minute">Minute</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#month">Month</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#second">Second</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#year">Year</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="IAC_API_OLE_Objects.html#axacropdflib-axacropdf">AxAcroPDFLib.AxAcroPDF</a><ul>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#methods-8">Methods</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#getversions">GetVersions</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#gobackwardstack">GoBackwardStack</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#goforwardstack">GoForwardStack</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#gotofirstpage">GotoFirstPage</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#gotolastpage">GotoLastPage</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#gotonextpage">GotoNextPage</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#gotopreviouspage">GotoPreviousPage</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#loadfile">LoadFile</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#print">Print</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#printall">PrintAll</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#printallfit">PrintAllFit</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#printpages-1">PrintPages</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#printpagesfit">PrintPagesFit</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#printwithdialog">PrintWithDialog</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#setcurrenthighlight">SetCurrentHighlight</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#setcurrentpage">SetCurrentPage</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#setlayoutmode">SetLayoutMode</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#setnameddest">SetNamedDest</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#setpagemode">SetPageMode</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#setshowscrollbars">SetShowScrollbars</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#setshowtoolbar">SetShowToolbar</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#setview">SetView</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#setviewrect">SetViewRect</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#setviewscroll">SetViewScroll</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#setzoom">SetZoom</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#setzoomscroll">SetZoomScroll</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_OLE_Objects.html#src">Src</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="IAC_API_DDE_Messages.html">DDE Messages</a><ul>
<li class="toctree-l2"><a class="reference internal" href="IAC_API_DDE_Messages.html#id14">AppExit</a></li>
<li class="toctree-l2"><a class="reference internal" href="IAC_API_DDE_Messages.html#id15">AppHide</a></li>
<li class="toctree-l2"><a class="reference internal" href="IAC_API_DDE_Messages.html#id16">AppShow</a></li>
<li class="toctree-l2"><a class="reference internal" href="IAC_API_DDE_Messages.html#id17">CloseAllDocs</a></li>
<li class="toctree-l2"><a class="reference internal" href="IAC_API_DDE_Messages.html#id18">DocClose</a></li>
<li class="toctree-l2"><a class="reference internal" href="IAC_API_DDE_Messages.html#id19">DocDeletePages</a></li>
<li class="toctree-l2"><a class="reference internal" href="IAC_API_DDE_Messages.html#id20">DocFind</a></li>
<li class="toctree-l2"><a class="reference internal" href="IAC_API_DDE_Messages.html#id21">DocGoTo</a></li>
<li class="toctree-l2"><a class="reference internal" href="IAC_API_DDE_Messages.html#id22">DocGoToNameDest</a></li>
<li class="toctree-l2"><a class="reference internal" href="IAC_API_DDE_Messages.html#id23">DocInsertPages</a></li>
<li class="toctree-l2"><a class="reference internal" href="IAC_API_DDE_Messages.html#id24">DocOpen</a></li>
<li class="toctree-l2"><a class="reference internal" href="IAC_API_DDE_Messages.html#id25">DocPageDown</a></li>
<li class="toctree-l2"><a class="reference internal" href="IAC_API_DDE_Messages.html#id26">DocPageLeft</a></li>
<li class="toctree-l2"><a class="reference internal" href="IAC_API_DDE_Messages.html#id27">DocPageRight</a></li>
<li class="toctree-l2"><a class="reference internal" href="IAC_API_DDE_Messages.html#id28">DocPageUp</a></li>
<li class="toctree-l2"><a class="reference internal" href="IAC_API_DDE_Messages.html#id29">DocPrint</a></li>
<li class="toctree-l2"><a class="reference internal" href="IAC_API_DDE_Messages.html#id30">DocReplacePages</a></li>
<li class="toctree-l2"><a class="reference internal" href="IAC_API_DDE_Messages.html#id31">DocSave</a></li>
<li class="toctree-l2"><a class="reference internal" href="IAC_API_DDE_Messages.html#id32">DocSaveAs</a></li>
<li class="toctree-l2"><a class="reference internal" href="IAC_API_DDE_Messages.html#id33">DocScrollTo</a></li>
<li class="toctree-l2"><a class="reference internal" href="IAC_API_DDE_Messages.html#id34">DocSetViewMode</a></li>
<li class="toctree-l2"><a class="reference internal" href="IAC_API_DDE_Messages.html#id35">DocZoomTo</a></li>
<li class="toctree-l2"><a class="reference internal" href="IAC_API_DDE_Messages.html#id36">FileOpen</a></li>
<li class="toctree-l2"><a class="reference internal" href="IAC_API_DDE_Messages.html#id37">FileOpenEx</a></li>
<li class="toctree-l2"><a class="reference internal" href="IAC_API_DDE_Messages.html#id38">FilePrint</a></li>
<li class="toctree-l2"><a class="reference internal" href="IAC_API_DDE_Messages.html#id39">FilePrintEx</a></li>
<li class="toctree-l2"><a class="reference internal" href="IAC_API_DDE_Messages.html#id40">FilePrintSilent</a></li>
<li class="toctree-l2"><a class="reference internal" href="IAC_API_DDE_Messages.html#id41">FilePrintSilentEx</a></li>
<li class="toctree-l2"><a class="reference internal" href="IAC_API_DDE_Messages.html#id42">FilePrintTo</a></li>
<li class="toctree-l2"><a class="reference internal" href="IAC_API_DDE_Messages.html#id43">FilePrintToEx</a></li>
<li class="toctree-l2"><a class="reference internal" href="IAC_API_DDE_Messages.html#fullmenus">FullMenus</a></li>
<li class="toctree-l2"><a class="reference internal" href="IAC_API_DDE_Messages.html#id44">HideToolbar</a></li>
<li class="toctree-l2"><a class="reference internal" href="IAC_API_DDE_Messages.html#id45">MenuitemExecute</a></li>
<li class="toctree-l2"><a class="reference internal" href="IAC_API_DDE_Messages.html#shortmenus">ShortMenus</a></li>
<li class="toctree-l2"><a class="reference internal" href="IAC_API_DDE_Messages.html#id46">ShowToolbar</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="IAC_API_AppleEvtObjects.html">Apple Event Objects and Apple Events</a><ul>
<li class="toctree-l2"><a class="reference internal" href="IAC_API_AppleEvtObjects.html#objects">Objects</a><ul>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_AppleEvtObjects.html#annotation">annotation</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_AppleEvtObjects.html#application">application</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_AppleEvtObjects.html#avpageview">AVPageView</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_AppleEvtObjects.html#bookmark">bookmark</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_AppleEvtObjects.html#conversion">conversion</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_AppleEvtObjects.html#eps-conversion">EPS Conversion</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_AppleEvtObjects.html#link-annotation">Link Annotation</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_AppleEvtObjects.html#menu">menu</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_AppleEvtObjects.html#menu-item">menu item</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_AppleEvtObjects.html#pdannot">PDAnnot</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_AppleEvtObjects.html#pdbookmark">PDBookMark</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_AppleEvtObjects.html#pdlinkannot">PDLinkAnnot</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_AppleEvtObjects.html#pdpage">PDPage</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_AppleEvtObjects.html#pdtextannot">PDTextAnnot</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_AppleEvtObjects.html#pdf-window">PDF Window</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_AppleEvtObjects.html#postscript-conversion">PostScript Conversion</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_AppleEvtObjects.html#text-annotation">Text Annotation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="IAC_API_AppleEvtObjects.html#required-suite-events">Required suite events</a><ul>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_AppleEvtObjects.html#open">open</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_AppleEvtObjects.html#print">print</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_AppleEvtObjects.html#quit">quit</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_AppleEvtObjects.html#run">run</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="IAC_API_AppleEvtObjects.html#core-suite-events">Core suite events</a><ul>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_AppleEvtObjects.html#close">close</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_AppleEvtObjects.html#count">count</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_AppleEvtObjects.html#delete">delete</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_AppleEvtObjects.html#exists">exists</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_AppleEvtObjects.html#get">get</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_AppleEvtObjects.html#make">make</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_AppleEvtObjects.html#move">move</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_AppleEvtObjects.html#open-1">open</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_AppleEvtObjects.html#quit-1">quit</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_AppleEvtObjects.html#save">save</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_AppleEvtObjects.html#set">set</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="IAC_API_AppleEvtObjects.html#acrobat-application-events">Acrobat application events</a><ul>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_AppleEvtObjects.html#bring-to-front">bring to front</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_AppleEvtObjects.html#clear-selection">clear selection</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_AppleEvtObjects.html#close-all-docs">close all docs</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_AppleEvtObjects.html#create-thumbs">create thumbs</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_AppleEvtObjects.html#delete-pages">delete pages</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_AppleEvtObjects.html#delete-thumbs">delete thumbs</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_AppleEvtObjects.html#execute">execute</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_AppleEvtObjects.html#find-next-note">find next note</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_AppleEvtObjects.html#find-text">find text</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_AppleEvtObjects.html#get-info">get info</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_AppleEvtObjects.html#go-backward">go backward</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_AppleEvtObjects.html#go-forward">go forward</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_AppleEvtObjects.html#goto">goto</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_AppleEvtObjects.html#goto-next">goto next</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_AppleEvtObjects.html#goto-previous">goto previous</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_AppleEvtObjects.html#insert-pages">insert pages</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_AppleEvtObjects.html#is-toolbutton-enabled">is toolbutton enabled</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_AppleEvtObjects.html#maximize">maximize</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_AppleEvtObjects.html#perform">perform</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_AppleEvtObjects.html#print-pages">print pages</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_AppleEvtObjects.html#read-page-down">read page down</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_AppleEvtObjects.html#read-page-up">read page up</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_AppleEvtObjects.html#remove-toolbutton">remove toolbutton</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_AppleEvtObjects.html#replace-pages">replace pages</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_AppleEvtObjects.html#scroll">scroll</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_AppleEvtObjects.html#select-text">select text</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_AppleEvtObjects.html#set-info">set info</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_AppleEvtObjects.html#zoom">zoom</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="IAC_API_AppleEvtObjects.html#miscellaneous-events">Miscellaneous events</a><ul>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_AppleEvtObjects.html#do-script">do script</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="IAC_API_CatalogCatIntro.html">Acrobat Catalog Plug-In</a><ul>
<li class="toctree-l2"><a class="reference internal" href="IAC_API_CatalogCatIntro.html#catalog-windows-messages">Catalog Windows messages</a></li>
<li class="toctree-l2"><a class="reference internal" href="IAC_API_CatalogCatIntro.html#catalog-dde-methods">Catalog DDE methods</a><ul>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_CatalogCatIntro.html#appexit">AppExit</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_CatalogCatIntro.html#appfront">AppFront</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_CatalogCatIntro.html#filebuild">FileBuild</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_CatalogCatIntro.html#fileopen">FileOpen</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_CatalogCatIntro.html#filepurge">FilePurge</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="IAC_API_FormsIntro.html">Acrobat Forms Plug-In</a><ul>
<li class="toctree-l2"><a class="reference internal" href="IAC_API_FormsIntro.html#forms-plug-in-ole-automation">Forms plug-in OLE automation</a></li>
<li class="toctree-l2"><a class="reference internal" href="IAC_API_FormsIntro.html#aformapp">AFormApp</a></li>
<li class="toctree-l2"><a class="reference internal" href="IAC_API_FormsIntro.html#field">Field</a><ul>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_FormsIntro.html#methods">Methods</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_FormsIntro.html#populatelistorcombobox">PopulateListOrComboBox</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_FormsIntro.html#setbackgroundcolor">SetBackgroundColor</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_FormsIntro.html#setbordercolor">SetBorderColor</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_FormsIntro.html#setbuttoncaption">SetButtonCaption</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_FormsIntro.html#setbuttonicon">SetButtonIcon</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_FormsIntro.html#setexportvalues">SetExportValues</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_FormsIntro.html#setforegroundcolor">SetForegroundColor</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_FormsIntro.html#setjavascriptaction">SetJavaScriptAction</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_FormsIntro.html#setresetformaction">SetResetFormAction</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_FormsIntro.html#setsubmitformaction">SetSubmitFormAction</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_FormsIntro.html#properties">Properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_FormsIntro.html#alignment">Alignment</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_FormsIntro.html#borderstyle">BorderStyle</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_FormsIntro.html#borderwidth">BorderWidth</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_FormsIntro.html#buttonlayout">ButtonLayout</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_FormsIntro.html#calcorderindex">CalcOrderIndex</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_FormsIntro.html#charlimit">CharLimit</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_FormsIntro.html#defaultvalue">DefaultValue</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_FormsIntro.html#editable">Editable</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_FormsIntro.html#highlight">Highlight</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_FormsIntro.html#ishidden">IsHidden</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_FormsIntro.html#ismultiline">IsMultiline</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_FormsIntro.html#ispassword">IsPassword</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_FormsIntro.html#isreadonly">IsReadOnly</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_FormsIntro.html#isrequired">IsRequired</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_FormsIntro.html#isterminal">IsTerminal</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_FormsIntro.html#name">Name</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_FormsIntro.html#noviewflag">NoViewFlag</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_FormsIntro.html#printflag">PrintFlag</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_FormsIntro.html#style">Style</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_FormsIntro.html#textfont">TextFont</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_FormsIntro.html#textsize">TextSize</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_FormsIntro.html#type">Type</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_FormsIntro.html#value">Value</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="IAC_API_FormsIntro.html#fields">Fields</a><ul>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_FormsIntro.html#methods-1">Methods</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_FormsIntro.html#add">Add</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_FormsIntro.html#adddocjavascript">AddDocJavascript</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_FormsIntro.html#executethisjavascript">ExecuteThisJavascript</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_FormsIntro.html#exportasfdf">ExportAsFDF</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_FormsIntro.html#exportashtml">ExportAsHtml</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_FormsIntro.html#importanfdf">ImportAnFDF</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_FormsIntro.html#remove">Remove</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_FormsIntro.html#properties-1">Properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_FormsIntro.html#count">Count</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_FormsIntro.html#item">Item</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_FormsIntro.html#newenum">_NewEnum</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="IAC_API_SearchIntro.html">Acrobat Search Plug-in</a><ul>
<li class="toctree-l2"><a class="reference internal" href="IAC_API_SearchIntro.html#search-plug-in-using-dde">Search plug-in using DDE</a><ul>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_SearchIntro.html#simple-query-item">Simple query item</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_SearchIntro.html#query-item">Query item</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_SearchIntro.html#query-options">Query options</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_SearchIntro.html#query-language-type-constants">Query language type constants</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_SearchIntro.html#word-option-bit-flag-constants">Word option bit-flag constants</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_SearchIntro.html#manipulating-indexes-through-dde">Manipulating indexes through DDE</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_SearchIntro.html#options">Options</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_SearchIntro.html#index-operation-selectors">Index operation selectors</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="IAC_API_SearchIntro.html#search-plug-in-using-apple-events">Search plug-in using Apple events</a><ul>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_SearchIntro.html#searchaddindex">SearchAddIndex</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_SearchIntro.html#searchcountindexlist">SearchCountIndexList</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_SearchIntro.html#searchdoquery">SearchDoQuery</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_SearchIntro.html#word-options-for-apple-events">Word options for Apple events</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_SearchIntro.html#searchgetindexbypath">SearchGetIndexByPath</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_SearchIntro.html#searchgetindexflags">SearchGetIndexFlags</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_SearchIntro.html#searchgetindexlist">SearchGetIndexList</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_SearchIntro.html#searchgetindexpath">SearchGetIndexPath</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_SearchIntro.html#searchgetindextitle">SearchGetIndexTitle</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_SearchIntro.html#searchgetnthindex">SearchGetNthIndex</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_SearchIntro.html#searchremoveindex">SearchRemoveIndex</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_SearchIntro.html#searchsetindexflags">SearchSetIndexFlags</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="IAC_API_SearchIntro.html#search-lists">Search lists</a><ul>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_SearchIntro.html#menu-item-names">Menu item names</a></li>
<li class="toctree-l3"><a class="reference internal" href="IAC_API_SearchIntro.html#toolbar-button-names">Toolbar button names</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="IAC_API_CoordinateSystems.html">Coordinate Systems</a><ul>
<li class="toctree-l2"><a class="reference internal" href="IAC_API_CoordinateSystems.html#user-space">User space</a></li>
<li class="toctree-l2"><a class="reference internal" href="IAC_API_CoordinateSystems.html#device-space">Device space</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference external" href="../index.html#://">Master Doc Search and TOC</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

        <!--- @@@@@@@@@@@@@@@@ Custom @@@@@@@@@@@@@@@@ -->
        <div class="fixedbar">  
          <div class="wy-menu-items">
            <a href="https://www.adobe.com/go/dc_developer" class="topbarlink">Acrobat Developer Home</a>
            <a href="https://www.adobe.io/apis/documentcloud/dcsdk/" class="topbarlink">Document Services SDK</a>
            <a href="https://www.adobe.com/go/acrobatsigndevguide" class="topbarlink">Acrobat Sign SDK</a>
            <a href="https://www.adobe.com/go/acrobatsdk_home" class="topbarlink">Acrobat SDK</a>
            <a href="https://www.adobe.com/go/pdflibrary" class="topbarlink">PDF Library SDK</a>
          </div>  
          <div class="sign-in">
            <a href="https://adminconsole.adobe.com//" class="btn btn-console">Console</a>
           <!-- <a href="https://auth.services.adobe.com/en_US/index.html">Sign in</a>-->
          </div>
        </div>
        <!--- @@@@@@@@@@@@@@@@ Custom @@@@@@@@@@@@@@@@ -->




   
      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="toc.html">Acrobat-PDFL SDK: Interapplication Communication</a>
        
      </nav>


      <div class="wy-nav-content">
      <a href="#" id="scroll" style="display:inline;"><span></span></a>
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="toc.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Using OLE</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
    
  </ul>

  
  <div class="rst-breadcrumbs-buttons" role="navigation" aria-label="breadcrumb navigation">
      
        <a href="IAC_DevApp_DDE_Support.html" class="btn btn-neutral float-right" title="Using DDE" accesskey="n">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral float-left" title="Developing for Interapplication Communication" accesskey="p"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
      
  </div>
  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="using-ole">
<h1>Using OLE<a class="headerlink" href="#using-ole" title="Permalink to this headline">¶</a></h1>
<p>This chapter describes how you can use OLE 2.0 support in Adobe Acrobat for Microsoft Windows. Acrobat applications are OLE servers and also respond to a variety of OLE automation messages.</p>
<p>Since Acrobat provides the appropriate interfaces to be an OLE server, you can embed PDF documents into documents created by an application that is an OLE client, or link them to OLE containers. However, Acrobat does not perform in-place activation.</p>
<p>Acrobat supports the OLE automation methods described in this document. Acrobat Reader does not support OLE automation, except for the PDF browser controls provided in the <code class="docutils literal notranslate"><span class="pre">AcroPDF</span></code> object.</p>
<p>The best practical resources for Visual Basic or Visual C# programmers, besides the object browser, are the sample projects. The samples demonstrate use of the Acrobat OLE objects and contain comments describing the parameters for the more complicated methods. For more information, see the <a class="reference external" href="http://www.adobe.com/go/acrobatsdk_samplesguide">Acrobat SDK Samples Guide</a>.</p>
<p>For more information on OLE 2.0 and OLE automation, see the <em>OLE Automation Programmer’s Reference</em> , ISBN 1-55615-851-3, Microsoft Press. You can also find numerous articles at <a class="reference external" href="http://msdn.microsoft.com">http://msdn.microsoft.com</a> .</p>
<a name="50532372_75744"></a><div class="section" id="ole-capabilities-in-acrobat">
<h2>OLE capabilities in Acrobat<a class="headerlink" href="#ole-capabilities-in-acrobat" title="Permalink to this headline">¶</a></h2>
<p>For OLE automation, Acrobat provides three capabilities: rendering PDF documents, remotely controlling the application, and implementing PDF browser controls.</p>
<div class="section" id="on-screen-rendering">
<h3>On-screen rendering<a class="headerlink" href="#on-screen-rendering" title="Permalink to this headline">¶</a></h3>
<p>You can render PDF documents on the screen in two ways:</p>
<ul class="simple">
<li><p>Use an interface similar to the Acrobat user interface.</p></li>
</ul>
<p>In this approach, use the <code class="docutils literal notranslate"><span class="pre">AVDoc</span></code> object’s <code class="docutils literal notranslate"><span class="pre">OpenInWindowEx</span></code> method to open a PDF file in your application’s window. The window has vertical and horizontal scroll bars, and has buttons on the window’s perimeter for setting the zoom factor. Users interacting with this type of window find its operation similar to that of working in Acrobat. For example, links are active and the window can display any text annotation on a page.</p>
<p>The ActiveView sample in the <a class="reference external" href="http://www.adobe.com/go/acrobatsdk_samplesguide">Acrobat SDK Samples Guide</a> demonstrates this approach.</p>
<ul class="simple">
<li><p>Use the <code class="docutils literal notranslate"><span class="pre">PDPage</span></code> object’s <code class="docutils literal notranslate"><span class="pre">DrawEx</span></code> method.</p></li>
</ul>
<p>In this approach, you provide a window and a device context, as well as a zoom factor. Acrobat renders the current page into your window. The application must manage the scroll bars and other items in the user interface.</p>
<p>The StaticView sample in the <a class="reference external" href="http://www.adobe.com/go/acrobatsdk_samplesguide">Acrobat SDK Samples Guide</a> demonstrates this approach.</p>
</div>
<div class="section" id="remote-control-of-acrobat">
<h3>Remote control of Acrobat<a class="headerlink" href="#remote-control-of-acrobat" title="Permalink to this headline">¶</a></h3>
<p>You can control Acrobat remotely in two ways:</p>
<ul class="simple">
<li><p>Given the exported interfaces, you can write an application that manipulates various aspects of PDF documents, such as pages, annotations, and bookmarks. Your application might use <code class="docutils literal notranslate"><span class="pre">AVDoc</span></code>, <code class="docutils literal notranslate"><span class="pre">PDDoc</span></code>, <code class="docutils literal notranslate"><span class="pre">PDPage</span></code>, and <code class="docutils literal notranslate"><span class="pre">annotation</span></code> methods, and might not provide any visual feedback that requires rendering into its application window.</p></li>
<li><p>You can launch Acrobat from your own application, which has set up the environment for the user. Your application can cause Acrobat to open a file, set the page location and zoom factor, and possibly even select some text. For example, this could be useful as part of a help system.</p></li>
</ul>
</div>
<div class="section" id="pdf-browser-controls">
<h3>PDF browser controls<a class="headerlink" href="#pdf-browser-controls" title="Permalink to this headline">¶</a></h3>
<p>You can use the <code class="docutils literal notranslate"><span class="pre">AcroPDF</span></code> library to display a PDF document in applications using simplified browser controls. In this case, the PDF document is treated as an ActiveX document, and the interface is available in Acrobat Reader.</p>
<p>Load the document with the <code class="docutils literal notranslate"><span class="pre">AcroPDF</span></code> object’s <code class="docutils literal notranslate"><span class="pre">LoadFile</span></code> method. You can then implement browser controls for the following functionality:</p>
<ul class="simple">
<li><p>To determine which page to display</p></li>
<li><p>To choose the display, view, and zoom modes</p></li>
<li><p>To display bookmarks, thumbs, scrollbars, and toolbars</p></li>
<li><p>To print pages using various options</p></li>
<li><p>To highlight a text selection</p></li>
</ul>
<a name="50532372_91364"></a></div>
</div>
<div class="section" id="development-environment-considerations">
<h2>Development environment considerations<a class="headerlink" href="#development-environment-considerations" title="Permalink to this headline">¶</a></h2>
<p>You have a choice of environments in which to integrate with Acrobat: Visual Basic, Visual C#, and Visual C++.</p>
<p>If possible, use Visual Basic or Visual C#. The run-time type checking offered by the <code class="docutils literal notranslate"><span class="pre">CreateObject</span></code> call in Visual Basic allows quick prototyping of an application, and in both of these languages the implementation details are simplified.</p>
<p>For comparison, consider the following examples, in which you can see strings with <code class="docutils literal notranslate"><span class="pre">&quot;AcroExch.App&quot;</span></code> and strings with <code class="docutils literal notranslate"><span class="pre">&quot;Acrobat.CAcroApp&quot;</span></code>. The first is the form for the external string used by OLE clients to create an object of that type. The second is the form that is included in developer type libraries.</p>
<p>This example shows a Visual Basic subroutine to view a given page of an open document:</p>
<ol class="arabic simple">
<li><p>Viewing a page with Visual Basic</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Private</span> <span class="n">Sub</span> <span class="n">myGoto</span><span class="p">(</span><span class="n">ByVal</span> <span class="n">where</span> <span class="n">As</span> <span class="n">Integer</span><span class="p">)</span>
    <span class="n">Dim</span> <span class="n">app</span> <span class="k">as</span> <span class="n">Object</span><span class="p">,</span> <span class="n">avdoc</span> <span class="k">as</span> <span class="n">Object</span><span class="p">,</span> <span class="n">pageview</span> <span class="k">as</span> <span class="n">Object</span>
    <span class="n">Set</span> <span class="n">app</span> <span class="o">=</span> <span class="n">CreateObject</span><span class="p">(</span><span class="s2">&quot;AcroExch.App&quot;</span><span class="p">)</span>
    <span class="n">Set</span> <span class="n">avdoc</span> <span class="o">=</span> <span class="n">app</span><span class="o">.</span><span class="n">GetActiveDoc</span>
    <span class="n">Set</span> <span class="n">pageview</span> <span class="o">=</span> <span class="n">avdoc</span><span class="o">.</span><span class="n">GetAVPageView</span>
    <span class="n">pageview</span><span class="o">.</span><span class="n">Goto</span><span class="p">(</span><span class="n">where</span><span class="p">)</span>
<span class="n">End</span> <span class="n">Sub</span>
</pre></div>
</div>
<p>The following example does the same, but in Visual C++:</p>
<ol class="arabic simple">
<li><p>Viewing a page with Visual C++</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">void</span> <span class="n">goto</span><span class="p">(</span><span class="nb">int</span> <span class="n">where</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">CAcroApp</span> <span class="n">app</span><span class="p">;</span>
    <span class="n">CAcroAVDoc</span> <span class="o">*</span><span class="n">avdoc</span> <span class="o">=</span> <span class="n">new</span> <span class="n">CAcroAVDoc</span><span class="p">;</span>
    <span class="n">CAcroAVPageView</span> <span class="n">pageview</span><span class="p">;</span>
    <span class="n">COleException</span> <span class="n">e</span><span class="p">;</span>
    <span class="n">app</span><span class="o">.</span><span class="n">CreateDispatch</span><span class="p">(</span><span class="s2">&quot;AcroExch.App&quot;</span><span class="p">);</span>
    <span class="n">avdoc</span><span class="o">-&gt;</span><span class="n">AttachDispatch</span><span class="p">(</span><span class="n">app</span><span class="o">.</span><span class="n">GetActiveDoc</span><span class="p">,</span> <span class="n">TRUE</span><span class="p">);</span>
    <span class="n">pageview</span><span class="o">-&gt;</span><span class="n">AttachDispatch</span><span class="p">(</span><span class="n">avdoc</span><span class="o">-&gt;</span><span class="n">GetAVPageView</span><span class="p">,</span> <span class="n">TRUE</span><span class="p">);</span>
    <span class="n">pageview</span><span class="o">-&gt;</span><span class="n">Goto</span><span class="p">(</span><span class="n">where</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The next example shows how to use PDF browser controls to view a page in Visual Basic:</p>
<ol class="arabic simple">
<li><p>Using AcroPDF browser controls with Visual Basic</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Friend</span> <span class="n">WithEvents</span> <span class="n">AxAcroPDF1</span> <span class="n">As</span> <span class="n">AxAcroPDFLib</span><span class="o">.</span><span class="n">AxAcroPDF</span>
<span class="n">Me</span><span class="o">.</span><span class="n">AxAcroPDF1</span> <span class="o">=</span> <span class="n">New</span> <span class="n">AxAcroPDFLib</span><span class="o">.</span><span class="n">AxAcroPDF</span>
<span class="s1">&#39;AxAcroPDF1</span>
<span class="n">Me</span><span class="o">.</span><span class="n">AxAcroPDF1</span><span class="o">.</span><span class="n">Enabled</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">Me</span><span class="o">.</span><span class="n">AxAcroPDF1</span><span class="o">.</span><span class="n">Location</span> <span class="o">=</span> <span class="n">New</span> <span class="n">System</span><span class="o">.</span><span class="n">Drawing</span><span class="o">.</span><span class="n">Point</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span> <span class="mi">40</span><span class="p">)</span>
<span class="n">Me</span><span class="o">.</span><span class="n">AxAcroPDF1</span><span class="o">.</span><span class="n">Name</span> <span class="o">=</span> <span class="s2">&quot;AxAcroPDF1&quot;</span>
<span class="n">Me</span><span class="o">.</span><span class="n">AxAcroPDF1</span><span class="o">.</span><span class="n">OcxState</span> <span class="o">=</span> <span class="n">CType</span><span class="p">(</span>
       <span class="n">resources</span><span class="o">.</span><span class="n">GetObject</span><span class="p">(</span><span class="s2">&quot;AxAcroPDF1.OcxState&quot;</span><span class="p">),</span>
       <span class="n">System</span><span class="o">.</span><span class="n">Windows</span><span class="o">.</span><span class="n">Forms</span><span class="o">.</span><span class="n">AxHost</span><span class="o">.</span><span class="n">State</span>
<span class="p">)</span>
<span class="n">Me</span><span class="o">.</span><span class="n">AxAcroPDF1</span><span class="o">.</span><span class="n">Size</span> <span class="o">=</span> <span class="n">New</span> <span class="n">System</span><span class="o">.</span><span class="n">Drawing</span><span class="o">.</span><span class="n">Size</span><span class="p">(</span><span class="mi">584</span><span class="p">,</span> <span class="mi">600</span><span class="p">)</span>
<span class="n">Me</span><span class="o">.</span><span class="n">AxAcroPDF1</span><span class="o">.</span><span class="n">TabIndex</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">AxAcroPDF1</span><span class="o">.</span><span class="n">LoadFile</span><span class="p">(</span><span class="s2">&quot;http://www.example.com/example.pdf&quot;</span><span class="p">)</span>
<span class="n">AxAcroPDF1</span><span class="o">.</span><span class="n">setCurrentPage</span><span class="p">(</span><span class="n">TextBox2</span><span class="o">.</span><span class="n">Text</span><span class="p">)</span>
</pre></div>
</div>
<p>The Visual Basic examples are simpler to read, write, and support, and the implementation details are similar to Visual C#.</p>
<p>In Visual C++, the <code class="docutils literal notranslate"><span class="pre">CAcro</span></code> classes hide much of the type checking that must be done. Using OLE automation objects in Visual C++ requires an understanding of the <code class="docutils literal notranslate"><span class="pre">AttachDispatch</span></code> and <code class="docutils literal notranslate"><span class="pre">CreateDispatch</span></code> methods of the <code class="docutils literal notranslate"><span class="pre">COleDispatchDriver</span></code> class. For more information, see <a class="reference external" href="IAC_DevApp_OLE_Support.html#50532372_78674">Using the Acrobat OLE interfaces</a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The header files containing the values of constants that are required by C and C++ programmers to use OLE automation are located in the Acrobat SDK IAC directory. Visual Basic and Visual C# users do not need these header files, though it may be useful to refer to them in order to verify the constant definitions.</p>
</div>
<div class="section" id="environment-configuration">
<h3>Environment configuration<a class="headerlink" href="#environment-configuration" title="Permalink to this headline">¶</a></h3>
<p>The only requirement for using the OLE objects made available by Acrobat is to have the product installed on your system and the appropriate type library file included in the project references for your project. The Acrobat type library file is named Acrobat.tlb. This file is included in the InterAppCommunicationSupportHeaders folder in the SDK. Once you have the type library file included in your project, you can use the object browser to browse the OLE objects.</p>
<p>It is not sufficient to install just an ActiveX control or DLL to enable OLE automation. You must have the full Acrobat product installed.</p>
<p>If you are a Visual Basic programmer, it is helpful to include the iac.bas module in your project (included in the headers folder). This module defines the constant variables.</p>
</div>
<div class="section" id="necessary-c-knowledge">
<h3>Necessary C knowledge<a class="headerlink" href="#necessary-c-knowledge" title="Permalink to this headline">¶</a></h3>
<p>These documents, as well as the API, were designed with C programming in mind and programming with the API requires some familiarity with C concepts.</p>
<p>Although you do not need the header files provided in the SDK, you can use them to find the values of various constants, such as <code class="docutils literal notranslate"><span class="pre">AV_DOC_VIEW</span></code>, that are referenced in the documentation. The file iac.h contains most of these values.</p>
<p>Some of the methods, such as <code class="docutils literal notranslate"><span class="pre">OpenInWindowEx</span></code>, can be initially confusing when used in Visual Basic. <code class="docutils literal notranslate"><span class="pre">OpenInWindowEx</span></code> takes a <code class="docutils literal notranslate"><span class="pre">long</span></code> for the <code class="docutils literal notranslate"><span class="pre">openflags</span></code> parameter. The options for this parameter are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">AV_EXTERNAL_VIEW</span></code>: Open the document with the toolbar visible.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">AV_DOC_VIEW</span></code>: Draw the page pane and scrollbars.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">AV_PAGE_VIEW</span></code>: Draw only the page pane.</p></li>
</ul>
<p>If you were developing in C, these strings would be replaced by a numeric value prior to compilation; passing these strings to the method would not raise an error. When programming in Visual Basic, these strings correspond to constant variables defined in iac.bas.</p>
<p>In some situations, you need to apply a bitwise <code class="docutils literal notranslate"><span class="pre">OR</span></code> to multiple values and pass the resultant value to a method. For example, in iac.h the <code class="docutils literal notranslate"><span class="pre">ntype</span></code> parameter of the <code class="docutils literal notranslate"><span class="pre">PDDocSave</span></code> method is a bitwise <code class="docutils literal notranslate"><span class="pre">OR</span></code> of the following flags:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/*</span> <span class="n">PDSaveFlags</span><span class="p">:</span> <span class="n">used</span> <span class="k">for</span> <span class="n">PD</span><span class="o">-</span><span class="n">level</span> <span class="n">Save</span>
<span class="o">**</span> <span class="n">All</span> <span class="n">undefined</span> <span class="n">flags</span> <span class="n">should</span> <span class="n">be</span> <span class="nb">set</span> <span class="n">to</span> <span class="n">zero</span><span class="o">.</span>
<span class="o">**</span> <span class="n">If</span> <span class="n">either</span> <span class="n">PDSaveCollectGarbage</span> <span class="ow">or</span> <span class="n">PDSaveCopy</span> <span class="n">are</span> <span class="n">used</span><span class="p">,</span> <span class="n">PDSaveFull</span> <span class="n">must</span> <span class="n">be</span> <span class="n">used</span><span class="o">.</span> <span class="o">*/</span>
<span class="n">typedef</span> <span class="n">enum</span> <span class="p">{</span>
    <span class="n">PDSaveIncremental</span> <span class="o">=</span> <span class="mh">0x0000</span><span class="p">,</span>  <span class="o">/*</span> <span class="n">write</span> <span class="n">changes</span> <span class="n">only</span> <span class="o">*/</span>
    <span class="n">PDSaveFull</span> <span class="o">=</span> <span class="mh">0x0001</span><span class="p">,</span>         <span class="o">/*</span> <span class="n">write</span> <span class="n">entire</span> <span class="n">file</span> <span class="o">*/</span>
    <span class="n">PDSaveCopy</span> <span class="o">=</span> <span class="mh">0x0002</span><span class="p">,</span>         <span class="o">/*</span> <span class="n">write</span> <span class="n">copy</span> <span class="n">w</span><span class="o">/</span><span class="n">o</span> <span class="n">affecting</span> <span class="n">current</span> <span class="n">state</span> <span class="o">*/</span>
   <span class="n">PDSaveLinearized</span> <span class="o">=</span> <span class="mh">0x0004</span><span class="p">,</span>   <span class="o">/*</span> <span class="n">write</span> <span class="n">the</span> <span class="n">file</span> <span class="n">linearized</span> <span class="k">for</span>
    <span class="o">**</span>       <span class="n">page</span><span class="o">-</span><span class="n">served</span> <span class="n">remote</span> <span class="p">(</span><span class="n">net</span><span class="p">)</span> <span class="n">access</span><span class="o">.</span> <span class="o">*/</span>
   <span class="n">PDSaveBinaryOK</span> <span class="o">=</span> <span class="mh">0x0010</span><span class="p">,</span> <span class="o">/*</span> <span class="n">OK</span> <span class="n">to</span> <span class="n">store</span> <span class="n">binary</span> <span class="ow">in</span> <span class="n">file</span> <span class="o">*/</span>
   <span class="n">PDSaveCollectGarbage</span> <span class="o">=</span> <span class="mh">0x0020</span>  <span class="o">/*</span> <span class="n">perform</span> <span class="n">garbage</span> <span class="n">collection</span> <span class="n">on</span>
   <span class="o">**</span>       <span class="n">unreferenced</span> <span class="n">objects</span> <span class="o">*/</span>
<span class="p">}</span> <span class="n">PDSaveFlags</span><span class="p">;</span>
</pre></div>
</div>
<p>For example, if you would like to fully save the PDF file and optimize it for the Web (linearize it) within a Visual Basic application, pass <code class="docutils literal notranslate"><span class="pre">PDSaveFull</span> <span class="pre">+</span> <span class="pre">PDSaveLinearized</span></code> (both defined in iac.bas) into the <code class="docutils literal notranslate"><span class="pre">ntype</span></code> parameter; this is the equivalent of a binary <code class="docutils literal notranslate"><span class="pre">OR</span></code> of the <code class="docutils literal notranslate"><span class="pre">PDSaveFull</span></code> and <code class="docutils literal notranslate"><span class="pre">PDSaveLinearized</span></code> parameters.</p>
<p>In many instances, the numeric values are spelled out in comments in the Visual Basic sample code. However, knowledge of why the methods are structured in this way and how they are used in C can be useful to Visual Basic and Visual C# programmers.</p>
<a name="50532372_78674"></a></div>
</div>
<div class="section" id="using-the-acrobat-ole-interfaces">
<h2>Using the Acrobat OLE interfaces<a class="headerlink" href="#using-the-acrobat-ole-interfaces" title="Permalink to this headline">¶</a></h2>
<p>This section describes using the <code class="docutils literal notranslate"><span class="pre">CAcro</span></code> classes and the <code class="docutils literal notranslate"><span class="pre">COleDispatchDriver</span></code> class. The <code class="docutils literal notranslate"><span class="pre">CAcro</span></code> classes are subclasses of <code class="docutils literal notranslate"><span class="pre">COleDispatchDriver</span></code>.</p>
<div class="section" id="about-the-cacro-classes">
<h3>About the CAcro classes<a class="headerlink" href="#about-the-cacro-classes" title="Permalink to this headline">¶</a></h3>
<p>OLE 2.0 support in Acrobat includes several classes whose names begin with “<code class="docutils literal notranslate"><span class="pre">CAcro</span></code> “, such as <code class="docutils literal notranslate"><span class="pre">CAcroApp</span></code> and <code class="docutils literal notranslate"><span class="pre">CAcroPDDoc</span></code>. Several files in the SDK encapsulate the definitions of these classes.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">CAcro</span></code> classes are defined in the Acrobat type library acrobat.tlb. The <code class="docutils literal notranslate"><span class="pre">OLEView</span></code> tool in Visual Studio allows you to browse registered type libraries. Use acrobat.tlb when defining OLE automation for a project in Microsoft Visual C++. The files acrobat.h and acrobat.cpp are included in the Acrobat SDK, and implement a type-safe wrapper to the Acrobat automation server.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Do not modify the acrobat.tlb, acrobat.h, and acrobat.cpp files in the SDK; these define Acrobat’s OLE automation interface.</p>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">CAcro</span></code> classes inherit from the MFC <code class="docutils literal notranslate"><span class="pre">COleDispatchDriver</span></code> class. Understanding this class makes it easier to write applications that use the <code class="docutils literal notranslate"><span class="pre">CAcro</span></code> classes and their methods.</p>
<p>See the <em>Interapplication Communication API Reference</em> for details on the <code class="docutils literal notranslate"><span class="pre">CAcro</span></code> classes and their methods.</p>
</div>
<div class="section" id="about-the-coledispatchdriver-class">
<h3>About the COleDispatchDriver class<a class="headerlink" href="#about-the-coledispatchdriver-class" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">COleDispatchDriver</span></code> class implements the client side of OLE automation, providing most of the code needed to access automation objects. It provides the wrapper functions <code class="docutils literal notranslate"><span class="pre">AttachDispatch</span></code>, <code class="docutils literal notranslate"><span class="pre">DetachDispatch</span></code>, and <code class="docutils literal notranslate"><span class="pre">ReleaseDispatch</span></code>, as well as the convenience functions <code class="docutils literal notranslate"><span class="pre">InvokeHelper</span></code>, <code class="docutils literal notranslate"><span class="pre">SetProperty</span></code>, and <code class="docutils literal notranslate"><span class="pre">GetProperty</span></code>. You employ some of these methods when you use the Acrobat-provided automation objects. Other methods are used in the Acrobat implementation of these objects.</p>
<p><code class="docutils literal notranslate"><span class="pre">COleDispatchDriver</span></code> is essentially a “class wrapper” for <code class="docutils literal notranslate"><span class="pre">IDispatch</span></code>, which is the OLE interface by which applications expose methods and properties so that other applications written in Visual Basic and Visual C# can use the application’s features. This provides OLE support for Acrobat applications.</p>
<a name="50532372_38230"></a></div>
<div class="section" id="using-coledispatchdriver-objects-and-methods">
<h3>Using COleDispatchDriver objects and methods<a class="headerlink" href="#using-coledispatchdriver-objects-and-methods" title="Permalink to this headline">¶</a></h3>
<p>This section discusses how to use the classes exported by acrobat.cpp, and shows when to call the <code class="docutils literal notranslate"><span class="pre">CreateDispatch</span></code> and <code class="docutils literal notranslate"><span class="pre">AttachDispatch</span></code> methods.</p>
<p>The following is a section of code from acrobat.h that declares t <code class="docutils literal notranslate"><span class="pre">he</span></code> <code class="docutils literal notranslate"><span class="pre">CAcroHiliteList</span></code> <code class="docutils literal notranslate"><span class="pre">class.</span> <span class="pre">CAcroHiliteList</span></code> is a subclass of the <code class="docutils literal notranslate"><span class="pre">COleDispatchDriver</span></code> class, which means that it shares all the instance variables of <code class="docutils literal notranslate"><span class="pre">COleDispatchDriver</span></code>.</p>
<p>One of these variables is <code class="docutils literal notranslate"><span class="pre">m_lpDispatch</span></code>, which holds an <code class="docutils literal notranslate"><span class="pre">LPDISPATCH</span></code> for that object. An <code class="docutils literal notranslate"><span class="pre">LPDISPATCH</span></code> is a <code class="docutils literal notranslate"><span class="pre">long</span></code> pointer to an <code class="docutils literal notranslate"><span class="pre">IDispatch</span></code>, which can be considered an opaque data type representing a dispatch connection. <code class="docutils literal notranslate"><span class="pre">m_lpDispatch</span></code> can be used in functions that require an <code class="docutils literal notranslate"><span class="pre">LPDISPATCH</span></code> argument.</p>
<ol class="arabic simple">
<li><p>CAcroHiliteList class declaration</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">CAcroHiliteList</span> <span class="p">:</span> <span class="n">public</span> <span class="n">COleDispatchDriver</span>
<span class="p">{</span>
<span class="n">public</span><span class="p">:</span>
   <span class="n">CAcroHiliteList</span><span class="p">()</span> <span class="p">{}</span>        <span class="o">//</span> <span class="n">Calls</span> <span class="n">COleDispatchDriver</span> <span class="n">default</span> <span class="n">constructor</span>
   <span class="n">CAcroHiliteList</span><span class="p">(</span><span class="n">LPDISPATCH</span> <span class="n">pDispatch</span><span class="p">)</span> <span class="p">:</span> <span class="n">COleDispatchDriver</span><span class="p">(</span><span class="n">pDispatch</span><span class="p">)</span> <span class="p">{}</span>
   <span class="n">CAcroHiliteList</span><span class="p">(</span><span class="n">const</span> <span class="n">CAcroHiliteList</span><span class="o">&amp;</span> <span class="n">dispatchSrc</span><span class="p">)</span> <span class="p">:</span>

        <span class="n">COleDispatchDriver</span><span class="p">(</span><span class="n">dispatchSrc</span><span class="p">)</span> <span class="p">{}</span>

<span class="o">//</span> <span class="n">Attributes</span>
<span class="n">public</span><span class="p">:</span>

<span class="o">//</span> <span class="n">Operations</span>
<span class="n">public</span><span class="p">:</span>
   <span class="nb">bool</span> <span class="n">Add</span><span class="p">(</span><span class="n">short</span> <span class="n">nOffset</span><span class="p">,</span> <span class="n">short</span> <span class="n">nLength</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>
</div>
<p>The following is the related implementation section of the <code class="docutils literal notranslate"><span class="pre">Add</span></code> method from acrobat.cpp:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">bool</span> <span class="n">CAcroHiliteList</span><span class="p">::</span><span class="n">Add</span><span class="p">(</span><span class="n">short</span> <span class="n">nOffset</span><span class="p">,</span> <span class="n">short</span> <span class="n">nLength</span><span class="p">)</span>
<span class="p">{</span>
   <span class="nb">bool</span> <span class="n">result</span><span class="p">;</span>
   <span class="n">static</span> <span class="n">BYTE</span> <span class="n">parms</span><span class="p">[]</span> <span class="o">=</span>
       <span class="n">VTS_I2</span> <span class="n">VTS_I2</span><span class="p">;</span>
   <span class="n">InvokeHelper</span><span class="p">(</span><span class="mh">0x1</span><span class="p">,</span> <span class="n">DISPATCH_METHOD</span><span class="p">,</span> <span class="n">VT_I4</span><span class="p">,</span> <span class="p">(</span><span class="n">void</span><span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">result</span><span class="p">,</span> <span class="n">parms</span><span class="p">,</span>
       <span class="n">nOffset</span><span class="p">,</span> <span class="n">nLength</span><span class="p">);</span>
   <span class="k">return</span> <span class="n">result</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>When the <code class="docutils literal notranslate"><span class="pre">Add</span></code> method is called, such as with this code from the following example <a class="reference external" href="IAC_DevApp_OLE_Support.html#50532372_95231">Using the COleDispatchDriver class</a>,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">hilite</span><span class="o">-&gt;</span><span class="n">Add</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">);</span>
</pre></div>
</div>
<p>the <code class="docutils literal notranslate"><span class="pre">InvokeHelper</span></code> function is called. This <code class="docutils literal notranslate"><span class="pre">COleDispatchDriver</span></code> method takes a variable number of arguments. It eventually calls the Acrobat implementation for <code class="docutils literal notranslate"><span class="pre">CAcroHiliteList</span></code> object’s <code class="docutils literal notranslate"><span class="pre">Add</span></code> method. This happens across the virtual OLE “wires” and takes care of all the OLE details. The end result is that a page range is added to the <code class="docutils literal notranslate"><span class="pre">CAcroHiliteList</span></code> object.</p>
<p>The following is an implementation of a method adapted from the <code class="docutils literal notranslate"><span class="pre">ActiveView</span></code> sample:</p>
<ol class="arabic simple">
<li><p>Using the COleDispatchDriver class</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span> <span class="n">This</span> <span class="n">code</span> <span class="n">demonstrates</span> <span class="n">how</span> <span class="n">to</span> <span class="n">highlight</span> <span class="n">words</span> <span class="k">with</span>
<span class="o">//</span> <span class="n">either</span> <span class="n">a</span> <span class="n">word</span> <span class="ow">or</span> <span class="n">page</span> <span class="n">highlight</span> <span class="nb">list</span>
<span class="n">void</span> <span class="n">CActiveViewDoc</span><span class="p">::</span><span class="n">OnToolsHilitewords</span><span class="p">()</span>
<span class="p">{</span>
   <span class="n">CAcroAVPageView</span> <span class="n">pageView</span><span class="p">;</span>
   <span class="n">CAcroPDPage</span> <span class="n">page</span><span class="p">;</span>
   <span class="n">CAcroPDTextSelect</span><span class="o">*</span> <span class="n">textSelect</span> <span class="o">=</span> <span class="n">new</span> <span class="n">CAcroPDTextSelect</span><span class="p">;</span>
   <span class="n">CAcroHiliteList</span><span class="o">*</span> <span class="n">hilite</span> <span class="o">=</span> <span class="n">new</span> <span class="n">CAcroHiliteList</span><span class="p">;</span>
   <span class="n">char</span> <span class="n">buf</span><span class="p">[</span><span class="mi">255</span><span class="p">];</span>
   <span class="n">long</span> <span class="n">selectionSize</span><span class="p">;</span>

   <span class="k">if</span> <span class="p">((</span><span class="n">BOOL</span><span class="p">)</span> <span class="n">GetCurrentPageNum</span><span class="p">()</span> <span class="o">&gt;</span> <span class="n">PDBeforeFirstPage</span><span class="p">)</span> <span class="p">{</span>

       <span class="o">//</span> <span class="n">Obtain</span> <span class="n">the</span> <span class="n">AVPageView</span>
       <span class="n">pageView</span><span class="o">.</span><span class="n">AttachDispatch</span><span class="p">(</span><span class="n">m_pAcroAVDoc</span><span class="o">-&gt;</span><span class="n">GetAVPageView</span><span class="p">(),</span><span class="n">TRUE</span><span class="p">);</span>

       <span class="o">//</span> <span class="n">Create</span> <span class="n">the</span> <span class="n">Hilite</span> <span class="nb">list</span> <span class="nb">object</span>
       <span class="n">hilite</span><span class="o">-&gt;</span><span class="n">CreateDispatch</span><span class="p">(</span><span class="s2">&quot;AcroExch.HiliteList&quot;</span><span class="p">);</span>
       <span class="k">if</span> <span class="p">(</span><span class="n">hilite</span><span class="p">)</span> <span class="p">{</span>

   <span class="o">//</span> <span class="n">Add</span> <span class="n">the</span> <span class="n">first</span> <span class="mi">10</span> <span class="n">words</span> <span class="ow">or</span> <span class="n">characters</span> <span class="n">of</span> <span class="n">that</span> <span class="n">page</span> <span class="n">to</span> <span class="n">the</span> <span class="n">highlight</span> <span class="nb">list</span>
           <span class="n">hilite</span><span class="o">-&gt;</span><span class="n">Add</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">);</span>
           <span class="n">page</span><span class="o">.</span><span class="n">AttachDispatch</span><span class="p">(</span><span class="n">pageView</span><span class="o">.</span><span class="n">GetPage</span><span class="p">(),</span> <span class="n">TRUE</span><span class="p">);</span>

           <span class="o">//</span> <span class="n">Create</span> <span class="n">text</span> <span class="n">selection</span> <span class="k">for</span> <span class="n">either</span> <span class="n">page</span> <span class="ow">or</span> <span class="n">word</span> <span class="n">highlight</span> <span class="nb">list</span>
           <span class="n">textSelect</span><span class="o">-&gt;</span><span class="n">AttachDispatch</span><span class="p">(</span><span class="n">page</span><span class="o">.</span><span class="n">CreateWordHilite</span><span class="p">(</span><span class="n">hilite</span><span class="o">-&gt;</span><span class="n">m_lpDispatch</span><span class="p">));</span>
           <span class="n">m_pAcroAVDoc</span><span class="o">-&gt;</span><span class="n">SetTextSelection</span><span class="p">(</span><span class="n">textSelect</span><span class="o">-&gt;</span><span class="n">m_lpDispatch</span><span class="p">);</span>
           <span class="n">m_pAcroAVDoc</span><span class="o">-&gt;</span><span class="n">ShowTextSelect</span><span class="p">();</span>

           <span class="o">//</span> <span class="n">Extract</span> <span class="n">the</span> <span class="n">number</span> <span class="n">of</span> <span class="n">words</span> <span class="ow">and</span> <span class="n">the</span> <span class="n">first</span> <span class="n">word</span> <span class="n">of</span> <span class="n">text</span> <span class="n">selection</span>
           <span class="n">selectionSize</span> <span class="o">=</span> <span class="n">textSelect</span><span class="o">-&gt;</span><span class="n">GetNumText</span><span class="p">();</span>
           <span class="k">if</span> <span class="p">(</span><span class="n">selectionSize</span><span class="p">)</span>
               <span class="n">sprintf</span> <span class="p">(</span><span class="n">buf</span><span class="p">,</span> <span class="s2">&quot;# of words in text selection: </span><span class="si">%ld</span><span class="s2">n1st word in text</span>
                   <span class="n">selection</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">&#39;</span><span class="s2">&quot;, selectionSize, textSelect-&gt;GetText(0));</span>
           <span class="k">else</span>
               <span class="n">sprintf</span> <span class="p">(</span><span class="n">buf</span><span class="p">,</span> <span class="s2">&quot;Failed to create text selection.&quot;</span><span class="p">);</span>

           <span class="n">AfxMessageBox</span><span class="p">(</span><span class="n">buf</span><span class="p">);</span>
       <span class="p">}</span>
   <span class="p">}</span>

   <span class="n">delete</span> <span class="n">textSelect</span><span class="p">;</span>
   <span class="n">delete</span> <span class="n">hilite</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>In the preceding example, the objects with the prefix <code class="docutils literal notranslate"><span class="pre">CAcro</span></code> are all <code class="docutils literal notranslate"><span class="pre">CAcro</span></code> class objects—and they are also <code class="docutils literal notranslate"><span class="pre">COleDispatchDriver</span></code> objects—because all the Acrobat <code class="docutils literal notranslate"><span class="pre">CAcro</span></code> classes are subclasses of <code class="docutils literal notranslate"><span class="pre">COleDispatchDriver</span></code>.</p>
<p><em>Instantiating a class is not sufficient to use it</em> . Before you use an object, you must <em>attach</em> your object to the appropriate Acrobat object by using one of the <code class="docutils literal notranslate"><span class="pre">Dispatch</span></code> methods of the <code class="docutils literal notranslate"><span class="pre">COleDispatchDriver</span></code> class. These functions also initialize the <code class="docutils literal notranslate"><span class="pre">m_lpDispatch</span></code> instance variable for the object.</p>
<p>This code from the previous example shows how to attach an <code class="docutils literal notranslate"><span class="pre">IDispatch</span></code> that already exists:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CAcroAVPageView</span> <span class="n">pageView</span><span class="p">;</span>

<span class="o">//</span> <span class="n">Obtain</span> <span class="n">the</span> <span class="n">AVPageView</span>

<span class="n">pageView</span><span class="o">.</span><span class="n">AttachDispatch</span><span class="p">(</span><span class="n">m_pAcroAVDoc</span><span class="o">-&gt;</span><span class="n">GetAVPageView</span><span class="p">(),</span> <span class="n">TRUE</span><span class="p">);</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">GetAVPageView</span></code> method of the <code class="docutils literal notranslate"><span class="pre">CAcroAVDoc</span></code> class returns an <code class="docutils literal notranslate"><span class="pre">LPDISPATCH</span></code>, which is what the <code class="docutils literal notranslate"><span class="pre">AttachDispatch</span></code> method is expecting for its first argument. The <code class="docutils literal notranslate"><span class="pre">BOOL</span></code> passed as the second argument indicates whether or not the <code class="docutils literal notranslate"><span class="pre">IDispatch</span></code> should be released when the object goes out of scope, and is typically <code class="docutils literal notranslate"><span class="pre">TRUE</span></code>. In general, when an <code class="docutils literal notranslate"><span class="pre">LPDISPATCH</span></code> is returned from a method such as <code class="docutils literal notranslate"><span class="pre">GetAVPageView</span></code>, you use <code class="docutils literal notranslate"><span class="pre">AttachDispatch</span></code> to attach it to an object.</p>
<p>The following code from the previous example uses the <code class="docutils literal notranslate"><span class="pre">CreateDispatch</span></code> method:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CAcroHiliteList</span> <span class="o">*</span><span class="n">hilite</span> <span class="o">=</span> <span class="n">new</span> <span class="n">CAcroHiliteList</span><span class="p">;</span>
<span class="n">hilite</span><span class="o">-&gt;</span><span class="n">CreateDispatch</span><span class="p">(</span><span class="s2">&quot;AcroExch.HiliteList&quot;</span><span class="p">);</span>
<span class="n">hilite</span><span class="o">-&gt;</span><span class="n">Add</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">);</span>
</pre></div>
</div>
<p>In this case, the <code class="docutils literal notranslate"><span class="pre">CreateDispatch</span></code> method both creates the <code class="docutils literal notranslate"><span class="pre">IDispatch</span></code> object and attaches it to the object. This code works fine; however, the following code would fail:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CAcroHiliteList</span> <span class="o">*</span><span class="n">hilite</span> <span class="o">=</span> <span class="n">new</span> <span class="n">CAcroHiliteList</span><span class="p">;</span>
<span class="n">hilite</span><span class="o">-&gt;</span><span class="n">Add</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">);</span>
</pre></div>
</div>
<p>This error is analogous to using an uninitialized variable. Until the <code class="docutils literal notranslate"><span class="pre">IDispatch</span></code> object is attached to the <code class="docutils literal notranslate"><span class="pre">COleDispatchDriver</span></code> object, it is not valid.</p>
<p><code class="docutils literal notranslate"><span class="pre">CreateDispatch</span></code> takes a string parameter, such as <code class="docutils literal notranslate"><span class="pre">&quot;AcroExch.HiliteList&quot;</span></code>, which represents a class. The following code is incorrect:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CAcroPDDoc</span> <span class="n">doc</span> <span class="o">=</span> <span class="n">new</span> <span class="n">CAcroPDDoc</span><span class="p">;</span>
<span class="n">doc</span><span class="o">.</span><span class="n">CreateDispatch</span><span class="p">(</span><span class="s2">&quot;AcroExch.Create&quot;</span><span class="p">);</span>
</pre></div>
</div>
<p>This fails because Acrobat won’t respond to such a parameter. The parameter should be <code class="docutils literal notranslate"><span class="pre">&quot;AcroExch.PDDoc&quot;</span></code> instead.</p>
<p>The valid strings for <code class="docutils literal notranslate"><span class="pre">CreateDispatch</span></code> are as follows:</p>
<table class="colwidths-given docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Class</p></th>
<th class="head"><p>String</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>CAcroPoint</p></td>
<td><p>“AcroExch.Point”</p></td>
</tr>
<tr class="row-odd"><td><p>CAcroRect</p></td>
<td><p>“AcroExch.Rect”</p></td>
</tr>
<tr class="row-even"><td><p>CAcroTime</p></td>
<td><p>“AcroExch.Time”</p></td>
</tr>
<tr class="row-odd"><td><p>CAcroApp</p></td>
<td><p>“AcroExch.App”</p></td>
</tr>
<tr class="row-even"><td><p>CAcroPDDoc</p></td>
<td><p>“AcroExch.PDDoc”</p></td>
</tr>
<tr class="row-odd"><td><p>CAcroAVDoc</p></td>
<td><p>“AcroExch.AVDoc”</p></td>
</tr>
<tr class="row-even"><td><p>CAcroHiliteList</p></td>
<td><p>“AcroExch.HiliteList”</p></td>
</tr>
<tr class="row-odd"><td><p>CAcroPDBookmark</p></td>
<td><p>“AcroExch.PDBookmark”</p></td>
</tr>
<tr class="row-even"><td><p>CAcroMatrix</p></td>
<td><p>“AcroExch.Matrix”</p></td>
</tr>
<tr class="row-odd"><td><p>AcroPDF</p></td>
<td><p>“AxAcroPDFLib.AxAcroPDF”</p></td>
</tr>
</tbody>
</table>
<p>Refer again to this code from the previous example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CAcroPDPage</span> <span class="n">page</span><span class="p">;</span>
<span class="n">page</span><span class="o">.</span><span class="n">AttachDispatch</span><span class="p">(</span><span class="n">pageView</span><span class="o">.</span><span class="n">GetPage</span><span class="p">(),</span> <span class="n">TRUE</span><span class="p">);</span>
</pre></div>
</div>
<p>A <code class="docutils literal notranslate"><span class="pre">PDPage</span></code> object is required because the purpose of this code is to highlight words on the current page. Since it is a <code class="docutils literal notranslate"><span class="pre">CAcro</span></code> variable, it is necessary to attach to the OLE object before using its methods. <code class="docutils literal notranslate"><span class="pre">CreateDispatch</span></code> cannot be used to create a <code class="docutils literal notranslate"><span class="pre">PDPage</span></code> object because <code class="docutils literal notranslate"><span class="pre">&quot;AcroExch.PDPage&quot;</span></code> is not a valid string for <code class="docutils literal notranslate"><span class="pre">CreateDispatch</span></code>. However, the <code class="docutils literal notranslate"><span class="pre">AVPageView</span></code> method <code class="docutils literal notranslate"><span class="pre">GetPage</span></code> returns an <code class="docutils literal notranslate"><span class="pre">LPDISPATCH</span></code> pointer for a <code class="docutils literal notranslate"><span class="pre">PDPage</span></code> object. This is passed as the first argument to the <code class="docutils literal notranslate"><span class="pre">AttachDispatch</span></code> method of the page object. The <code class="docutils literal notranslate"><span class="pre">TRUE</span></code> argument indicates that the object is to be released automatically when it goes out of scope.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CAcroPDTextSelect</span><span class="o">*</span> <span class="n">textSelect</span> <span class="o">=</span> <span class="n">new</span> <span class="n">CAcroPDTextSelect</span><span class="p">;</span>
<span class="n">textSelect</span><span class="o">-&gt;</span><span class="n">AttachDispatch</span>
   <span class="p">(</span><span class="n">page</span><span class="o">.</span><span class="n">CreateWordHilite</span><span class="p">(</span><span class="n">hilite</span><span class="o">-&gt;</span><span class="n">m_lpDispatch</span><span class="p">));</span>
<span class="n">m_pAcroAVDoc</span><span class="o">-&gt;</span><span class="n">SetTextSelection</span> <span class="p">(</span><span class="n">textSelect</span><span class="o">-&gt;</span><span class="n">m_lpDispatch</span><span class="p">);</span>
<span class="n">m_pAcroAVDoc</span><span class="o">-&gt;</span><span class="n">ShowTextSelect</span><span class="p">();</span>
</pre></div>
</div>
<p>This code performs the following steps:</p>
<ol class="arabic simple">
<li><p>Declares a text selection object <code class="docutils literal notranslate"><span class="pre">textSelect</span></code>.</p></li>
<li><p>Calls the <code class="docutils literal notranslate"><span class="pre">CAcroPDPage</span></code> method <code class="docutils literal notranslate"><span class="pre">CreateWordHilite</span></code>, which returns an <code class="docutils literal notranslate"><span class="pre">LPDISPATCH</span></code> for a <code class="docutils literal notranslate"><span class="pre">PDTextSelect</span></code>. <code class="docutils literal notranslate"><span class="pre">CreateWordHilite</span></code> takes an <code class="docutils literal notranslate"><span class="pre">LPDISPATCH</span></code> argument representing a <code class="docutils literal notranslate"><span class="pre">CAcroHilite</span></code> list. The <code class="docutils literal notranslate"><span class="pre">hilite</span></code> variable already contains a <code class="docutils literal notranslate"><span class="pre">CAcroHiliteList</span></code> object, and its instance variable <code class="docutils literal notranslate"><span class="pre">m_lpDispatch</span></code> contains the <code class="docutils literal notranslate"><span class="pre">LPDISPATCH</span></code> pointer for the object.</p></li>
<li><p>Calls the <code class="docutils literal notranslate"><span class="pre">CAcroAVDoc</span></code> object’s <code class="docutils literal notranslate"><span class="pre">SetTextSelection</span></code> method to select the first ten words on the current page.</p></li>
<li><p>Calls the <code class="docutils literal notranslate"><span class="pre">AcroAVDoc's</span></code> <code class="docutils literal notranslate"><span class="pre">ShowTextSelect</span></code> method to cause the visual update on the screen.</p></li>
</ol>
<a name="50532372_56738"></a></div>
</div>
<div class="section" id="using-the-jsobject-interface">
<h2>Using the JSObject interface<a class="headerlink" href="#using-the-jsobject-interface" title="Permalink to this headline">¶</a></h2>
<p>Acrobat provides a rich set of JavaScript programming interfaces that can be used from within the Acrobat environment. It also provides the <code class="docutils literal notranslate"><span class="pre">JSObject</span></code> interface, which allows external clients to access the same functionality from environments such as Visual Basic.</p>
<p>In precise terms, <code class="docutils literal notranslate"><span class="pre">JSObject</span></code> is an interpretation layer between an OLE automation client, such as a Visual Basic application, and the JavaScript functionality provided by Acrobat. From a developer’s point of view, programming <code class="docutils literal notranslate"><span class="pre">JSObject</span></code> in a Visual Basic environment is similar to programming in JavaScript using the Acrobat console.</p>
<p>This section explains how to extend Acrobat using JavaScript in a Visual Basic programming environment. It provides a set of examples to illustrate the key concepts.</p>
<p>Whenever possible, you should take advantage of these capabilities by using the <code class="docutils literal notranslate"><span class="pre">JSObject</span></code> interface available within the <code class="docutils literal notranslate"><span class="pre">AcroExch.PDDoc</span></code> object. To obtain the interface, invoke the object’s <code class="docutils literal notranslate"><span class="pre">GetJSObject</span></code> method.</p>
<div class="section" id="adding-a-reference-to-the-acrobat-type-library">
<h3>Adding a reference to the Acrobat type library<a class="headerlink" href="#adding-a-reference-to-the-acrobat-type-library" title="Permalink to this headline">¶</a></h3>
<p>This procedure adds a reference to the Acrobat type library so that you can access the Acrobat automation APIs, including JSObject, in Visual Basic. Do this before using the JSObject interface, as in the examples that follow.</p>
<ol class="arabic simple">
<li><p>To add a reference to the Acrobat type library:</p></li>
<li><p>Install Acrobat and Visual Basic.</p></li>
<li><p>Create a new Visual Basic project from the Windows Application template. This provides a blank form and project workspace.</p></li>
<li><p>Select <strong>Project</strong> &gt; <strong>Add Reference</strong> and click the <strong>COM</strong> tab.</p></li>
<li><p>From the list of available references, select <strong>Adobe Acrobat &lt;version&gt; Type Library</strong> and click <strong>OK</strong>.</p></li>
</ol>
</div>
<div class="section" id="creating-a-simple-application">
<h3>Creating a simple application<a class="headerlink" href="#creating-a-simple-application" title="Permalink to this headline">¶</a></h3>
<p>This example provides the minimum code to display “Hello, Acrobat!” in the Acrobat JavaScript console.</p>
<ol class="arabic simple">
<li><p>To set up and run the “Hello, Acrobat!” example:</p></li>
<li><p>Open the source code window for the default form by clicking <strong>View</strong> &gt; <strong>Code</strong>.</p></li>
<li><p>Select <strong>(Form1 Events)</strong> from the selection box in the upper left corner of that window.</p></li>
</ol>
<p>The selection box in the upper right corner now shows all the functions available to the Form1 object.</p>
<ol class="arabic simple">
<li><p>Select <strong>Load</strong> from the functions selection box. This creates an empty function stub. The Form1 <code class="docutils literal notranslate"><span class="pre">Load</span></code> function is called when Form1 is first displayed, so this is a good place to add the initialization code.</p></li>
<li><p>Add the following code to define some global variables before the subroutine.</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Dim</span> <span class="n">gApp</span> <span class="n">As</span> <span class="n">Acrobat</span><span class="o">.</span><span class="n">CAcroApp</span>
<span class="n">Dim</span> <span class="n">gPDDoc</span> <span class="n">As</span> <span class="n">Acrobat</span><span class="o">.</span><span class="n">CAcroPDDoc</span>
<span class="n">Dim</span> <span class="n">jso</span> <span class="n">As</span> <span class="n">Object</span>
</pre></div>
</div>
<ol class="arabic simple">
<li><p>Add the following code to the private <code class="docutils literal notranslate"><span class="pre">Form1_Load</span></code> subroutine.</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gApp</span> <span class="o">=</span> <span class="n">CreateObject</span><span class="p">(</span><span class="s2">&quot;AcroExch.App&quot;</span><span class="p">)</span>
<span class="n">gPDDoc</span> <span class="o">=</span> <span class="n">CreateObject</span><span class="p">(</span><span class="s2">&quot;AcroExch.PDDoc&quot;</span><span class="p">)</span>
<span class="n">If</span> <span class="n">gPDDoc</span><span class="o">.</span><span class="n">Open</span><span class="p">(</span><span class="s2">&quot;c:example.pdf&quot;</span><span class="p">)</span> <span class="n">Then</span>
    <span class="n">jso</span> <span class="o">=</span> <span class="n">gPDDoc</span><span class="o">.</span><span class="n">GetJSObject</span>
    <span class="n">jso</span><span class="o">.</span><span class="n">console</span><span class="o">.</span><span class="n">Show</span>
    <span class="n">jso</span><span class="o">.</span><span class="n">console</span><span class="o">.</span><span class="n">Clear</span>
    <span class="n">jso</span><span class="o">.</span><span class="n">console</span><span class="o">.</span><span class="n">println</span> <span class="p">(</span><span class="s2">&quot;Hello, Acrobat!&quot;</span><span class="p">)</span>
    <span class="n">gApp</span><span class="o">.</span><span class="n">Show</span>
<span class="n">End</span> <span class="n">If</span>
</pre></div>
</div>
<ol class="arabic simple">
<li><p>Create a file called <code class="docutils literal notranslate"><span class="pre">example.pdf</span></code> at the root level of the C: drive.</p></li>
<li><p>Save and run the project.</p></li>
</ol>
<p>When you run the application, Acrobat is launched, Form1 is displayed, and the JavaScript Debugger window is opened, displaying “Hello, Acrobat!”.</p>
<ol class="arabic simple">
<li><p>Displaying “Hello, Acrobat!” in the JavaScript console</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Dim</span> <span class="n">gApp</span> <span class="n">As</span> <span class="n">Acrobat</span><span class="o">.</span><span class="n">CAcroApp</span>
<span class="n">Dim</span> <span class="n">gPDDoc</span> <span class="n">As</span> <span class="n">Acrobat</span><span class="o">.</span><span class="n">CAcroPDDoc</span>
<span class="n">Dim</span> <span class="n">jso</span> <span class="n">As</span> <span class="n">Object</span>

<span class="n">Private</span> <span class="n">Sub</span> <span class="n">Form1_Load</span><span class="p">(</span><span class="n">ByVal</span> <span class="n">sender</span> <span class="n">As</span> <span class="n">Object</span><span class="p">,</span> <span class="n">ByVal</span> <span class="n">e</span> <span class="n">As</span> <span class="n">System</span><span class="o">.</span><span class="n">EventArgs</span><span class="p">)</span>

         <span class="n">Handles</span> <span class="n">Me</span><span class="o">.</span><span class="n">Load</span>
    <span class="n">gApp</span> <span class="o">=</span> <span class="n">CreateObject</span><span class="p">(</span><span class="s2">&quot;AcroExch.App&quot;</span><span class="p">)</span>
    <span class="n">gPDDoc</span> <span class="o">=</span> <span class="n">CreateObject</span><span class="p">(</span><span class="s2">&quot;AcroExch.PDDoc&quot;</span><span class="p">)</span>
    <span class="n">If</span> <span class="n">gPDDoc</span><span class="o">.</span><span class="n">Open</span><span class="p">(</span><span class="s2">&quot;c:example.pdf&quot;</span><span class="p">)</span> <span class="n">Then</span>
        <span class="n">jso</span> <span class="o">=</span> <span class="n">gPDDoc</span><span class="o">.</span><span class="n">GetJSObject</span>
        <span class="n">jso</span><span class="o">.</span><span class="n">console</span><span class="o">.</span><span class="n">Show</span>
        <span class="n">jso</span><span class="o">.</span><span class="n">console</span><span class="o">.</span><span class="n">Clear</span>
        <span class="n">jso</span><span class="o">.</span><span class="n">console</span><span class="o">.</span><span class="n">println</span> <span class="p">(</span><span class="s2">&quot;Hello, Acrobat!&quot;</span><span class="p">)</span>
        <span class="n">gApp</span><span class="o">.</span><span class="n">Show</span>
    <span class="n">End</span> <span class="n">If</span>
<span class="n">End</span> <span class="n">Sub</span>
</pre></div>
</div>
<p>The Visual Basic program attaches to the Acrobat automation interface using the <code class="docutils literal notranslate"><span class="pre">CreateObject</span></code> call, and then shows the main window using the <code class="docutils literal notranslate"><span class="pre">App</span></code> object’s <code class="docutils literal notranslate"><span class="pre">Show</span></code> command.</p>
<p>You may have a few questions after studying the code. For example, why is <code class="docutils literal notranslate"><span class="pre">jso</span></code> declared as an Object, while <code class="docutils literal notranslate"><span class="pre">gApp</span></code> and <code class="docutils literal notranslate"><span class="pre">gPDDoc</span></code> are declared as types found in the Acrobat type library? Is there a real type for <code class="docutils literal notranslate"><span class="pre">JSObject</span></code> ?</p>
<p>The answer is no, <code class="docutils literal notranslate"><span class="pre">JSObject</span></code> does not appear in the type library, except in the context of the <code class="docutils literal notranslate"><span class="pre">CAcroPDDoc.GetJSObject</span></code> call. The COM interface used to export JavaScript functionality through JSObject is known as an IDispatch interface, which in Visual Basic is more commonly known simply as an “Object” type. This means that the methods available to the programmer are not particularly well-defined. For example, if you replace the call to</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">jso</span><span class="o">.</span><span class="n">console</span><span class="o">.</span><span class="n">clear</span>
</pre></div>
</div>
<p>with</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">jso</span><span class="o">.</span><span class="n">ThisCantPossiblyCompileCanIt</span><span class="p">(</span><span class="s2">&quot;Yes it can!&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>the compiler compiles the code, but fails at run time. Visual Basic has no type information for <code class="docutils literal notranslate"><span class="pre">JSObject</span></code>, so Visual Basic does not know if a particular call is syntactically valid until run-time, and will compile any function call to a <code class="docutils literal notranslate"><span class="pre">JSObject</span></code>. For that reason, you must rely on the documentation to know what functionality is available through the <code class="docutils literal notranslate"><span class="pre">JSObject</span></code> interface. For details, see the JavaScript for Acrobat API Reference.</p>
<p>You may also wonder why it is necessary to open a <code class="docutils literal notranslate"><span class="pre">PDDoc</span></code> before creating a <code class="docutils literal notranslate"><span class="pre">JSObject</span></code>. Running the program shows that no document appears onscreen, and suggests that using the JavaScript console should be possible without a <code class="docutils literal notranslate"><span class="pre">PDDoc</span></code>. However, <code class="docutils literal notranslate"><span class="pre">JSObject</span></code> is designed to work closely with a particular document, as most of the available features operate at the document level. There are some application-level features in JavaScript (and therefore in <code class="docutils literal notranslate"><span class="pre">JSObject</span></code>), but they are of secondary interest. In practice, a <code class="docutils literal notranslate"><span class="pre">JSObject</span></code> is always associated with a particular document.</p>
<p>When working with a large number of documents, you must structure your code so that a new <code class="docutils literal notranslate"><span class="pre">JSObject</span></code> is acquired for each document, rather than creating a single <code class="docutils literal notranslate"><span class="pre">JSObject</span></code> to work on every document.</p>
</div>
<div class="section" id="working-with-annotations">
<h3>Working with annotations<a class="headerlink" href="#working-with-annotations" title="Permalink to this headline">¶</a></h3>
<p>This example uses the <code class="docutils literal notranslate"><span class="pre">JSObject</span></code> interface to open a PDF file, add a predefined annotation to it, and save the file back to disk.</p>
<ol class="arabic simple">
<li><p>To set up and run the annotations example:</p></li>
<li><p>Create a new Visual Basic project and add the Adobe Acrobat type library to the project.</p></li>
<li><p>From the Toolbox, drag the <strong>OpenFileDialog</strong> control to the form.</p></li>
<li><p>Drag a <strong>Button</strong> to your form.</p></li>
</ol>
<img alt="_images/dragbutton.png" src="_images/dragbutton.png" />
<ol class="arabic simple">
<li><p>Select <strong>View</strong> &gt; <strong>Code</strong> and set up the following source code:</p></li>
<li><p>Adding an annotation</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Dim</span> <span class="n">gApp</span> <span class="n">As</span> <span class="n">Acrobat</span><span class="o">.</span><span class="n">CAcroApp</span>

<span class="n">Private</span> <span class="n">Sub</span> <span class="n">Form1_Load</span><span class="p">(</span><span class="n">ByVal</span> <span class="n">sender</span> <span class="n">As</span> <span class="n">System</span><span class="o">.</span><span class="n">Object</span><span class="p">,</span> <span class="n">ByVal</span> <span class="n">e</span> <span class="n">As</span>

    <span class="n">System</span><span class="o">.</span><span class="n">EventArgs</span><span class="p">)</span> <span class="n">Handles</span> <span class="n">MyBase</span><span class="o">.</span><span class="n">Load</span>
    <span class="n">gApp</span> <span class="o">=</span> <span class="n">CreateObject</span><span class="p">(</span><span class="s2">&quot;AcroExch.App&quot;</span><span class="p">)</span>
<span class="n">End</span> <span class="n">Sub</span>

<span class="n">Private</span> <span class="n">Sub</span> <span class="n">Form1_Closed</span><span class="p">(</span><span class="n">Cancel</span> <span class="n">As</span> <span class="n">Integer</span><span class="p">)</span>
    <span class="n">If</span> <span class="n">Not</span> <span class="n">gApp</span> <span class="n">Is</span> <span class="n">Nothing</span> <span class="n">Then</span>
        <span class="n">gApp</span><span class="o">.</span><span class="n">Exit</span>
    <span class="n">End</span> <span class="n">If</span>
    <span class="n">gApp</span> <span class="o">=</span> <span class="n">Nothing</span>
<span class="n">End</span> <span class="n">Sub</span>

<span class="n">Private</span> <span class="n">Sub</span> <span class="n">Button1_Click</span><span class="p">(</span><span class="n">ByVal</span> <span class="n">sender</span> <span class="n">As</span> <span class="n">System</span><span class="o">.</span><span class="n">Object</span><span class="p">,</span> <span class="n">ByVal</span> <span class="n">e</span> <span class="n">As</span>

    <span class="n">System</span><span class="o">.</span><span class="n">EventArgs</span><span class="p">)</span> <span class="n">Handles</span> <span class="n">Button1</span><span class="o">.</span><span class="n">Click</span>
    <span class="n">Dim</span> <span class="n">pdDoc</span> <span class="n">As</span> <span class="n">Acrobat</span><span class="o">.</span><span class="n">CAcroPDDoc</span>
    <span class="n">Dim</span> <span class="n">page</span> <span class="n">As</span> <span class="n">Acrobat</span><span class="o">.</span><span class="n">CAcroPDPage</span>
    <span class="n">Dim</span> <span class="n">jso</span> <span class="n">As</span> <span class="n">Object</span>
    <span class="n">Dim</span> <span class="n">path</span> <span class="n">As</span> <span class="n">String</span>
    <span class="n">Dim</span> <span class="n">point</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="n">As</span> <span class="n">Integer</span>
    <span class="n">Dim</span> <span class="n">popupRect</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="n">As</span> <span class="n">Integer</span>
    <span class="n">Dim</span> <span class="n">pageRect</span> <span class="n">As</span> <span class="n">Object</span>
    <span class="n">Dim</span> <span class="n">annot</span> <span class="n">As</span> <span class="n">Object</span>
    <span class="n">Dim</span> <span class="n">props</span> <span class="n">As</span> <span class="n">Object</span>

    <span class="n">OpenFileDialog1</span><span class="o">.</span><span class="n">ShowDialog</span><span class="p">()</span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">OpenFileDialog1</span><span class="o">.</span><span class="n">FileName</span>

    <span class="n">pdDoc</span> <span class="o">=</span> <span class="n">CreateObject</span><span class="p">(</span><span class="s2">&quot;AcroExch.PDDoc&quot;</span><span class="p">)</span>
    <span class="n">If</span> <span class="n">pdDoc</span><span class="o">.</span><span class="n">Open</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="n">Then</span>
        <span class="n">jso</span> <span class="o">=</span> <span class="n">pdDoc</span><span class="o">.</span><span class="n">GetJSObject</span>
        <span class="n">If</span> <span class="n">Not</span> <span class="n">jso</span> <span class="n">Is</span> <span class="n">Nothing</span> <span class="n">Then</span>

            <span class="s1">&#39; Get size for page 0 and set up arrays</span>
            <span class="n">page</span> <span class="o">=</span> <span class="n">pdDoc</span><span class="o">.</span><span class="n">AcquirePage</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">pageRect</span> <span class="o">=</span> <span class="n">page</span><span class="o">.</span><span class="n">GetSize</span>
            <span class="n">point</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">point</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">pageRect</span><span class="o">.</span><span class="n">y</span>
            <span class="n">popupRect</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">popupRect</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">pageRect</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="mi">100</span>
            <span class="n">popupRect</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="mi">200</span>
            <span class="n">popupRect</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">pageRect</span><span class="o">.</span><span class="n">y</span>

            <span class="s1">&#39; Create a new text annot</span>
            <span class="n">annot</span> <span class="o">=</span> <span class="n">jso</span><span class="o">.</span><span class="n">AddAnnot</span>
            <span class="n">props</span> <span class="o">=</span> <span class="n">annot</span><span class="o">.</span><span class="n">getProps</span>
            <span class="n">props</span><span class="o">.</span><span class="n">Type</span> <span class="o">=</span> <span class="s2">&quot;Text&quot;</span>
            <span class="n">annot</span><span class="o">.</span><span class="n">setProps</span> <span class="n">props</span>

            <span class="s1">&#39; Fill in a few fields</span>
            <span class="n">props</span> <span class="o">=</span> <span class="n">annot</span><span class="o">.</span><span class="n">getProps</span>
            <span class="n">props</span><span class="o">.</span><span class="n">page</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">props</span><span class="o">.</span><span class="n">point</span> <span class="o">=</span> <span class="n">point</span>
            <span class="n">props</span><span class="o">.</span><span class="n">popupRect</span> <span class="o">=</span> <span class="n">popupRect</span>
            <span class="n">props</span><span class="o">.</span><span class="n">author</span> <span class="o">=</span> <span class="s2">&quot;John Doe&quot;</span>
            <span class="n">props</span><span class="o">.</span><span class="n">noteIcon</span> <span class="o">=</span> <span class="s2">&quot;Comment&quot;</span>
            <span class="n">props</span><span class="o">.</span><span class="n">strokeColor</span> <span class="o">=</span> <span class="n">jso</span><span class="o">.</span><span class="n">Color</span><span class="o">.</span><span class="n">red</span>
            <span class="n">props</span><span class="o">.</span><span class="n">Contents</span> <span class="o">=</span> <span class="s2">&quot;I added this comment from Visual Basic!&quot;</span>
            <span class="n">annot</span><span class="o">.</span><span class="n">setProps</span> <span class="n">props</span>
        <span class="n">End</span> <span class="n">If</span>
        <span class="n">pdDoc</span><span class="o">.</span><span class="n">Close</span>
        <span class="n">MsgBox</span> <span class="s2">&quot;Annotation added to &quot;</span> <span class="o">&amp;</span> <span class="n">path</span>
    <span class="n">Else</span>
        <span class="n">MsgBox</span> <span class="s2">&quot;Failed to open &quot;</span> <span class="o">&amp;</span> <span class="n">path</span>
    <span class="n">End</span> <span class="n">If</span>

    <span class="n">pdDoc</span> <span class="o">=</span> <span class="n">Nothing</span>
<span class="n">End</span> <span class="n">Sub</span>
</pre></div>
</div>
<ol class="arabic simple">
<li><p>Save and run the application.</p></li>
</ol>
<p>The code in the <code class="docutils literal notranslate"><span class="pre">Form_Load</span></code> and <code class="docutils literal notranslate"><span class="pre">Form_Closed</span></code> routines initializes and shuts down the Acrobat automation interface. More interesting work happens in the Command button’s click routine. The first lines declare local variables and show the Windows Open dialog box, which allows the user to select a file to be annotated. The code then opens the PDF file’s <code class="docutils literal notranslate"><span class="pre">PDDoc</span></code> object and obtains a <code class="docutils literal notranslate"><span class="pre">JSObject</span></code> interface to that document.</p>
<p>Some standard Acrobat automation methods are used to determine the size of the first page in the document. These numbers are critical to achieving the correct layout, because the PDF coordinate system is based in the lower-left corner of the page, but the annotation will be anchored at the upper left corner of the page.</p>
<p>The lines following the <code class="docutils literal notranslate"><span class="pre">&quot;Create</span> <span class="pre">a</span> <span class="pre">new</span> <span class="pre">text</span> <span class="pre">annot&quot;</span></code> comment do exactly that, but this block of code bears additional explanation.</p>
<p>First, <code class="docutils literal notranslate"><span class="pre">addAnnot</span></code> looks as if it is a method of <code class="docutils literal notranslate"><span class="pre">JSObject</span></code>, but the JavaScript reference shows that the method is associated with the <code class="docutils literal notranslate"><span class="pre">doc</span></code> object. You might expect the syntax to be <code class="docutils literal notranslate"><span class="pre">jso.doc.addAnnot</span></code>. However, <code class="docutils literal notranslate"><span class="pre">jso</span></code> is the <code class="docutils literal notranslate"><span class="pre">Doc</span></code> object, so <code class="docutils literal notranslate"><span class="pre">jso.addAnnot</span></code> is correct. All of the properties and methods in the <code class="docutils literal notranslate"><span class="pre">Doc</span></code> object are used in this manner.</p>
<p>Second, observe the use of <code class="docutils literal notranslate"><span class="pre">annot.getProps</span></code> and <code class="docutils literal notranslate"><span class="pre">annot.setProps</span></code>. The <code class="docutils literal notranslate"><span class="pre">Annot</span></code> object is implemented with a separate properties object, meaning that you cannot set the properties directly. For example, you cannot do the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">annot</span> <span class="o">=</span> <span class="n">jso</span><span class="o">.</span><span class="n">AddAnnot</span>
<span class="n">annot</span><span class="o">.</span><span class="n">Type</span> <span class="o">=</span> <span class="s2">&quot;Text&quot;</span>
<span class="n">annot</span><span class="o">.</span><span class="n">page</span> <span class="o">=</span> <span class="mi">0</span>
<span class="o">...</span>
</pre></div>
</div>
<p>Instead, you must obtain the properties object of <code class="docutils literal notranslate"><span class="pre">Annot</span></code> using <code class="docutils literal notranslate"><span class="pre">annot.getProps</span></code>, and use that object for read or write access. To save changes back to the original <code class="docutils literal notranslate"><span class="pre">Annot</span></code>, call <code class="docutils literal notranslate"><span class="pre">annot.setProps</span></code> with the modified properties object.</p>
<p>Third, note the use of <code class="docutils literal notranslate"><span class="pre">JSObject</span></code> ‘s color property. This object defines several simple colors such as red, green, and blue. In working with colors, you may need a greater range of colors than is available through this object. Also, there is a performance hit associated with every call to <code class="docutils literal notranslate"><span class="pre">JSObject</span></code>. To set colors more efficiently, you can use code such as the following, which sets the annot’s <code class="docutils literal notranslate"><span class="pre">strokeColor</span></code> to red directly, bypassing the color object.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dim</span> <span class="n">color</span><span class="p">(</span><span class="mi">0</span> <span class="n">to</span> <span class="mi">3</span><span class="p">)</span> <span class="k">as</span> <span class="n">Variant</span>
<span class="n">color</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="s2">&quot;RGB&quot;</span>
<span class="n">color</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span><span class="c1">#</span>
<span class="n">color</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="c1">#</span>
<span class="n">color</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="c1">#</span>
<span class="n">annot</span><span class="o">.</span><span class="n">strokeColor</span> <span class="o">=</span> <span class="n">color</span>
</pre></div>
</div>
<p>You can use this technique anywhere a color array is needed as a parameter to a <code class="docutils literal notranslate"><span class="pre">JSObject</span></code> routine. The example sets the colorspace to RGB and specifies floating point values ranging from 0 to 1 for red, green, and blue. Note the use of the <code class="docutils literal notranslate"><span class="pre">#</span></code> character following the color values. These are required, since they tell Visual Basic that the array element should be set to a floating point value, rather than an integer. It is also important to declare the array as containing Variants, because it contains both strings and floating point values. The other color spaces (“T”, “G”, “CMYK”) have varying requirements for array length. For more information, refer to the <code class="docutils literal notranslate"><span class="pre">Color</span></code> object in the JavaScript for Acrobat API Reference.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you want users to be able to edit annotations, set the JavaScript property <code class="docutils literal notranslate"><span class="pre">Collab.showAnnotsToolsWhenNoCollab</span></code> to true.</p>
</div>
</div>
<div class="section" id="spell-checking-a-document">
<h3>Spell-checking a document<a class="headerlink" href="#spell-checking-a-document" title="Permalink to this headline">¶</a></h3>
<p>Acrobat includes a plug-in that can scan a document for spelling errors. The plug-in also provides JavaScript methods that can be accessed using <code class="docutils literal notranslate"><span class="pre">JSObject</span></code>. In this example, you start with the source code from the example <a class="reference external" href="IAC_DevApp_OLE_Support.html#50532372_54159">Adding an annotation</a> and make the following changes:</p>
<ul class="simple">
<li><p>Add a List View control to the main form. Keep the default name <code class="docutils literal notranslate"><span class="pre">ListView1</span></code> for the control.</p></li>
<li><p>Replace the code in the existing <code class="docutils literal notranslate"><span class="pre">Command1_Click</span></code> routine with the following:</p></li>
<li><p>Spell-checking a document</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Private</span> <span class="n">Sub</span> <span class="n">Button1_Click</span><span class="p">(</span><span class="n">ByVal</span> <span class="n">sender</span> <span class="n">As</span> <span class="n">System</span><span class="o">.</span><span class="n">Object</span><span class="p">,</span> <span class="n">ByVal</span> <span class="n">e</span> <span class="n">As</span>

         <span class="n">System</span><span class="o">.</span><span class="n">EventArgs</span><span class="p">)</span> <span class="n">Handles</span> <span class="n">Button1</span><span class="o">.</span><span class="n">Click</span>
    <span class="n">Dim</span> <span class="n">pdDoc</span> <span class="n">As</span> <span class="n">Acrobat</span><span class="o">.</span><span class="n">CAcroPDDoc</span>
    <span class="n">Dim</span> <span class="n">jso</span> <span class="n">As</span> <span class="n">Object</span>
    <span class="n">Dim</span> <span class="n">path</span> <span class="n">As</span> <span class="n">String</span>
    <span class="n">Dim</span> <span class="n">count</span> <span class="n">As</span> <span class="n">Integer</span>
    <span class="n">Dim</span> <span class="n">i</span> <span class="n">As</span> <span class="n">Integer</span><span class="p">,</span> <span class="n">j</span> <span class="n">As</span> <span class="n">Integer</span>
    <span class="n">Dim</span> <span class="n">word</span> <span class="n">As</span> <span class="n">Variant</span>
    <span class="n">Dim</span> <span class="n">result</span> <span class="n">As</span> <span class="n">Variant</span>
    <span class="n">Dim</span> <span class="n">foundErr</span> <span class="n">As</span> <span class="n">Boolean</span>

    <span class="n">OpenFileDialog1</span><span class="o">.</span><span class="n">ShowDialog</span><span class="p">()</span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">OpenFileDialog1</span><span class="o">.</span><span class="n">FileName</span>
    <span class="n">foundErr</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">pdDoc</span> <span class="o">=</span> <span class="n">CreateObject</span><span class="p">(</span><span class="s2">&quot;AcroExch.PDDoc&quot;</span><span class="p">)</span>

    <span class="n">If</span> <span class="n">pdDoc</span><span class="o">.</span><span class="n">Open</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="n">Then</span>
        <span class="n">jso</span> <span class="o">=</span> <span class="n">pdDoc</span><span class="o">.</span><span class="n">GetJSObject</span>
        <span class="n">If</span> <span class="n">Not</span> <span class="n">jso</span> <span class="n">Is</span> <span class="n">Nothing</span> <span class="n">Then</span>
            <span class="n">count</span> <span class="o">=</span> <span class="n">jso</span><span class="o">.</span><span class="n">getPageNumWords</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">For</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span> <span class="n">To</span> <span class="n">count</span> <span class="o">-</span> <span class="mi">1</span>
                <span class="n">word</span> <span class="o">=</span> <span class="n">jso</span><span class="o">.</span><span class="n">getPageNthWord</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
                <span class="n">If</span> <span class="n">VarType</span><span class="p">(</span><span class="n">word</span><span class="p">)</span> <span class="o">=</span> <span class="n">vbString</span> <span class="n">Then</span>
                    <span class="n">result</span> <span class="o">=</span> <span class="n">jso</span><span class="o">.</span><span class="n">spell</span><span class="o">.</span><span class="n">checkWord</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>
                    <span class="n">If</span> <span class="n">IsArray</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="n">Then</span>
                        <span class="n">foundErr</span> <span class="o">=</span> <span class="kc">True</span>
                        <span class="n">ListView1</span><span class="o">.</span><span class="n">Items</span><span class="o">.</span><span class="n">Add</span> <span class="p">(</span><span class="n">word</span> <span class="o">&amp;</span> <span class="s2">&quot; is misspelled.&quot;</span><span class="p">)</span>
                        <span class="n">ListView1</span><span class="o">.</span><span class="n">Items</span><span class="o">.</span><span class="n">Add</span> <span class="p">(</span><span class="s2">&quot;Suggestions:&quot;</span><span class="p">)</span>
                        <span class="n">For</span> <span class="n">j</span> <span class="o">=</span> <span class="n">LBound</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="n">To</span> <span class="n">UBound</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
                            <span class="n">ListView1</span><span class="o">.</span><span class="n">Items</span><span class="o">.</span><span class="n">Add</span> <span class="p">(</span><span class="n">result</span><span class="p">(</span><span class="n">j</span><span class="p">))</span>
                        <span class="n">Next</span> <span class="n">j</span>
                        <span class="n">ListView1</span><span class="o">.</span><span class="n">Items</span><span class="o">.</span><span class="n">Add</span> <span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
                    <span class="n">End</span> <span class="n">If</span>
                <span class="n">End</span> <span class="n">If</span>
            <span class="n">Next</span> <span class="n">i</span>
            <span class="n">jso</span> <span class="o">=</span> <span class="n">Nothing</span>
            <span class="n">pdDoc</span><span class="o">.</span><span class="n">Close</span>

            <span class="n">If</span> <span class="n">Not</span> <span class="n">foundErr</span> <span class="n">Then</span>
                <span class="n">ListView1</span><span class="o">.</span><span class="n">Items</span><span class="o">.</span><span class="n">Add</span> <span class="p">(</span><span class="s2">&quot;No spelling errors found in &quot;</span> <span class="o">&amp;</span> <span class="n">path</span><span class="p">)</span>
            <span class="n">End</span> <span class="n">If</span>
        <span class="n">End</span> <span class="n">If</span>
    <span class="n">Else</span>
        <span class="n">MsgBox</span> <span class="s2">&quot;Failed to open &quot;</span> <span class="o">&amp;</span> <span class="n">path</span>
    <span class="n">End</span> <span class="n">If</span>

    <span class="n">pdDoc</span> <span class="o">=</span> <span class="n">Nothing</span>
<span class="n">End</span> <span class="n">Sub</span>
</pre></div>
</div>
<p>In this example, note the use of the Spell object’s <code class="docutils literal notranslate"><span class="pre">check</span></code> method. As described in the JavaScript for Acrobat API Reference, this method takes a word as input, and returns a null object if the word is found in the dictionary, or an array of suggested words if the word is not found.</p>
<p>The safest approach when storing the return value of a <code class="docutils literal notranslate"><span class="pre">JSObject</span></code> method call is to use a Variant. You can use the <code class="docutils literal notranslate"><span class="pre">IsArray</span></code> function to determine if the Variant is an array, and write code to handle that situation accordingly. In this simple example, if the program finds an array of suggested words, it dumps them out to the List View control.</p>
</div>
<div class="section" id="tips-for-translating-javascript-to-jsobject">
<h3>Tips for translating JavaScript to JSObject<a class="headerlink" href="#tips-for-translating-javascript-to-jsobject" title="Permalink to this headline">¶</a></h3>
<p>Covering every method available to <code class="docutils literal notranslate"><span class="pre">JSObject</span></code> is beyond the scope of this document. However, the JavaScript for Acrobat API Reference covers the subject in detail, and much can be inferred from the reference by keeping a few basic facts in mind:</p>
<ul class="simple">
<li><p>Most of the objects and methods in the reference are available in Visual Basic, but not all. In particular, any JavaScript object that requires the <code class="docutils literal notranslate"><span class="pre">new</span></code> operator for construction cannot be created in Visual Basic. This includes the <code class="docutils literal notranslate"><span class="pre">Report</span></code> object.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">Annots</span></code> object is unusual in that it requires <code class="docutils literal notranslate"><span class="pre">JSObject</span></code> to set and get its properties as a separate object using the <code class="docutils literal notranslate"><span class="pre">getProps</span></code> and <code class="docutils literal notranslate"><span class="pre">setProps</span></code> methods.</p></li>
<li><p>If you are unsure what type to use to declare a variable, declare it as a Variant. This gives Visual Basic more flexibility for type conversion, and helps prevent runtime errors.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">JSObject</span></code> cannot add new properties, methods, or objects to JavaScript. Due to this limitation, the <code class="docutils literal notranslate"><span class="pre">global.setPersistent</span></code> property is not meaningful.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">JSObject</span></code> is case-insensitive. Visual Basic often capitalizes leading characters of an identifier and prevents you from changing its case. Don’t be concerned about this, since <code class="docutils literal notranslate"><span class="pre">JSObject</span></code> ignores case when matching the identifier to its JavaScript equivalent.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">JSObject</span></code> always returns values as Variants. This includes property gets as well as return values from method calls. An empty Variant is used when a null return value is expected. When <code class="docutils literal notranslate"><span class="pre">JSObject</span></code> returns an array, each element in the array is a Variant. To determine the actual data type of a Variant, use the utility functions <code class="docutils literal notranslate"><span class="pre">IsArray</span></code>, <code class="docutils literal notranslate"><span class="pre">IsNumeric</span></code>, <code class="docutils literal notranslate"><span class="pre">IsEmpty</span></code>, <code class="docutils literal notranslate"><span class="pre">IsObject</span></code>, and <code class="docutils literal notranslate"><span class="pre">VarType</span></code> from the Information module of the Visual Basic for Applications (VBA) library.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">JSObject</span></code> can process most elemental Visual Basic types for setting properties and for and input parameters for method calls, including Variant, Array, Boolean, String, Date, Double, Long, Integer, and Byte. <code class="docutils literal notranslate"><span class="pre">JSObject</span></code> can accept Object parameters, but only when the Object is the result of a property get or method call to a <code class="docutils literal notranslate"><span class="pre">JSObject</span></code>. <code class="docutils literal notranslate"><span class="pre">JSObject</span></code> fails to accept values of type Error and Currency.</p></li>
</ul>
<a name="50532372_72744"></a></div>
</div>
<div class="section" id="other-development-topics">
<h2>Other development topics<a class="headerlink" href="#other-development-topics" title="Permalink to this headline">¶</a></h2>
<p>This section contains a variety of topics related to developing OLE applications.</p>
<div class="section" id="synchronous-messaging">
<h3>Synchronous messaging<a class="headerlink" href="#synchronous-messaging" title="Permalink to this headline">¶</a></h3>
<p>The Acrobat OLE automation implementation is based on a synchronous messaging scheme. When an application sends a request to Acrobat, the application processes that request and returns control to the application. Only then can the application send Acrobat another message. If your application sends one message followed immediately by another, the second message may not be properly received: instead of generating a server busy error, it fails with no error message.</p>
<p>For example, this can occur with the <code class="docutils literal notranslate"><span class="pre">AVDoc.OpenInWindowEx</span></code> method, where a large volume of information regarding drawing position and mouse clicks is exchanged, and with the usage of the <code class="docutils literal notranslate"><span class="pre">PDPage.DrawEx</span></code> method on especially complex pages. With the <code class="docutils literal notranslate"><span class="pre">DrawEx</span></code> method, the problem arises when a <code class="docutils literal notranslate"><span class="pre">WM_PAINT</span></code> message is generated. If the page is complex and the environment is multi-threaded, the application may not finish drawing the page before the application generates another <code class="docutils literal notranslate"><span class="pre">WM_PAINT</span></code> message. Because the application is single-threaded, multi-thread applications must handle this situation appropriately.</p>
</div>
<div class="section" id="mdi-applications">
<h3>MDI applications<a class="headerlink" href="#mdi-applications" title="Permalink to this headline">¶</a></h3>
<p>Suppose you create a multiple document interface (MDI) application that creates a static window into which Acrobat is displayed using the <code class="docutils literal notranslate"><span class="pre">OpenInWindowEx</span></code> call, and this window is based on the <code class="docutils literal notranslate"><span class="pre">CFormView</span></code> OLE class. If another window is placed on top of that window and is subsequently removed, the Acrobat window does not repaint correctly.</p>
<p>To fix this, assign the Clip Children style to the dialog box template (on which <code class="docutils literal notranslate"><span class="pre">CFormView</span></code> is based). Otherwise, the dialog box erases the background of all child windows, including the one containing the PDF file, which wipes out the previously covered part of the PDF window.</p>
</div>
<div class="section" id="event-handling-in-child-windows">
<h3>Event handling in child windows<a class="headerlink" href="#event-handling-in-child-windows" title="Permalink to this headline">¶</a></h3>
<p>When a PDF file is opened with <code class="docutils literal notranslate"><span class="pre">OpenInWindowEx</span></code>, Acrobat creates a child window on top of it. This allows the application to receive events for this window directly. However, an application must also handle the following events: <code class="docutils literal notranslate"><span class="pre">resize</span></code>, <code class="docutils literal notranslate"><span class="pre">key</span> <span class="pre">up</span></code>, and <code class="docutils literal notranslate"><span class="pre">key</span> <span class="pre">down</span></code>.</p>
<p>The following example from the ActiveView sample shows how to handle a resize event:</p>
<ol class="arabic simple">
<li><p>Handling resize events</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>void CActiveViewVw::OnSize(UINT nType, int cx, int cy)
{
    CWnd* pWndChild = GetWindow(GW_CHILD);
    if (!pWndChild)
        return;
    CRect rect;
    GetClientRect(&amp;rect);
    pWndChild-&gt;
        SetWindowPos(NULL,0,0,rect.Width,rect.Height,
                    SWP_NOZORDER  SWP_NOMOVE);
    CView::OnSize(nType, cx, cy);
}
</pre></div>
</div>
<p>After sending the message to the child window, it also does a resize. This results in both windows being resized, which is the desired effect.</p>
</div>
<div class="section" id="determining-if-an-acrobat-application-is-running">
<h3>Determining if an Acrobat application is running<a class="headerlink" href="#determining-if-an-acrobat-application-is-running" title="Permalink to this headline">¶</a></h3>
<p>Use the Windows <code class="docutils literal notranslate"><span class="pre">FindWindow</span></code> method with the Acrobat class name. You can use the Microsoft Spy++ utility to determine the class name for the version of the application.</p>
</div>
<div class="section" id="exiting-from-an-application">
<h3>Exiting from an application<a class="headerlink" href="#exiting-from-an-application" title="Permalink to this headline">¶</a></h3>
<p>When a user exits from an application using OLE automation, Acrobat itself or a web browser displaying a PDF document can be affected:</p>
<ul class="simple">
<li><p>If no PDF documents are open in Acrobat, the application quits.</p></li>
<li><p>If a web browser is displaying a PDF document, the display goes blank. The user can refresh the page to redisplay it.</p></li>
</ul>
<a name="50532372_40418"></a></div>
</div>
<div class="section" id="summary-of-ole-objects-and-methods">
<h2>Summary of OLE objects and methods<a class="headerlink" href="#summary-of-ole-objects-and-methods" title="Permalink to this headline">¶</a></h2>
<p>OLE automation support is provided by a set of classes in the Acrobat API.</p>
<p>The following diagram shows the objects and methods that are used in OLE. The arrows indicate bridge methods, which are methods that can get an object from a related object of a different layer. For example, if you want to get the <code class="docutils literal notranslate"><span class="pre">PDDoc</span></code> associated with a particular <code class="docutils literal notranslate"><span class="pre">AVDoc</span></code> object, you can use the <code class="docutils literal notranslate"><span class="pre">GetPDDoc</span></code> method in the <code class="docutils literal notranslate"><span class="pre">AcroExch.AVDoc</span></code> object.</p>
<p>OLE objects and methods</p>
<img alt="_images/oleobjects.png" src="_images/oleobjects.png" />
</div>
</div>


           </div>
           
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2022, Adobe Inc..
      <span class="lastupdated">
        Last update: Jun 30, 2022. 
        <img src="../../_static/adobelogo.png" class="logo"/> 
      </span>

    </p>
  </div> 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>