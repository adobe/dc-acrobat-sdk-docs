
<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Learn how to integrate PDF product and features in your apps with the Acrobat and PDFL APIs. Create apps that integrate with and leverage features across Adobe's enterprise-class product lineup."
  
  <!-- Ben removed the title tag -->
  

  
   <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link href="../../_static/jquery-ui.css" rel="stylesheet" />  
  <link href="../../_static/copybutton.css" rel="stylesheet" />
  <link rel="stylesheet" href="../../_static/theme_overrides.css" type="text/css" />

    
  
  
  <link rel="canonical" href="https://www.adobe.com/go/acrobatsdk_homeSandboxBrokerExt.html" />
  

  
  
  
  <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
  <script type="text/javascript" src="../../_static/jquery.js"></script>
  <script type="text/javascript" src="../../_static/underscore.js"></script>
  <script type="text/javascript" src="../../_static/doctools.js"></script>
  <script type="text/javascript" src="../../_static/language_data.js"></script>
  <script type="text/javascript" src="../../_static/searchtools.js"></script>
  <script type="text/javascript" src="../../_static/clipboard.min.js"></script>
  <script type="text/javascript" src="../../_static/copybutton.js"></script>
  <script type="text/javascript" src="../../_static/js/theme.js"></script>
   
  
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="PDF File Creation" href="Overview_PDFCreation.html" />
    <link rel="prev" title="Acrobat-PDFL SDK: Overview" href="index.html" /> 
  
<script type='text/javascript'> window.marketingtech = { adobe: { launch: { property: "global", environment: "production" } }, };</script>
<script src="https://www.adobe.com/marketingtech/main.min.js"></script>

	<script>
    $(document).ready(function () {
      $(window).scroll(function () {
        if ($(this).scrollTop() >= 50) {
          $('.fixedbar, .wy-nav-side').addClass('scroll');
          $('.wy-top-menu-wrapper').fadeOut();
        } else {
          $('.fixedbar, .wy-nav-side').removeClass('scroll');
          $('.wy-top-menu-wrapper').fadeIn();
        }
      });
      $(window).scroll(function () {
        if ($(this).scrollTop() > 100) {
          $('#scroll').fadeIn();
        } else {
          $('#scroll').fadeOut();
        }
      });
      $('#scroll').click(function () {
        $("html, body").animate({ scrollTop: 0 }, 600);
        return false;
      });
    });
  </script>

<style>
  .wy-nav-content {max-width:90%}
  </style>
</head>

<body class="wy-body-for-nav">

  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
	  
	  	  
<!-- @@@@@@@@@@@@@@@@ Custom @@@@@@@@@@@@@@@@ -->
        <div class="wy-logo-wrapper"> 
          <a href="https://www.adobe.com/go/dc_developer">
            <img src="../../_static/acrobaticon.png" class="logo"/> 
          Acrobat and PDFL Developer Guides
          </a>
        </div> 
 <!-- @@@@@@@@@@@@@@@@ Custom @@@@@@@@@@@@@@@@ -->
 
        <div class="wy-side-nav-search" >
          

          
            <a href="toc.html" class="icon icon-home"> Acrobat-PDFL SDK:  Overview
          

          
          </a>

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="index.html">Acrobat-PDFL SDK: Overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="index.html#developer-support">Developer support</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#licensing-and-distribution">Licensing and distribution</a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#acrobat-reader">Acrobat Reader</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#additional-resources">Additional resources</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#technical-and-licensing-limitations">Technical and licensing limitations</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#samples-provided-with-the-acrobat-sdk">Samples provided with the Acrobat SDK</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#developing-for-acrobat-reader">Developing for Acrobat Reader</a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#acrobat-vs-reader">Acrobat vs. Reader</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#acrobat-reader-plug-in-guidelines">Acrobat Reader plug-in guidelines</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#reader-enabled-plugins">Reader enabled plugins</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#sdk-technologies-and-options">SDK technologies and options</a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#javascript">JavaScript</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#plug-ins">Plug-ins</a><ul>
<li class="toctree-l4"><a class="reference internal" href="index.html#plug-in-development-environments">Plug-in development environments</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#acrobat-core-api">Acrobat core API</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#extended-apis-for-plug-ins">Extended APIs for plug-ins</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="index.html#javascript-vs-plugins-pros-and-cons">JavaScript vs. plugins: pros and cons</a><ul>
<li class="toctree-l4"><a class="reference internal" href="index.html#implementation-comparison">Implementation comparison</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#feature-comparison">Feature comparison</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="index.html#interapplication-communication">Interapplication communication</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#viewing-pdf-documents-from-an-external-application">Viewing PDF documents from an external application</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#controlling-acrobat-from-an-external-application">Controlling Acrobat from an external application</a><ul>
<li class="toctree-l4"><a class="reference internal" href="index.html#plug-ins-for-iac">Plug-ins for IAC</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#javascript-support">JavaScript support</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#windows-support">Windows support</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#apple-event-support">Apple event support</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="index.html#adobe-pdf-library">Adobe PDF Library</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Sandbox Broker Extensibility</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#extending-broker-apis-at-run-time">Extending broker APIs at run time</a></li>
<li class="toctree-l2"><a class="reference internal" href="#components">Components</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#plugin-pi">Plugin (PI)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#sandbox-process">Sandbox process</a></li>
<li class="toctree-l3"><a class="reference internal" href="#broker-process-the-broker-process-running-with-full-rights">Broker process (The broker process running with full rights)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#plugin-broker-the-plugin-broker-process-that-extends-the-broker-apis-at-runtime">Plugin broker (The plugin broker process that extends the broker APIs at runtime)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#sandboxhft-public-hft-provided-by-sandbox-for-broker-extensibility">SandboxHFT (Public HFT provided by sandbox for broker extensibility)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ipc-channel-between-plugin-and-plugin-broker-1-6-4">IPC channel between plugin and plugin broker, 1-&gt;6-&gt;4</a></li>
<li class="toctree-l3"><a class="reference internal" href="#simple-ipc-lib-and-sandboxpisdk">simple-ipc-lib and SandboxPISDK</a></li>
<li class="toctree-l3"><a class="reference internal" href="#building-a-plug-in">Building a plug-in</a></li>
<li class="toctree-l3"><a class="reference internal" href="#building-a-plugin-s-broker-process">Building a plugin’s broker process</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#handshake-between-plugin-and-plugin-broker">Handshake between plugin and plugin broker</a></li>
<li class="toctree-l2"><a class="reference internal" href="#implement-crosscalls-make-calls-from-plug-in-to-plug-in-s-broker-process">Implement CrossCalls (make calls from plug-in to plug-in’s broker process)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#changes-required-in-the-plugin-client">Changes required in the plugin (client)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#file-plugin-crosscalls-h">File &lt;plugin&gt;CrossCalls.h</a></li>
<li class="toctree-l4"><a class="reference internal" href="#file-plugin-ipcclient-cpp">File &lt;plugin&gt;IPCClient.cpp</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#changes-required-in-the-plugin-s-broker-server">Changes required in the plugin’s broker (server)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#file-plugin-ipcserver-cpp">File &lt;plugin&gt;IPCServer.cpp</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Overview_PDFCreation.html">PDF File Creation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Overview_PDFCreation.html#creating-pdf-files-from-an-authoring-application">Creating PDF files from an authoring application</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Overview_PDFCreation.html#acrobat-distiller">Acrobat Distiller</a></li>
<li class="toctree-l3"><a class="reference internal" href="Overview_PDFCreation.html#automated-creation-of-pdf-documents-from-windows">Automated creation of PDF documents from Windows</a></li>
<li class="toctree-l3"><a class="reference internal" href="Overview_PDFCreation.html#automatic-generation-of-advanced-acrobat-features">Automatic generation of advanced Acrobat features</a></li>
<li class="toctree-l3"><a class="reference internal" href="Overview_PDFCreation.html#attaching-a-native-document-to-a-pdf-file">Attaching a native document to a PDF file</a></li>
<li class="toctree-l3"><a class="reference internal" href="Overview_PDFCreation.html#batch-processing-with-distiller">Batch processing with Distiller</a></li>
<li class="toctree-l3"><a class="reference internal" href="Overview_PDFCreation.html#tagged-pdf-documents">Tagged PDF documents</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Overview_PDFCreation.html#creating-pdf-files-using-plug-ins-or-javascript">Creating PDF files using plug-ins or JavaScript</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Overview_PDFCreation.html#empty-pdf-files">Empty PDF files</a></li>
<li class="toctree-l3"><a class="reference internal" href="Overview_PDFCreation.html#pdf-files-from-multiple-files">PDF files from multiple files</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Overview_PDFCreation.html#creating-pdf-files-without-using-acrobat">Creating PDF files without using Acrobat</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Overview_Editing.html">Working with PDF Features</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Overview_Editing.html#navigation-in-pdf-documents">Navigation in PDF documents</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Overview_Editing.html#bookmarks">Bookmarks</a></li>
<li class="toctree-l3"><a class="reference internal" href="Overview_Editing.html#thumbnails">Thumbnails</a></li>
<li class="toctree-l3"><a class="reference internal" href="Overview_Editing.html#links">Links</a></li>
<li class="toctree-l3"><a class="reference internal" href="Overview_Editing.html#actions-for-special-effects">Actions for special effects</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Overview_Editing.html#pdf-page-manipulation">PDF page manipulation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Overview_Editing.html#page-content">Page content</a></li>
<li class="toctree-l3"><a class="reference internal" href="Overview_Editing.html#document-logical-structure">Document logical structure</a></li>
<li class="toctree-l3"><a class="reference internal" href="Overview_Editing.html#other-ways-of-modifying-pdf-documents">Other ways of modifying PDF documents</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Overview_Editing.html#watermarks">Watermarks</a></li>
<li class="toctree-l2"><a class="reference internal" href="Overview_Editing.html#spell-checking">Spell-checking</a></li>
<li class="toctree-l2"><a class="reference internal" href="Overview_Editing.html#multimedia">Multimedia</a></li>
<li class="toctree-l2"><a class="reference internal" href="Overview_Editing.html#printing-pdf-files">Printing PDF files</a></li>
<li class="toctree-l2"><a class="reference internal" href="Overview_Editing.html#embedded-fonts">Embedded fonts</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Overview_UserInterface.html">User Interface Modifications</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Overview_UserInterface.html#menu-items-and-menus">Menu items and menus</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Overview_UserInterface.html#menu-items">Menu items</a></li>
<li class="toctree-l3"><a class="reference internal" href="Overview_UserInterface.html#menus">Menus</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Overview_UserInterface.html#toolbars">Toolbars</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Overview_UserInterface.html#items-on-a-toolbar">Items on a toolbar</a></li>
<li class="toctree-l3"><a class="reference internal" href="Overview_UserInterface.html#toolbar-creation">Toolbar creation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Overview_UserInterface.html#customization-of-acrobat-help">Customization of Acrobat Help</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Overview_UserInterface.html#about-dialog-box-and-splash-screen">About dialog box and splash screen</a></li>
<li class="toctree-l3"><a class="reference internal" href="Overview_UserInterface.html#plug-in-help-files">Plug-in help files</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Overview_CustomWorkflows.html">Annotations and Online Collaboration</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Overview_CustomWorkflows.html#about-annotations">About annotations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Overview_CustomWorkflows.html#annotations-and-javascript">Annotations and JavaScript</a></li>
<li class="toctree-l3"><a class="reference internal" href="Overview_CustomWorkflows.html#annotations-with-plug-ins-or-iac">Annotations with plug-ins or IAC</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Overview_CustomWorkflows.html#new-annotation-types">New annotation types</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Overview_XML.html">XML and the Acrobat SDK</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Overview_XML.html#adobe-xml-architecture">Adobe XML architecture</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Overview_XML.html#xml-forms-model">XML forms model</a></li>
<li class="toctree-l3"><a class="reference internal" href="Overview_XML.html#xml-templates">XML templates</a></li>
<li class="toctree-l3"><a class="reference internal" href="Overview_XML.html#extensible-metadata-platform">Extensible Metadata Platform</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Overview_XML.html#soap-and-web-services">SOAP and web services</a></li>
<li class="toctree-l2"><a class="reference internal" href="Overview_XML.html#conversion-of-pdf-documents-to-xml-format">Conversion of PDF documents to XML format</a></li>
<li class="toctree-l2"><a class="reference internal" href="Overview_XML.html#xml-based-information">XML-based information</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Overview_Forms.html">Forms and the Acrobat SDK</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Overview_Forms.html#workflows-for-forms">Workflows for forms</a></li>
<li class="toctree-l2"><a class="reference internal" href="Overview_Forms.html#about-xml-forms">About XML forms</a></li>
<li class="toctree-l2"><a class="reference internal" href="Overview_Forms.html#about-acrobat-forms">About Acrobat forms</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Overview_Forms.html#forms-api">Forms API</a></li>
<li class="toctree-l3"><a class="reference internal" href="Overview_Forms.html#ole-automation">OLE automation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Overview_Metadata.html">Metadata, Accessibility, and PDF Layers</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Overview_Metadata.html#metadata">Metadata</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Overview_Metadata.html#extensible-metadata-platform-xmp">Extensible Metadata Platform (XMP)</a></li>
<li class="toctree-l3"><a class="reference internal" href="Overview_Metadata.html#adobe-xmp-toolkit">Adobe XMP Toolkit</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Overview_Metadata.html#accessibility">Accessibility</a></li>
<li class="toctree-l2"><a class="reference internal" href="Overview_Metadata.html#pdf-layers">PDF layers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Overview_Metadata.html#creation-of-layered-pdf-files">Creation of layered PDF files</a></li>
<li class="toctree-l3"><a class="reference internal" href="Overview_Metadata.html#what-you-can-do-with-layers">What you can do with layers</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Overview_Searching.html">Searching and Indexing</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Overview_Searching.html#search-plug-in">Search plug-in</a></li>
<li class="toctree-l2"><a class="reference internal" href="Overview_Searching.html#indexes-and-the-catalog-plug-in">Indexes and the Catalog plug-in</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="apxDevFAQ.html">Frequently Asked Questions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="apxDevFAQ.html#forms">Forms</a><ul>
<li class="toctree-l3"><a class="reference internal" href="apxDevFAQ.html#what-are-the-requirements-for-using-acrobat-forms">What are the requirements for using Acrobat forms?</a></li>
<li class="toctree-l3"><a class="reference internal" href="apxDevFAQ.html#what-is-the-fdf-toolkit">What is the FDF Toolkit?</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="apxDevFAQ.html#pdf-documents">PDF documents</a><ul>
<li class="toctree-l3"><a class="reference internal" href="apxDevFAQ.html#what-activex-solutions-are-available">What ActiveX solutions are available?</a></li>
<li class="toctree-l3"><a class="reference internal" href="apxDevFAQ.html#visual-basic-net-and-visual-c-net">Visual Basic .NET and Visual C# .NET</a><ul>
<li class="toctree-l4"><a class="reference internal" href="apxDevFAQ.html#how-can-i-use-visual-basic-net-or-visual-c-net">How can I use Visual Basic .NET or Visual C# .NET?</a></li>
<li class="toctree-l4"><a class="reference internal" href="apxDevFAQ.html#what-resources-are-available-for-visual-basic-net-or-visual-c-net">What resources are available for Visual Basic .NET or Visual C# .NET?</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="apxDevFAQ.html#what-api-methods-are-available-to-modify-pdf-documents">What API methods are available to modify PDF documents?</a></li>
<li class="toctree-l3"><a class="reference internal" href="apxDevFAQ.html#can-i-modify-pdfs-without-a-c-programming-background">Can I modify PDFs without a C programming background?</a></li>
<li class="toctree-l3"><a class="reference internal" href="apxDevFAQ.html#how-can-i-extract-text">How can I extract text?</a></li>
<li class="toctree-l3"><a class="reference internal" href="apxDevFAQ.html#how-can-i-display-a-pdf-in-an-external-application-window">How can I display a PDF in an external application window?</a></li>
<li class="toctree-l3"><a class="reference internal" href="apxDevFAQ.html#using-acrobat-to-view-pdfs-in-your-own-application">Using Acrobat to view PDFs in your own application</a></li>
<li class="toctree-l3"><a class="reference internal" href="apxDevFAQ.html#are-multibyte-font-pdf-documents-supported-by-the-acrobat-sdk">Are multibyte font PDF documents supported by the Acrobat SDK?</a></li>
<li class="toctree-l3"><a class="reference internal" href="apxDevFAQ.html#how-are-security-and-encryption-provided-in-pdfs">How are security and encryption provided in PDFs?</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="apxDevFAQ.html#full-text-search">Full-text search</a><ul>
<li class="toctree-l3"><a class="reference internal" href="apxDevFAQ.html#what-tools-are-available-with-acrobat-for-full-text-search">What tools are available with Acrobat for full-text search?</a></li>
<li class="toctree-l3"><a class="reference internal" href="apxDevFAQ.html#what-tools-are-available-for-extracting-and-highlighting-text">What tools are available for extracting and highlighting text?</a></li>
<li class="toctree-l3"><a class="reference internal" href="apxDevFAQ.html#how-do-i-communicate-with-the-acrobat-search-plug-in">How do I communicate with the Acrobat Search plug-in?</a></li>
<li class="toctree-l3"><a class="reference internal" href="apxDevFAQ.html#how-do-i-create-custom-docinfo-fields-for-searching">How do I create custom DocInfo fields for searching?</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="apxDevFAQ.html#how-do-i-use-the-windows-command-line">How do I use the Windows command line?</a></li>
<li class="toctree-l2"><a class="reference internal" href="apxDevFAQ.html#how-can-i-customize-the-acrobat-installer">How can I customize the Acrobat installer?</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference external" href="../index.html#://">Master Doc Search and TOC</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

        <!--- @@@@@@@@@@@@@@@@ Custom @@@@@@@@@@@@@@@@ -->
        <div class="fixedbar">  
          <div class="wy-menu-items">
            <a href="https://www.adobe.com/go/dc_developer" class="topbarlink">Acrobat Developer Home</a>
            <a href="https://www.adobe.io/apis/documentcloud/dcsdk/" class="topbarlink">Document Services SDK</a>
            <a href="https://www.adobe.com/go/acrobatsigndevguide" class="topbarlink">Acrobat Sign SDK</a>
            <a href="https://www.adobe.com/go/acrobatsdk_home" class="topbarlink">Acrobat SDK</a>
            <a href="https://www.adobe.com/go/pdflibrary" class="topbarlink">PDF Library SDK</a>
          </div>  
          <div class="sign-in">
            <a href="https://adminconsole.adobe.com//" class="btn btn-console">Console</a>
           <!-- <a href="https://auth.services.adobe.com/en_US/index.html">Sign in</a>-->
          </div>
        </div>
        <!--- @@@@@@@@@@@@@@@@ Custom @@@@@@@@@@@@@@@@ -->




   
      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="toc.html">Acrobat-PDFL SDK:  Overview</a>
        
      </nav>


      <div class="wy-nav-content">
      <a href="#" id="scroll" style="display:inline;"><span></span></a>
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="toc.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Sandbox Broker Extensibility</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
    
  </ul>

  
  <div class="rst-breadcrumbs-buttons" role="navigation" aria-label="breadcrumb navigation">
      
        <a href="Overview_PDFCreation.html" class="btn btn-neutral float-right" title="PDF File Creation" accesskey="n">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral float-left" title="Acrobat-PDFL SDK: Overview" accesskey="p"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
      
  </div>
  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="sandbox-broker-extensibility">
<h1>Sandbox Broker Extensibility<a class="headerlink" href="#sandbox-broker-extensibility" title="Permalink to this headline">¶</a></h1>
<p>A plug-in loaded in a sandboxed process executes within the restrictions of the sandbox and it may need to implement a broker to perform any privileged operations or access resources that are blocked by the sandbox. This might require adding to the existing broker APIs to get its features working in the sandbox environment.</p>
<p>Broker extensibility provides a generic plug-and-play architecture that would enable extending the existing broker functionality provided by Protected Mode in the app. This architecture allows new features to work seamlessly in the sandbox environment on demand and at run time.</p>
<div class="section" id="extending-broker-apis-at-run-time">
<h2>Extending broker APIs at run time<a class="headerlink" href="#extending-broker-apis-at-run-time" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">sandbox_pisdk_client</span></code> and <code class="docutils literal notranslate"><span class="pre">sandbox_pisdk_server</span></code> libraries have been made available for broker extensibility. Plugins need to link to this library to implement broker extensibility. Doing so allows plug-ins loaded in sandbox process to extend broker APIs at run time and make IPC calls to the broker process to access the extended functionality.</p>
<p>The following figure illustrates the sandbox plug-in architecture provided to extend the broker API functionality by individual plug-ins at run time:</p>
<img alt="_images/sandboxarch.png" src="_images/sandboxarch.png" />
</div>
<div class="section" id="components">
<h2>Components<a class="headerlink" href="#components" title="Permalink to this headline">¶</a></h2>
<div class="section" id="plugin-pi">
<h3>Plugin (PI)<a class="headerlink" href="#plugin-pi" title="Permalink to this headline">¶</a></h3>
<p>The plug-in is loaded in the sandbox process that runs under restricted rights. Every plug-in that requires some added broker functionality must implement its own plug-in broker process to implement new broker APIs. These broker APIs can be used only by that plug-in and are not visible to any other code/module loaded inside the sandbox process. Plugins can use the sandbox plugin SDK for this.</p>
</div>
<div class="section" id="sandbox-process">
<h3>Sandbox process<a class="headerlink" href="#sandbox-process" title="Permalink to this headline">¶</a></h3>
<p>This is the renderer process running in protected mode under restricted rights. All application and plug-in code runs in this process. It has restricted access to files, registry, processes, window handles etc. It communicates with the broker process over the sandbox-broker IPC channel to service actions outside the sandbox boundary.</p>
</div>
<div class="section" id="broker-process-the-broker-process-running-with-full-rights">
<h3>Broker process (The broker process running with full rights)<a class="headerlink" href="#broker-process-the-broker-process-running-with-full-rights" title="Permalink to this headline">¶</a></h3>
<p>This is the broker process which runs with full user rights and imposes policy white lists. It grants access to files, registry, and processes as per policy white list. It implements the broker APIs to service the functionality requested by the sandbox process outside the sandbox boundary. The sandbox process communicates with it over the sandbox-broker IPC channel.</p>
</div>
<div class="section" id="plugin-broker-the-plugin-broker-process-that-extends-the-broker-apis-at-runtime">
<h3>Plugin broker (The plugin broker process that extends the broker APIs at runtime)<a class="headerlink" href="#plugin-broker-the-plugin-broker-process-that-extends-the-broker-apis-at-runtime" title="Permalink to this headline">¶</a></h3>
<p>This is the plugin broker process which is private to the associated plug-in. This implements the plug-in specific broker APIs required for the full functionality of the plug-in in sandbox environment. We call them extended broker APIs, as they extend the existing broker APIs to fulfill the plug-in requirements.</p>
<p>The plug-in, which runs in Protected Mode context, communicates with this process directly over a separate IPC channel, 1 -&gt; 6 -&gt; 4, to service additional functionality outside the sandbox boundary which is not provided by broker APIs.</p>
<p>This process is launched by the broker process; it runs with full user rights and independent of the sandbox context. Also, by default it does not honor any policy restrictions or other security mechanisms. Thus it is the plug-in developer’s responsibility to design and implement it with security in focus; otherwise it can be used to escape the sandbox context.</p>
<p>Also, this binary along with the description (input and output parameters) of the APIs it exposes have to be submitted to Adobe for code signing. Please note that signature of the plug-in broker executable is verified before launch if the ‘Use only Certified plug-ins’ is checked, so it is the responsibility of the plug-in developer to ensure that this is signed otherwise this would just not work.</p>
</div>
<div class="section" id="sandboxhft-public-hft-provided-by-sandbox-for-broker-extensibility">
<h3>SandboxHFT (Public HFT provided by sandbox for broker extensibility)<a class="headerlink" href="#sandboxhft-public-hft-provided-by-sandbox-for-broker-extensibility" title="Permalink to this headline">¶</a></h3>
<p>This HFT contains two APIs which can be called by plug-ins to implement broker extensibility:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">SbxAppGetIsSandboxed</span></code> : This public API can be called from any plug-in that imports SandboxHFT to check whether the app is running with Protected Mode ON or OFF.
The prototype for this API is:
<code class="docutils literal notranslate"><span class="pre">ASBool</span> <span class="pre">SbxAppGetIsSandboxed(void);</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">SbxLaunchPIBrokerExe</span></code> : This is the public API provided by sandbox process to extend broker API at run time. The plug-in makes a request via the <code class="docutils literal notranslate"><span class="pre">SbxLaunchPIBrokerExe</span></code> API to start its plugin broker process and do some initial handshake with it.</p></li>
</ul>
<p>All the processes placed in <code class="docutils literal notranslate"><span class="pre">App</span> <span class="pre">Install</span> <span class="pre">Directory(app</span> <span class="pre">name)plug_inspi_brokers</span></code> are white listed. Third party plug-in developers must place their plugin broker processes at this location and can use this HFT. The prototype for this API is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">HANDLE</span> <span class="n">SbxLaunchPIBrokerExe</span><span class="p">(</span>
<span class="n">const</span> <span class="n">wchar_t</span> <span class="o">*</span><span class="n">piBroker</span> <span class="o">//</span> <span class="n">IN</span><span class="p">:</span><span class="n">plugin</span> <span class="n">broker</span> <span class="n">process</span> <span class="n">name</span>
<span class="p">);</span>
</pre></div>
</div>
<p>It takes the plugin broker process name in piBroker as input, looks it up in its process white list, if it succeeds then launches the piBroker process, and finally establishes IPC channel between the plug-in and piBroker. If everything succeeds, it then returns handle to the underlying IPC mechanism (in this it’s the <code class="docutils literal notranslate"><span class="pre">NamedPipe</span></code> ) otherwise INVALID_HANDLE_VALUE is returned.</p>
<p>To aid thrid-party developers in setting up the IPC between plugin and plugin broker process (1 -&gt; 6 -&gt; 4), we have provided an API SandboxPISDK::InitSandboxPIBrokerIPCChannel which launches the PI-broker (by using above HFT function SbxLaunchPIBrokerExe) and sets up the IPC. See <a class="reference external" href="SandboxBrokerExt.html#47413">Building a plug-in</a> for more details.</p>
<p>Please note that there’s one more API in this HFT - SbxLaunchPIBrokerExtn which has been deprecated from A11</p>
</div>
<div class="section" id="ipc-channel-between-plugin-and-plugin-broker-1-6-4">
<h3>IPC channel between plugin and plugin broker, 1-&gt;6-&gt;4<a class="headerlink" href="#ipc-channel-between-plugin-and-plugin-broker-1-6-4" title="Permalink to this headline">¶</a></h3>
<p>This is the dedicated IPC channel across which the plug-in and its plug-in broker process communicate. The IPC channel is established at run time, when the plugin makes a request via the InitSandboxPIBrokerIPCChannel API, to start its plugin broker process. The broker process looks up in its process white list and launches the requested plugin broker process and establishes the IPC channel. This communication channel bypasses the usual 1 -&gt; 2 -&gt; 3 trusted IPC channel between the plugin (in Protected Mode process) and broker process and talks directly to the PI broker process via 1-&gt;6-&gt;4.</p>
</div>
<div class="section" id="simple-ipc-lib-and-sandboxpisdk">
<h3>simple-ipc-lib and SandboxPISDK<a class="headerlink" href="#simple-ipc-lib-and-sandboxpisdk" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">simple-ipc-lib</span></code> : This is a very light weight C++ inter-process communication library. It is used to communicate over the <code class="docutils literal notranslate"><span class="pre">NamedPipe</span></code> . This library needs to be built and linked into both the plugin and the plugin broker.</p>
<p><code class="docutils literal notranslate"><span class="pre">SandboxPISDK</span></code> : plugin developers must use this SDK to implement broker Extensibility for their Plugin. This SDK abstracts out a lot of internal details and has wrappers and macros to aid developers.</p>
<a name="47413"></a></div>
<div class="section" id="building-a-plug-in">
<h3>Building a plug-in<a class="headerlink" href="#building-a-plug-in" title="Permalink to this headline">¶</a></h3>
<ol class="arabic simple">
<li><p>Add ipc_lib project to the plug-in’s project dependency list and also link to it.</p></li>
<li><p>Add the following headers from the SandboxPISDK into your project:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">SandboxPIIPCDefs.h</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">SandboxPIClientDefs.h</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">SandboxPISDKClientMacros.h</span></code></p></li>
</ul>
</li>
<li><p>Implement <code class="docutils literal notranslate"><span class="pre">&lt;plugin&gt;CrossCalls.h</span></code> and <code class="docutils literal notranslate"><span class="pre">&lt;plugin&gt;IPCClient.cpp</span></code> to add the client side of the Plugin specific broker Extensibility functionality. See <a class="reference external" href="SandboxBrokerExt.html#26339">Implement CrossCalls (make calls from plug-in to plug-in’s broker process)</a>.</p></li>
<li><p>Link to the <code class="docutils literal notranslate"><span class="pre">sandbox_pisdk_client.lib</span></code> provided along with SandboxPISDK</p></li>
<li><p>Call the API, <code class="docutils literal notranslate"><span class="pre">InitSandboxPIBrokerIPCChannel</span></code> provided with SandboxPISDK to setup the IPC channel with your Plugin’s broker process.</p></li>
</ol>
</div>
<div class="section" id="building-a-plugin-s-broker-process">
<h3>Building a plugin’s broker process<a class="headerlink" href="#building-a-plugin-s-broker-process" title="Permalink to this headline">¶</a></h3>
<ol class="arabic simple">
<li><p>Add <code class="docutils literal notranslate"><span class="pre">ipc_lib</span></code> project to the plug-in’s project dependency list and also link to it.</p></li>
<li><p>Add the following headers from the SandboxPISDK into your project:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">SandboxPIIPCDefs.h</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">SandboxPIServerDefs.h</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">SandboxPISDKServerMacros.h</span></code></p></li>
</ul>
</li>
<li><p>Add the <code class="docutils literal notranslate"><span class="pre">SandboxPIServerMain.cpp</span></code> to the project</p></li>
<li><p>Implement <code class="docutils literal notranslate"><span class="pre">&lt;plugin&gt;IPCServer.cpp</span></code> to add the server/broker side of the Plugin broker Extensibility functionality. See <a class="reference external" href="SandboxBrokerExt.html#26339">Implement CrossCalls (make calls from plug-in to plug-in’s broker process)</a>.</p></li>
<li><p>Add <code class="docutils literal notranslate"><span class="pre">ipc_lib</span></code> project to your &lt;Plugin&gt;broker project’s dependency list and also link to it.</p></li>
<li><p>Link to the <code class="docutils literal notranslate"><span class="pre">sandbox_pisdk_server.lib</span></code> provided along with SandboxPISDK</p></li>
</ol>
<p>Refer the sample plugin/pluginbroker source code for more details.</p>
</div>
</div>
<div class="section" id="handshake-between-plugin-and-plugin-broker">
<h2>Handshake between plugin and plugin broker<a class="headerlink" href="#handshake-between-plugin-and-plugin-broker" title="Permalink to this headline">¶</a></h2>
<p>These steps create the initial setup for the IPC channel between the Plugin and its broker required to make the cross calls. The following sequence of steps takes place during the initial setup:</p>
<ol class="arabic simple">
<li><p>The plug-in provides a plug-in broker process placed at <code class="docutils literal notranslate"><span class="pre">(app</span> <span class="pre">name)plug_inspi_brokers</span></code> .</p></li>
<li><p>The plug-in sends a request via the <code class="docutils literal notranslate"><span class="pre">InitSandboxPIBrokerIPCChannel</span></code> call which in turn uses SandboxHFT call <code class="docutils literal notranslate"><span class="pre">SbxLaunchPIBrokerExe</span></code> to launch its piBroker process.</p></li>
<li><p>The broker process then validates the <code class="docutils literal notranslate"><span class="pre">piBroker</span></code> process name against a white list.</p></li>
<li><p>If the above validation succeeds, then the broker process launches the <code class="docutils literal notranslate"><span class="pre">piBroker</span></code> process. It then establishes the IPC channel using the <code class="docutils literal notranslate"><span class="pre">simple-ipc-lib</span></code> between <code class="docutils literal notranslate"><span class="pre">piBroker</span></code> process and plug-in.</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">InitSandboxPIBrokerIPCChannel</span></code> returns true then plug-in is now ready to make cross calls to the <code class="docutils literal notranslate"><span class="pre">piBroker</span></code> directly over the IPC channel to execute extended broker functionality.</p></li>
</ol>
<p>Refer to the sample project to get started and for example code.</p>
<a name="26339"></a></div>
<div class="section" id="implement-crosscalls-make-calls-from-plug-in-to-plug-in-s-broker-process">
<h2>Implement CrossCalls (make calls from plug-in to plug-in’s broker process)<a class="headerlink" href="#implement-crosscalls-make-calls-from-plug-in-to-plug-in-s-broker-process" title="Permalink to this headline">¶</a></h2>
<p>The entire purpose of providing broker Extensibility to plugins is to offer plug-ins a mechanism to make CrossCalls i.e. perform privileged operations that don’t work when called directly from the plug-in, for example, sending messages to HWND, read/write to files/registries, launch any application etc. The plug-in’s broker run under the user rights and doesn’t have any sandbox restrictions as a plugin running inside the app process has. So when a CrossCall is made, the plugin’s broker performs the same operation on the plugin’s behalf and returns the result to plugin. We are using chrome’s <code class="docutils literal notranslate"><span class="pre">simple-ipc-lib</span></code> to perform Inter-process Communication and have written macros to define and make CrossCalls relatively easier.</p>
<p>Let’s take an example where plugin needs to send <code class="docutils literal notranslate"><span class="pre">WM_COPYDATA</span></code> message to a window.</p>
<div class="section" id="changes-required-in-the-plugin-client">
<h3>Changes required in the plugin (client)<a class="headerlink" href="#changes-required-in-the-plugin-client" title="Permalink to this headline">¶</a></h3>
<div class="section" id="file-plugin-crosscalls-h">
<h4>File &lt;plugin&gt;CrossCalls.h<a class="headerlink" href="#file-plugin-crosscalls-h" title="Permalink to this headline">¶</a></h4>
<p>Create a unique id for new call and add it in between <code class="docutils literal notranslate"><span class="pre">DECLARE_CROSS_CALL_START</span></code> and <code class="docutils literal notranslate"><span class="pre">DECLARE_CROSS_CALL_END:</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">DECLARE_CROSS_CALL_START</span>

            <span class="n">CROSS_CALL_ID</span><span class="p">(</span><span class="o">&lt;</span><span class="n">UniqueId1</span><span class="o">&gt;</span><span class="p">)</span>

            <span class="n">CROSS_CALL_ID</span><span class="p">(</span><span class="o">&lt;</span><span class="n">UniqueId2</span><span class="o">&gt;</span><span class="p">)</span>

            <span class="n">CROSS_CALL_ID</span><span class="p">(</span><span class="o">&lt;</span><span class="n">UniqueIdN</span><span class="o">&gt;</span><span class="p">)</span>

            <span class="n">CROSS_CALL_ID</span><span class="p">(</span><span class="n">SbxPISendMessage</span><span class="p">)</span>

<span class="n">DECLARE_CROSS_CALL_END</span>
</pre></div>
</div>
<p>Now the <code class="docutils literal notranslate"><span class="pre">INPUT</span> <span class="pre">PARAMETERS</span></code> (params that are passed from plugin to broker) and <code class="docutils literal notranslate"><span class="pre">OUTPUT</span> <span class="pre">PARAMERERS</span></code> (params that are returned from broker to plugin) and their order need to be defined.</p>
<p>Macros <code class="docutils literal notranslate"><span class="pre">DEFINE_IPC_MSG_CLIENT(&lt;UniqueId&gt;,</span> <span class="pre">&lt;numOfInputParams&gt;)</span></code> and <code class="docutils literal notranslate"><span class="pre">DEFINE_IPC_MSG_SERVER(&lt;UniqueId&gt;,</span> <span class="pre">&lt;numOfOutputParams&gt;)</span></code> have been designed exactly for this purpose. For <code class="docutils literal notranslate"><span class="pre">SbxPISendMessage</span></code> CrossCall, the 4 input parameters are <code class="docutils literal notranslate"><span class="pre">HWND</span></code> (passed as <code class="docutils literal notranslate"><span class="pre">VoidPtr</span></code> ), <code class="docutils literal notranslate"><span class="pre">MsgType</span></code> (passed as <code class="docutils literal notranslate"><span class="pre">UINT</span></code> ), <code class="docutils literal notranslate"><span class="pre">WPARAM</span></code> (passed as <code class="docutils literal notranslate"><span class="pre">UINT</span></code> ), and <code class="docutils literal notranslate"><span class="pre">buffer</span></code> (passed as <code class="docutils literal notranslate"><span class="pre">ByteArray</span></code> ), and 2 output parameters are result – retrun value of <code class="docutils literal notranslate"><span class="pre">SendMessage</span></code> call (passed as <code class="docutils literal notranslate"><span class="pre">UINT</span></code> ) and <code class="docutils literal notranslate"><span class="pre">LastError</span></code> – <code class="docutils literal notranslate"><span class="pre">GetLastError</span></code> result after <code class="docutils literal notranslate"><span class="pre">SendMessage</span></code> (passed as <code class="docutils literal notranslate"><span class="pre">UINT</span></code> ).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>            <span class="n">DEFINE_IPC_MSG_CLIENT</span><span class="p">(</span><span class="n">SbxPISendMessage</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="p">{</span>

                        <span class="n">INPUT_PARAM_VOID_PTR</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

                        <span class="n">INPUT_PARAM_UINT</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

                        <span class="n">INPUT_PARAM_UINT</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>

                        <span class="n">INPUT_PARAM_BUFFER</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>

            <span class="p">};</span>

            <span class="n">DEFINE_IPC_MSG_SERVER</span><span class="p">(</span><span class="n">SbxPISendMessage</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>

                        <span class="n">OUTPUT_PARAM_UINT</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

                        <span class="n">OUTPUT_PARAM_UINT</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

<span class="p">};</span>
</pre></div>
</div>
<p>The following IPC data types are supported (as defined in files <code class="docutils literal notranslate"><span class="pre">SandboxPISDKClientMacros.h</span></code> and <code class="docutils literal notranslate"><span class="pre">SandboxPISDKServerMacros.h</span></code> ) :-</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">INPUT_PARAM_VOID_PTR</span> <span class="o">-</span> <span class="k">for</span> <span class="n">void</span><span class="o">*</span>
<span class="n">INPUT_PARAM_INT</span> <span class="o">-</span> <span class="nb">int</span>
<span class="n">INPUT_PARAM_UINT</span> <span class="o">-</span> <span class="n">unsigned</span> <span class="nb">int</span>
<span class="n">INPUT_PARAM_LONG</span> <span class="o">-</span> <span class="n">long</span>
<span class="n">INPUT_PARAM_ULONG</span> <span class="o">-</span> <span class="n">unsigned</span> <span class="n">long</span>
<span class="n">INPUT_PARAM_STRING</span> <span class="o">-</span> <span class="n">std</span><span class="p">::</span><span class="n">string</span>
<span class="n">INPUT_PARAM_WSTRING</span> <span class="o">-</span> <span class="n">std</span><span class="p">::</span><span class="n">wstring</span>
<span class="n">INPUT_PARAM_BUFFER</span> <span class="o">-</span> <span class="n">ipc</span><span class="p">::</span><span class="n">ByteArray</span>
<span class="n">OUTPUT_PARAM_VOID_PTR</span> <span class="o">-</span> <span class="k">for</span> <span class="n">void</span><span class="o">*</span>
<span class="n">OUTPUT_PARAM_INT</span> <span class="o">-</span> <span class="nb">int</span>
<span class="n">OUTPUT_PARAM_UINT</span> <span class="o">-</span> <span class="n">unsigned</span> <span class="nb">int</span>
<span class="n">OUTPUT_PARAM_LONG</span> <span class="o">-</span> <span class="n">long</span>
<span class="n">OUTPUT_PARAM_ULONG</span> <span class="o">-</span> <span class="n">unsigned</span> <span class="n">long</span>
<span class="n">OUTPUT_PARAM_STRING</span> <span class="o">-</span> <span class="n">std</span><span class="p">::</span><span class="n">string</span>
<span class="n">OUTPUT_PARAM_WSTRING</span> <span class="o">-</span> <span class="n">std</span><span class="p">::</span><span class="n">wstring</span>
<span class="n">OUTPUT_PARAM_BUFFER</span> <span class="o">-</span> <span class="n">ipc</span><span class="p">::</span><span class="n">ByteArray</span>
</pre></div>
</div>
</div>
<div class="section" id="file-plugin-ipcclient-cpp">
<h4>File &lt;plugin&gt;IPCClient.cpp<a class="headerlink" href="#file-plugin-ipcclient-cpp" title="Permalink to this headline">¶</a></h4>
<p>In this file, the entire client side of the CrossCall needs to be defined. Macro <code class="docutils literal notranslate"><span class="pre">DEFINE_CLIENT_CROSS_CALL(&lt;UniqueId&gt;,</span> <span class="pre">&lt;numOfInputParams&gt;,</span> <span class="pre">&lt;numOfOutputParams&gt;)</span></code> does all the work of generating the requisite class (client side).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">DEFINE_CROSS_CALL_CLIENT</span><span class="p">(</span><span class="n">SbxPISendMessage</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>So once you have defined the cross call by using above macro, you have to use macro <code class="docutils literal notranslate"><span class="pre">MAKE_CROSS_CALL()</span> <span class="pre">and</span> <span class="pre">MAKE_CROSS_CALL_WITH_RETURN_VAL()</span></code> to call the function at the broker end. Whenever any UI is involved at the broker end and window handle from plugin is passed to the <code class="docutils literal notranslate"><span class="pre">PIBroker</span></code> , the macro <code class="docutils literal notranslate"><span class="pre">MAKE_CROSS_CALL_WITH_MSG_PUMP()</span></code> or <code class="docutils literal notranslate"><span class="pre">MAKE_CROSS_CALL_WITH_MSG_PUMP_AND_RETURN_VAL()</span></code> can be used which ensures that all UI messages from <code class="docutils literal notranslate"><span class="pre">PIBroker</span></code> to the plugin. Remember, the order of input and output parameters have to be exactly same as defined in <code class="docutils literal notranslate"><span class="pre">&lt;plugin&gt;CrossCalls.h</span></code> header file. Also, note that the input parameters are passed as const reference and output parameters are passed as reference.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">bool</span> <span class="n">return_value</span> <span class="o">=</span> <span class="n">false</span><span class="p">;</span>

<span class="n">MAKE_CROSS_CALL_WITH_RETURN_VAL</span><span class="p">(</span><span class="n">SbxPISendMessage</span><span class="p">,</span> <span class="n">return_value</span><span class="p">)(</span><span class="n">static_cast</span><span class="o">&lt;</span><span class="n">LPVOID</span><span class="o">&gt;</span><span class="p">(</span><span class="n">hWnd</span><span class="p">),</span> <span class="n">msgType</span><span class="p">,</span> <span class="n">wParam</span><span class="p">,</span> <span class="n">ByteArrayBuffer</span><span class="p">,</span> <span class="n">outRetVal</span><span class="p">,</span> <span class="n">outLastErr</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="changes-required-in-the-plugin-s-broker-server">
<h3>Changes required in the plugin’s broker (server)<a class="headerlink" href="#changes-required-in-the-plugin-s-broker-server" title="Permalink to this headline">¶</a></h3>
<div class="section" id="file-plugin-ipcserver-cpp">
<h4>File &lt;plugin&gt;IPCServer.cpp<a class="headerlink" href="#file-plugin-ipcserver-cpp" title="Permalink to this headline">¶</a></h4>
<p>In this file, the entire server side of the CrossCall needs to be defined. Macro <code class="docutils literal notranslate"><span class="pre">DEFINE_SERVER_CROSS_CALL_START(&lt;UniqueId&gt;,</span> <span class="pre">&lt;numOfInputParams&gt;,</span> <span class="pre">&lt;numOfOutputParams&gt;)</span></code> does all the work of generating the requisite server side class:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> DEFINE_SERVER_CROSS_CALL_START(SbxPISendMessage, 4, 2)

      virtual void Proc(const LVOID&amp; input1, const UINT&amp; input2, const UINT&amp; input3, ipc::ByteArray &amp;input4, UINT&amp; out1, UINT&amp; out2)

     {

        LRESULT result = 0;

        HWND hWnd = static_cast&lt;HWND&gt;(input1);

        //  likewise take other parameters and make them ready to be passed to

        // SendMessage

        result = SendMessage(hWnd, WM_CPYDATA, &lt;other parameters&gt;);

        out1 = (result == FALSE) ? 0 : 1;

        out2 = GetLastError();

      }

DEFINE_CROSS_CALL_SERVER_END
</pre></div>
</div>
<p>Please note that if Proc above raises any exception then it will be eaten away by the internal implementation, so you need to use your own try catch block if you want to pass on any exception raised here to the plug-in.</p>
<p>And finally use the <code class="docutils literal notranslate"><span class="pre">MACRO</span> <span class="pre">-</span> <span class="pre">ADD_MSG_HANDLER</span></code> to add above Cross all Proc to list of message handlers so that whenever <code class="docutils literal notranslate"><span class="pre">SbxPISendMessage</span></code> message arrives at the <code class="docutils literal notranslate"><span class="pre">PIBroker</span></code> end, it can be appropriately routed to its Proc.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">DEFINE_CROSS_CALL_HANDLER_START</span><span class="p">(</span><span class="o">&lt;</span><span class="n">Plugin</span><span class="o">-</span><span class="n">Name</span><span class="o">&gt;</span><span class="p">)</span>
      <span class="n">ADD_MSG_HANDLER</span><span class="p">(</span><span class="o">&lt;</span><span class="n">Cross</span><span class="o">-</span><span class="n">Call</span> <span class="n">UniqueId1</span><span class="o">&gt;</span><span class="p">)</span>
      <span class="n">ADD_MSG_HANDLER</span><span class="p">(</span><span class="o">&lt;</span><span class="n">Cross</span><span class="o">-</span><span class="n">Call</span> <span class="n">UniqueId2</span><span class="o">&gt;</span><span class="p">)</span>
      <span class="n">ADD_MSG_HANDLER</span><span class="p">(</span><span class="n">SbxPISendMessage</span><span class="p">)</span>
 <span class="n">DEFINE_CROSS_CALL_HANDLER_END</span>
</pre></div>
</div>
<div class="section" id="individual-policy-configuration-for-3rd-parties">
<h5>Individual policy configuration for 3rd parties<a class="headerlink" href="#individual-policy-configuration-for-3rd-parties" title="Permalink to this headline">¶</a></h5>
<p>The 2020 release introduces a new mechanism which allows plugins to use individual custom policy config files. The new config files adhere to same format and syntax as the original config file. To create one:</p>
<ol class="arabic simple">
<li><p>Create a custom policy config file parallel to Acrobat.exe in Acrobat’s installation folder.</p></li>
<li><p>Open the registry to <code class="docutils literal notranslate"><span class="pre">HKEY_LOCAL_MACHINESOFTWAREPoliciesAdobeAcrobat</span> <span class="pre">Acrobat&lt;Track&gt;FeatureLockDown</span></code></p></li>
<li><p>Create a key: <code class="docutils literal notranslate"><span class="pre">cProtectedModeConfigFiles</span></code></p></li>
<li><p>Add new preferences with a string with the name as your plugin’s name and data as your config file name under:</p></li>
</ol>
</div>
<div class="section" id="getting-started-with-sampleextn">
<h5>Getting started with SampleExtn<a class="headerlink" href="#getting-started-with-sampleextn" title="Permalink to this headline">¶</a></h5>
<p>To use the example, do the following:</p>
<ol class="arabic simple">
<li><p>Copy the <code class="docutils literal notranslate"><span class="pre">SampleExtn</span></code> folder to the <code class="docutils literal notranslate"><span class="pre">…[PluginSupport]Sample</span></code> folder of your <code class="docutils literal notranslate"><span class="pre">SDK</span></code> folder as: <code class="docutils literal notranslate"><span class="pre">&lt;Acrobat_SDK_Root&gt;AdobeAcrobatSDKVersion1[PluginSupport]Samples[SampleExtn]</span></code> . This folder contains the source code for SamplePI(Reader Plugin) and SamplePIBroker(PIBroker).</p></li>
<li><p>Open the Solution File: <code class="docutils literal notranslate"><span class="pre">SampleExtnwin32[SampleExtn].sln</span></code> and build it with VisualStudio 2019 SP1. Note: You will have to Reader Enable the <code class="docutils literal notranslate"><span class="pre">SamplePI.api</span></code> as described in Developing and enabling an Adobe Reader plug-in–Reader plugins must be signed; Acrobat-only plugins do not need signing.</p></li>
<li><p>Copy the Reader Enabled <code class="docutils literal notranslate"><span class="pre">SamplePI.api</span></code> to <code class="docutils literal notranslate"><span class="pre">&lt;Reader_Installed_Path&gt;plug_ins[SamplePI].api</span></code></p></li>
<li><p>Copy the SamplePIBroker.exe process to <code class="docutils literal notranslate"><span class="pre">&lt;Reader_Installed_Path&gt;plug_inspi_brokers[SamplePIBroker].exe</span></code></p></li>
<li><p>Start in Protected Mode and play with <code class="docutils literal notranslate"><span class="pre">SamplePI.api</span></code> from Acrobat SDK/SamplePI Menu.</p></li>
</ol>
</div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2022, Adobe Inc..
      <span class="lastupdated">
        Last update: Jun 24, 2022. 
        <img src="../../_static/adobelogo.png" class="logo"/> 
      </span>

    </p>
  </div> 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>