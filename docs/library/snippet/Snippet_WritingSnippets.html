
<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Learn how to integrate PDF product and features in your apps with the Acrobat and PDFL APIs. Create apps that integrate with and leverage features across Adobe's enterprise-class product lineup."
  
  <!-- Ben removed the title tag -->
  

  
   <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link href="../../_static/jquery-ui.css" rel="stylesheet" />  
  <link href="../../_static/copybutton.css" rel="stylesheet" />
  <link rel="stylesheet" href="../../_static/theme_overrides.css" type="text/css" />

    
  
  
  <link rel="canonical" href="https://www.adobe.com/go/acrobatsdk_homeSnippet_WritingSnippets.html" />
  

  
  
  
  <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
  <script type="text/javascript" src="../../_static/jquery.js"></script>
  <script type="text/javascript" src="../../_static/underscore.js"></script>
  <script type="text/javascript" src="../../_static/doctools.js"></script>
  <script type="text/javascript" src="../../_static/language_data.js"></script>
  <script type="text/javascript" src="../../_static/searchtools.js"></script>
  <script type="text/javascript" src="../../_static/clipboard.min.js"></script>
  <script type="text/javascript" src="../../_static/copybutton.js"></script>
  <script type="text/javascript" src="../../_static/js/theme.js"></script>
   
  
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Installing and Running SnippetRunner" href="Snippet_SnippetRunnerCookbook.html" /> 
  
<script type='text/javascript'> window.marketingtech = { adobe: { launch: { property: "global", environment: "production" } }, };</script>
<script src="https://www.adobe.com/marketingtech/main.min.js"></script>

	<script>
    $(document).ready(function () {
      $(window).scroll(function () {
        if ($(this).scrollTop() >= 50) {
          $('.fixedbar, .wy-nav-side').addClass('scroll');
          $('.wy-top-menu-wrapper').fadeOut();
        } else {
          $('.fixedbar, .wy-nav-side').removeClass('scroll');
          $('.wy-top-menu-wrapper').fadeIn();
        }
      });
      $(window).scroll(function () {
        if ($(this).scrollTop() > 100) {
          $('#scroll').fadeIn();
        } else {
          $('#scroll').fadeOut();
        }
      });
      $('#scroll').click(function () {
        $("html, body").animate({ scrollTop: 0 }, 600);
        return false;
      });
    });
  </script>

<style>
  .wy-nav-content {max-width:90%}
  </style>
</head>

<body class="wy-body-for-nav">

  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
	  
	  	  
<!-- @@@@@@@@@@@@@@@@ Custom @@@@@@@@@@@@@@@@ -->
        <div class="wy-logo-wrapper"> 
          <a href="https://www.adobe.com/go/dc_developer">
            <img src="../../_static/acrobaticon.png" class="logo"/> 
          Acrobat and PDFL Developer Guides
          </a>
        </div> 
 <!-- @@@@@@@@@@@@@@@@ Custom @@@@@@@@@@@@@@@@ -->
 
        <div class="wy-side-nav-search" >
          

          
            <a href="toc.html" class="icon icon-home"> Acrobat-PDFL SDK:  Snippet Runner Cookbook
          

          
          </a>

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="index.html">Acrobat-PDFL SDK:  Snippet Runner Cookbook</a></li>
<li class="toctree-l1"><a class="reference internal" href="Snippet_SnippetRunnerCookbook.html">Installing and Running SnippetRunner</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Snippet_SnippetRunnerCookbook.html#snippetrunner-common-interface">SnippetRunner Common Interface</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Snippet_SnippetRunnerCookbook.html#installing-the-common-interface">Installing the Common Interface</a></li>
<li class="toctree-l3"><a class="reference internal" href="Snippet_SnippetRunnerCookbook.html#starting-the-snippetrunner">Starting the SnippetRunner</a></li>
<li class="toctree-l3"><a class="reference internal" href="Snippet_SnippetRunnerCookbook.html#starting-the-common-interface-for-pdfl">Starting the Common Interface for PDFL</a></li>
<li class="toctree-l3"><a class="reference internal" href="Snippet_SnippetRunnerCookbook.html#creating-the-configuration-file">Creating the configuration file</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Snippet_SnippetRunnerCookbook.html#running-as-a-standalone-java-application">Running as a standalone Java application</a></li>
<li class="toctree-l2"><a class="reference internal" href="Snippet_SnippetRunnerCookbook.html#running-as-a-java-applet">Running as a Java applet</a></li>
<li class="toctree-l2"><a class="reference internal" href="Snippet_SnippetRunnerCookbook.html#known-issues">Known issues</a></li>
<li class="toctree-l2"><a class="reference internal" href="Snippet_SnippetRunnerCookbook.html#using-the-common-interface">Using the Common Interface</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Writing Snippets</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#passing-parameters-to-snippets">Passing parameters to snippets</a></li>
<li class="toctree-l2"><a class="reference internal" href="#toggling-behavior-and-asynchronous-snippets">Toggling behavior and asynchronous snippets</a></li>
<li class="toctree-l2"><a class="reference internal" href="#handling-exceptions">Handling exceptions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#handling-documents">Handling documents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference external" href="../index.html#://">Master Doc Search and TOC</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

        <!--- @@@@@@@@@@@@@@@@ Custom @@@@@@@@@@@@@@@@ -->
        <div class="fixedbar">  
          <div class="wy-menu-items">
            <a href="https://www.adobe.com/go/dc_developer" class="topbarlink">Acrobat Developer Home</a>
            <a href="https://www.adobe.io/apis/documentcloud/dcsdk/" class="topbarlink">Document Services SDK</a>
            <a href="https://www.adobe.com/go/acrobatsigndevguide" class="topbarlink">Acrobat Sign SDK</a>
            <a href="https://www.adobe.com/go/acrobatsdk_home" class="topbarlink">Acrobat SDK</a>
            <a href="https://www.adobe.com/go/pdflibrary" class="topbarlink">PDF Library SDK</a>
          </div>  
          <div class="sign-in">
            <a href="https://adminconsole.adobe.com//" class="btn btn-console">Console</a>
           <!-- <a href="https://auth.services.adobe.com/en_US/index.html">Sign in</a>-->
          </div>
        </div>
        <!--- @@@@@@@@@@@@@@@@ Custom @@@@@@@@@@@@@@@@ -->




   
      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="toc.html">Acrobat-PDFL SDK:  Snippet Runner Cookbook</a>
        
      </nav>


      <div class="wy-nav-content">
      <a href="#" id="scroll" style="display:inline;"><span></span></a>
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="toc.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Writing Snippets</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
    
  </ul>

  
  <div class="rst-breadcrumbs-buttons" role="navigation" aria-label="breadcrumb navigation">
      
      
        <a href="Snippet_SnippetRunnerCookbook.html" class="btn btn-neutral float-left" title="Installing and Running SnippetRunner" accesskey="p"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
      
  </div>
  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <a name="57730"></a><div class="section" id="writing-snippets">
<h1>Writing Snippets<a class="headerlink" href="#writing-snippets" title="Permalink to this headline">Â¶</a></h1>
<p>A code snippet must contain at least the following:</p>
<ul class="simple">
<li><p>A single main function that acts as its entry point. Snippets may contain additional functions as needed.</p></li>
<li><p>A macro call that binds the snippet to the SnippetRunner environment.</p></li>
</ul>
<p>An example of a single-function snippet that is included with the SnippetRunner project, SimpleSnip.cpp, is shown below. The code for this snippet also includes comments (not shown here) that provide useful development hints.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#include &quot;SnippetRunner.h&quot;</span>
 <span class="c1">#include &quot;SnippetRunnerUtils.h&quot;</span>

 <span class="n">void</span> <span class="n">SimpleSnip</span><span class="p">()</span>
 <span class="p">{</span>
     <span class="n">Console</span><span class="p">::</span><span class="n">displayString</span><span class="p">(</span><span class="s2">&quot;This is a simple snippet.&quot;</span><span class="p">);</span>
     <span class="n">Console</span><span class="p">::</span><span class="n">displayString</span><span class="p">(</span><span class="s2">&quot;Simple snippet executed&quot;</span><span class="p">);</span>
 <span class="p">}</span>

 <span class="n">SNIPRUN_REGISTER</span><span class="p">(</span><span class="n">SimpleSnip</span><span class="p">,</span> <span class="s2">&quot;Simple Framework&quot;</span><span class="p">,</span> <span class="s2">&quot;SimpleSnip creates a framework for a snippet.&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>This snippet has a single function, SimpleSnip, which writes two messages to the output pane of the Common Interface (see <a class="reference external" href="Snippet_SnippetRunnerCookbook.html#24853">Using the Common Interface</a>) using the utility function <code class="docutils literal notranslate"><span class="pre">Console::displayString</span></code>.  This function enables you to perform memory dumps and view strings (<code class="docutils literal notranslate"><span class="pre">char</span> <span class="pre">*</span></code> ), <code class="docutils literal notranslate"><span class="pre">ASText</span></code> objects, and Cos objects. (See the source files SnippetRunnerUtils.cpp and Console.cpp for details.)</p>
<p>Because the <code class="docutils literal notranslate"><span class="pre">SimpleSnip</span></code> function requires no parameters, it uses the macro call <code class="docutils literal notranslate"><span class="pre">SNIPRUN_REGISTER</span></code> to bind to the SnippetRunner environment. (See <a class="reference external" href="Snippet_WritingSnippets.html#93537">Passing parameters to snippets</a> for other possibilities.) This macro requires three parameters:</p>
<ul class="simple">
<li><p>The name of the function that is the entry point for the snippet (the same as the snippetâs file name).</p></li>
<li><p>A string indicating where the snippetâs node is to appear in the Snippet Collection pane of the Common Interface user interface. If the snippet location is not at the root level of the hierarchy, the string specifies the path to the snippet, with folder names separated by colons. For example, the GetFontInfoSnip snippet would specify: âPD Layer:Fonts:Get Font Infoâ.</p></li>
<li><p>A string of descriptive text to be presented in the Snippet Description pane.</p></li>
</ul>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>A snippetâs node name is limited to 49 characters.</p>
</div>
<p>SimpleSnip is a synchronous or âone-shotâ snippet, meaning that it executes and then terminates. See <a class="reference external" href="Snippet_WritingSnippets.html#52396">Toggling behavior and asynchronous snippets</a> for other possibilities.</p>
<a name="93537"></a><div class="section" id="passing-parameters-to-snippets">
<h2>Passing parameters to snippets<a class="headerlink" href="#passing-parameters-to-snippets" title="Permalink to this headline">Â¶</a></h2>
<p>You can pass parameters to a snippetâs main function. To enable this mechanism, use the <code class="docutils literal notranslate"><span class="pre">SNIPRUN_REGISTER_WITH_DIALOG</span></code> macro in your snippet to bind the snippet to SnippetRunner. This call takes an extra parameter (beyond the three required by <code class="docutils literal notranslate"><span class="pre">SNIPRUN_REGISTER</span></code> ), which is a single string representing default parameter(s) separated by spaces.</p>
<p>When a snippet implemented with <code class="docutils literal notranslate"><span class="pre">SNIPRUN_REGISTER_WITH_DIALOG</span></code> is invoked, a dialog box with the snippetâs descriptive text appears that includes a text edit box pre-populated with the default values set by the fourth parameter.</p>
<p>If necessary, this dialog box can be suppressed using the utility calls <code class="docutils literal notranslate"><span class="pre">turnParamDialogOff</span></code> (<code class="docutils literal notranslate"><span class="pre">/On</span></code> ) and <code class="docutils literal notranslate"><span class="pre">toggleParamDialog</span></code> (see SnippetRunnerUtils.cpp).</p>
<p>An example of the use of this macro and its resulting values is in the TextChangeColour snippet, whose macro call is written as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SNIPRUN_REGISTER_WITH_DIALOG</span><span class="p">(</span><span class="n">TextChangeColourSnip</span><span class="p">,</span> <span class="s2">&quot;PDE Layer:</span>
      <span class="n">Text</span><span class="p">:</span><span class="n">Change</span> <span class="n">colour</span><span class="s2">&quot;,&quot;</span><span class="n">Shows</span> <span class="n">how</span> <span class="n">to</span> <span class="n">change</span> <span class="n">the</span> <span class="n">colour</span> <span class="n">of</span> <span class="n">text</span>
      <span class="ow">in</span> <span class="n">a</span> <span class="n">document</span><span class="s2">&quot;,&quot;</span><span class="mi">0</span> <span class="mi">0</span> <span class="mi">65000</span><span class="s2">&quot;)</span>
</pre></div>
</div>
<p>When this snippet is invoked, a dialog box displays âShows how to change colour of text in a documentâ and the parameter text edit box is pre-populated with the default values: â0 0 65000â. For this example, the parameters are meant to represent RGB color values. You can edit the text in the dialog box to change the values of the parameters.</p>
<p>To access the parameters passed in through the dialog box, use the <code class="docutils literal notranslate"><span class="pre">ParamsManager</span></code> class. This class (see ParamManager.cpp) provides a set of methods that allow you to obtain the input parameters as integer, string, hex, and fixed data types. (To provide support for other data types, you must extend the <code class="docutils literal notranslate"><span class="pre">ParamsManager</span></code> class.)</p>
<p>For example, the <code class="docutils literal notranslate"><span class="pre">TextChangeColour</span></code> function is defined with a single parameter of type <code class="docutils literal notranslate"><span class="pre">ParamManager</span> <span class="pre">*</span></code> , to provide storage for the snippetâs parameters:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">void</span> <span class="n">TextChangeColourSnip</span><span class="p">(</span><span class="n">ParamManager</span> <span class="o">*</span> <span class="n">thePM</span><span class="p">)</span>
</pre></div>
</div>
<p>The following code in the <code class="docutils literal notranslate"><span class="pre">TextChangeColourSnip</span></code> function converts the input parameter string to three separate RGB values of type integer:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ASInt32</span> <span class="n">red</span><span class="p">,</span><span class="n">green</span><span class="p">,</span><span class="n">blue</span><span class="p">;</span>

 <span class="n">thePM</span><span class="o">-&gt;</span><span class="n">getNextParamAsInt</span><span class="p">(</span><span class="n">red</span><span class="p">);</span>
 <span class="n">thePM</span><span class="o">-&gt;</span><span class="n">getNextParamAsInt</span><span class="p">(</span><span class="n">green</span><span class="p">);</span>
 <span class="n">thePM</span><span class="o">-&gt;</span><span class="n">getNextParamAsInt</span><span class="p">(</span><span class="n">blue</span><span class="p">);</span>
</pre></div>
</div>
<a name="52396"></a></div>
<div class="section" id="toggling-behavior-and-asynchronous-snippets">
<h2>Toggling behavior and asynchronous snippets<a class="headerlink" href="#toggling-behavior-and-asynchronous-snippets" title="Permalink to this headline">Â¶</a></h2>
<p>This section applies to Acrobat plug-in snippets only; not to the PDF Library SDK.</p>
<p>SnippetRunner provides utility methods for toggling behavior. For example, FormCalculationsSnip turns on and off the ability to perform form calculations. It uses the <code class="docutils literal notranslate"><span class="pre">toggleSnippetCheck</span></code> method (see SnippetRunnerUtils.cpp) to turn the state on if it was previously off, and vice versa.</p>
<p>Other snippets that toggle behavior include AVPageViewToggleWireframeDrawingSnip, and AVAppShowAnnotProperties.</p>
<p>Some snippets define and register callbacks in the same manner as plug-ins. (See the <a class="reference external" href="https://www.adobe.com/go/apireference">Acrobat and PDF Library API Reference</a> and <a class="reference external" href="../plugin/index.html">Plugin Developer Guide</a> for information regarding <code class="docutils literal notranslate"><span class="pre">ASCallback</span></code> objects, <code class="docutils literal notranslate"><span class="pre">ASCallbackCreateProto</span></code> and <code class="docutils literal notranslate"><span class="pre">ASCallbackDestroy</span></code> ). Specifically, to register a snippet for a notification, use <code class="docutils literal notranslate"><span class="pre">AVAppRegisterNotification</span></code> and provide a callback function with the appropriate arguments. To register your snippet for a specific event, such as <code class="docutils literal notranslate"><span class="pre">IdleProc</span></code> , <code class="docutils literal notranslate"><span class="pre">PageViewDrawing</span></code> , <code class="docutils literal notranslate"><span class="pre">PageViewClicks</span></code> or <code class="docutils literal notranslate"><span class="pre">PageViewAdjustCursor</span></code> , use the related <code class="docutils literal notranslate"><span class="pre">AVAppRegister</span></code> XXX method. You can toggle a snippet to Off by checking for its On state and unregistering via the complementary <code class="docutils literal notranslate"><span class="pre">AVAppUnregister</span></code> XXX method.</p>
<p>Such snippets can be asynchronous in the sense that they register a callback whose output (or other result) does not appear until a particular event occurs. Snippets that register for notifications include: <code class="docutils literal notranslate"><span class="pre">OptContNotificationTracerSnip</span></code> , <code class="docutils literal notranslate"><span class="pre">AVAppFrontDocChangeNotSnip</span></code> , <code class="docutils literal notranslate"><span class="pre">AVAppRegisterForPageViewDrawingSnip</span></code> , <code class="docutils literal notranslate"><span class="pre">PDDocDidDeletePagesNotSnip</span></code> and <code class="docutils literal notranslate"><span class="pre">IdleProcSnip</span></code>.</p>
</div>
<div class="section" id="handling-exceptions">
<h2>Handling exceptions<a class="headerlink" href="#handling-exceptions" title="Permalink to this headline">Â¶</a></h2>
<p>The SnippetRunner provides an exception handler that reports the name of the snippet that caused an exception. Synchronous snippets require no special considerations with regard to exception handling within the SnippetRunner environment.</p>
<p>However, if you write a snippet containing a callback that is called asynchronously, the callback function should include its own exception handlers to trap and handle various exceptions. When an exception occurs, your exception handler can perform any necessary cleanup, such as releasing memory. The core API provides the following macros for handling errors: <code class="docutils literal notranslate"><span class="pre">DURING</span></code> , <code class="docutils literal notranslate"><span class="pre">HANDLER</span></code> , <code class="docutils literal notranslate"><span class="pre">END_HANDLER</span></code> and <code class="docutils literal notranslate"><span class="pre">E_RETURN</span></code>.  If methods in your snippet code could return an error code or <code class="docutils literal notranslate"><span class="pre">NULL</span></code> if something goes wrong, you can call the <code class="docutils literal notranslate"><span class="pre">ASRaise</span></code> method, which generates an exception.</p>
</div>
<div class="section" id="handling-documents">
<h2>Handling documents<a class="headerlink" href="#handling-documents" title="Permalink to this headline">Â¶</a></h2>
<p>SnippetRunner provides a C++ class, <code class="docutils literal notranslate"><span class="pre">CDocument</span></code> , that handles getting documents in the SnippetRunner environment. (See CDocument.h and CDocument.cpp.)</p>
<p>To use this class, a document must be open. You declare a <code class="docutils literal notranslate"><span class="pre">CDocument</span></code> object and then cast it to the type you need. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CDocument</span> <span class="n">document</span><span class="p">;</span>
 <span class="n">AVDocGetFoo</span><span class="p">((</span><span class="n">AVDoc</span><span class="p">)</span><span class="n">document</span><span class="p">);</span>
</pre></div>
</div>
<p>Supported cast types are:</p>
<ul class="simple">
<li><p><em>AVDoc</em> â The front document (does not apply to PDF Library)</p></li>
<li><p><em>PDDoc</em> â The front <code class="docutils literal notranslate"><span class="pre">AVDoc</span></code> in Acrobat or the document that is open in PDF Library</p></li>
<li><p><em>CosDoc</em> â Derived from the current <code class="docutils literal notranslate"><span class="pre">PDDoc</span></code></p></li>
<li><p><em>AVPageView</em> â The current page view in the front document (does not apply to PDF Library)</p></li>
<li><p><em>PDPage</em> â The page associated with the current page view in Acrobat (or the page that has been set in PDF Library). It defaults to the first page.</p></li>
</ul>
<p>The destructor method of <code class="docutils literal notranslate"><span class="pre">CDocument</span></code> is called when the snippet returns. Therefore, you do not need to write code to release or destroy these objects.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Adobe Inc..
      <span class="lastupdated">
        Last update: Jun 30, 2022. 
        <img src="../../_static/adobelogo.png" class="logo"/> 
      </span>

    </p>
  </div> 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>