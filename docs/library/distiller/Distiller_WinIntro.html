
<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Learn how to integrate PDF product and features in your apps with the Acrobat and PDFL APIs. Create apps that integrate with and leverage features across Adobe's enterprise-class product lineup."
  
  <!-- Ben removed the title tag -->
  

  
   <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link href="../../_static/jquery-ui.css" rel="stylesheet" />  
  <link href="../../_static/copybutton.css" rel="stylesheet" />
  <link rel="stylesheet" href="../../_static/theme_overrides.css" type="text/css" />

    
  
  
  <link rel="canonical" href="https://www.adobe.com/go/acrobatsdk_homeDistiller_WinIntro.html" />
  

  
  
  
  <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
  <script type="text/javascript" src="../../_static/jquery.js"></script>
  <script type="text/javascript" src="../../_static/underscore.js"></script>
  <script type="text/javascript" src="../../_static/doctools.js"></script>
  <script type="text/javascript" src="../../_static/language_data.js"></script>
  <script type="text/javascript" src="../../_static/searchtools.js"></script>
  <script type="text/javascript" src="../../_static/clipboard.min.js"></script>
  <script type="text/javascript" src="../../_static/copybutton.js"></script>
  <script type="text/javascript" src="../../_static/js/theme.js"></script>
   
  
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Apple Events" href="Distiller_Mac.html" />
    <link rel="prev" title="Acrobat Distiller API Reference" href="Distiller_AutomationIntro.html" /> 
  
<script type='text/javascript'> window.marketingtech = { adobe: { launch: { property: "global", environment: "production" } }, };</script>
<script src="https://www.adobe.com/marketingtech/main.min.js"></script>

	<script>
    $(document).ready(function () {
      $(window).scroll(function () {
        if ($(this).scrollTop() >= 50) {
          $('.fixedbar, .wy-nav-side').addClass('scroll');
          $('.wy-top-menu-wrapper').fadeOut();
        } else {
          $('.fixedbar, .wy-nav-side').removeClass('scroll');
          $('.wy-top-menu-wrapper').fadeIn();
        }
      });
      $(window).scroll(function () {
        if ($(this).scrollTop() > 100) {
          $('#scroll').fadeIn();
        } else {
          $('#scroll').fadeOut();
        }
      });
      $('#scroll').click(function () {
        $("html, body").animate({ scrollTop: 0 }, 600);
        return false;
      });
    });
  </script>

<style>
  .wy-nav-content {max-width:90%}
  </style>
</head>

<body class="wy-body-for-nav">

  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
	  
	  	  
<!-- @@@@@@@@@@@@@@@@ Custom @@@@@@@@@@@@@@@@ -->
        <div class="wy-logo-wrapper"> 
          <a href="https://www.adobe.com/go/dc_developer">
            <img src="../../_static/acrobaticon.png" class="logo"/> 
          Acrobat and PDFL Developer Guides
          </a>
        </div> 
 <!-- @@@@@@@@@@@@@@@@ Custom @@@@@@@@@@@@@@@@ -->
 
        <div class="wy-side-nav-search" >
          

          
            <a href="toc.html" class="icon icon-home"> Acrobat-PDFL SDK: Distiller API Reference
          

          
          </a>

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="index.html">Acrobat-PDFL SDK: Distiller API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="Distiller_AutomationIntro.html">Acrobat Distiller API Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Distiller_AutomationIntro.html#restriction-on-directory-access">Restriction on Directory Access</a></li>
<li class="toctree-l2"><a class="reference internal" href="Distiller_AutomationIntro.html#windows-automation">Windows Automation</a></li>
<li class="toctree-l2"><a class="reference internal" href="Distiller_AutomationIntro.html#methods">Methods</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Distiller_AutomationIntro.html#create">Create</a></li>
<li class="toctree-l3"><a class="reference internal" href="Distiller_AutomationIntro.html#filetopdf">FileToPDF</a></li>
<li class="toctree-l3"><a class="reference internal" href="Distiller_AutomationIntro.html#filetopdf2">FileToPDF2</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Distiller_AutomationIntro.html#properties">Properties</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Distiller_AutomationIntro.html#bshowwindow">bShowWindow</a></li>
<li class="toctree-l3"><a class="reference internal" href="Distiller_AutomationIntro.html#bspooljobs">bSpoolJobs</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Distiller_AutomationIntro.html#events">Events</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Distiller_AutomationIntro.html#onjobstart">OnJobStart</a></li>
<li class="toctree-l3"><a class="reference internal" href="Distiller_AutomationIntro.html#onjobdone">OnJobDone</a></li>
<li class="toctree-l3"><a class="reference internal" href="Distiller_AutomationIntro.html#onjobfail">OnJobFail</a></li>
<li class="toctree-l3"><a class="reference internal" href="Distiller_AutomationIntro.html#onlogmessage">OnLogMessage</a></li>
<li class="toctree-l3"><a class="reference internal" href="Distiller_AutomationIntro.html#onpercentdone">OnPercentDone</a></li>
<li class="toctree-l3"><a class="reference internal" href="Distiller_AutomationIntro.html#onpagenumber">OnPageNumber</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Windows Messaging</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#specifying-input-and-output-files">Specifying input and output files</a></li>
<li class="toctree-l2"><a class="reference internal" href="#determining-use-of-the-save-dialog-box">Determining use of the Save dialog box</a></li>
<li class="toctree-l2"><a class="reference internal" href="#processing-the-file-list">Processing the file list</a></li>
<li class="toctree-l2"><a class="reference internal" href="#determining-the-version-number">Determining the version number</a></li>
<li class="toctree-l2"><a class="reference internal" href="#passing-in-command-lines">Passing in command lines</a></li>
<li class="toctree-l2"><a class="reference internal" href="#command-line-options">Command line options</a></li>
<li class="toctree-l2"><a class="reference internal" href="#disabling-prompts-for-output-file-names">Disabling prompts for output file names</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#turning-prompting-off-for-the-current-user">Turning prompting off for the current user</a></li>
<li class="toctree-l3"><a class="reference internal" href="#customizing-deployment-options-to-turn-off-prompting">Customizing deployment options to turn off prompting</a></li>
<li class="toctree-l3"><a class="reference internal" href="#programmatic-control">Programmatic control</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Distiller_Mac.html">Apple Events</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Distiller_Mac.html#objects">Objects</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Distiller_Mac.html#application">application</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Distiller_Mac.html#events">Events</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Distiller_Mac.html#distill">Distill</a></li>
<li class="toctree-l3"><a class="reference internal" href="Distiller_Mac.html#quit">quit</a></li>
<li class="toctree-l3"><a class="reference internal" href="Distiller_Mac.html#run">run</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference external" href="../index.html#://">Master Doc Search and TOC</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

        <!--- @@@@@@@@@@@@@@@@ Custom @@@@@@@@@@@@@@@@ -->
        <div class="fixedbar">  
          <div class="wy-menu-items">
            <a href="https://www.adobe.com/go/dc_developer" class="topbarlink">Acrobat Developer Home</a>
            <a href="https://www.adobe.io/apis/documentcloud/dcsdk/" class="topbarlink">Document Services SDK</a>
            <a href="https://www.adobe.com/go/acrobatsigndevguide" class="topbarlink">Acrobat Sign SDK</a>
            <a href="https://www.adobe.com/go/acrobatsdk_home" class="topbarlink">Acrobat SDK</a>
            <a href="https://www.adobe.com/go/pdflibrary" class="topbarlink">PDF Library SDK</a>
          </div>  
          <div class="sign-in">
            <a href="https://adminconsole.adobe.com//" class="btn btn-console">Console</a>
           <!-- <a href="https://auth.services.adobe.com/en_US/index.html">Sign in</a>-->
          </div>
        </div>
        <!--- @@@@@@@@@@@@@@@@ Custom @@@@@@@@@@@@@@@@ -->




   
      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="toc.html">Acrobat-PDFL SDK: Distiller API Reference</a>
        
      </nav>


      <div class="wy-nav-content">
      <a href="#" id="scroll" style="display:inline;"><span></span></a>
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="toc.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Windows Messaging</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
    
  </ul>

  
  <div class="rst-breadcrumbs-buttons" role="navigation" aria-label="breadcrumb navigation">
      
        <a href="Distiller_Mac.html" class="btn btn-neutral float-right" title="Apple Events" accesskey="n">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
      
      
        <a href="Distiller_AutomationIntro.html" class="btn btn-neutral float-left" title="Acrobat Distiller API Reference" accesskey="p"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
      
  </div>
  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="windows-messaging">
<h1>Windows Messaging<a class="headerlink" href="#windows-messaging" title="Permalink to this headline">¶</a></h1>
<p>Distiller supports Windows messages that can perform the following tasks:</p>
<ul class="simple">
<li><p>Specify the file or files to process and the output destination</p></li>
<li><p>Confirm when each file specified in the first Windows message has completed processing</p></li>
<li><p>Determine the Distiller version number</p></li>
</ul>
<p>The enumerated data types and constants necessary to use Windows messaging are defined in the file <code class="docutils literal notranslate"><span class="pre">distctrl.h</span></code>.  This file is included in the Adobe Acrobat SDK. Source files that use the Distiller control interface must include <code class="docutils literal notranslate"><span class="pre">distctrl.h</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="docutils literal notranslate"><span class="pre">WM_COPYDATA</span></code> interface provides compatibility for older applications only. You cannot use any of Distiller’s newer features with it, such as Adobe PDF settings files and input piping.</p>
</div>
<div class="section" id="specifying-input-and-output-files">
<h2>Specifying input and output files<a class="headerlink" href="#specifying-input-and-output-files" title="Permalink to this headline">¶</a></h2>
<p>Members of a structure of type <code class="docutils literal notranslate"><span class="pre">DISTILLRECORD</span></code> (defined in <code class="docutils literal notranslate"><span class="pre">distctrl.h</span></code> ) are set to specify the list of files to distill and the destination for the output files. Applications should fill in the structure members listed in the following table.</p>
<p>Members of the DISTILLRECORD structure</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 14%" />
<col style="width: 86%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Structure member</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>param</p></td>
<td><p>One of the values listed in the table <a class="reference external" href="Distiller_WinIntro.html#57674">EnqueueOption constants</a>.</p></td>
</tr>
<tr class="row-odd"><td><p>fileList</p></td>
<td><p>Comma-delimited list of files to distill (char).</p></td>
</tr>
<tr class="row-even"><td><p>outputFile</p></td>
<td><p>Destination path for output file or files (char). If multiple files are specified for <code class="docutils literal notranslate"><span class="pre">fileList</span></code> , specify a directory rather than a specific file, or each destination file will be overwritten by the next.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="determining-use-of-the-save-dialog-box">
<h2>Determining use of the Save dialog box<a class="headerlink" href="#determining-use-of-the-save-dialog-box" title="Permalink to this headline">¶</a></h2>
<p>One of the options listed in the following table must be specified in the <code class="docutils literal notranslate"><span class="pre">SendMessage</span></code> call to control the appearance of the Save dialog box when each source file is processed.</p>
<p>EnqueueOption constants</p>
<table class="docutils align-default" id="section-1">
<colgroup>
<col style="width: 24%" />
<col style="width: 76%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Constant</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>EQ_NO_SAVE_DIALOG</p></td>
<td><p>Do not display the Save dialog box.</p></td>
</tr>
<tr class="row-odd"><td><p>EQ_DEFAULT_OLD_DEST</p></td>
<td><p>Display the Save dialog box. Use the most recent destination directory as the default destination directory.</p></td>
</tr>
<tr class="row-even"><td><p>EQ_DEFAULT_SOURCE</p></td>
<td><p>Display the Save dialog box. Use the source file’s directory as the default destination directory.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="processing-the-file-list">
<h2>Processing the file list<a class="headerlink" href="#processing-the-file-list" title="Permalink to this headline">¶</a></h2>
<p>To instruct Distiller to begin processing the file list, a <code class="docutils literal notranslate"><span class="pre">COPYDATASTRUCT</span></code> containing the <code class="docutils literal notranslate"><span class="pre">DM_DISTILL</span></code> message and a pointer to a filled out <code class="docutils literal notranslate"><span class="pre">DISTILLRECORD</span></code> is sent to Distiller. The following example instructs Distiller to process a PostScript language file and store the resulting PDF file in a specified directory, omitting the unnecessary Save dialog box.</p>
<ol class="arabic simple">
<li><p>Processing a file list and omitting the Save dialog box</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">DISTILLRECORD</span> <span class="n">dr</span><span class="p">;</span>            <span class="o">/*</span> <span class="kn">from</span> <span class="nn">distctrl.h</span> <span class="o">*/</span>
 <span class="n">COPYDATASTRUCT</span> <span class="n">cds</span><span class="p">;</span>
 <span class="n">BOOL</span> <span class="n">ok</span><span class="p">;</span>
 <span class="n">LRESULT</span>                     <span class="n">rtn</span><span class="p">;</span>
 <span class="n">WORD</span>                        <span class="n">res</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
 <span class="n">char</span>                        <span class="n">msg</span><span class="p">[</span> <span class="mi">80</span><span class="p">];</span>
 <span class="n">hinst</span> <span class="o">=</span> <span class="n">ShellExec</span><span class="p">(</span> <span class="n">NULL</span><span class="p">,</span> <span class="s2">&quot;acrodist.exe&quot;</span><span class="p">,</span> <span class="n">strCmdArgs</span><span class="p">,</span> <span class="n">NULL</span><span class="p">,</span> <span class="n">SW_SHOW</span><span class="p">);</span>
 <span class="k">if</span> <span class="p">(</span><span class="n">res</span><span class="o">&lt;</span><span class="mi">32</span><span class="p">){</span>
         <span class="n">sprintf</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="s2">&quot;WinExec failed: error code = </span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">res</span><span class="p">);</span>
         <span class="k">return</span><span class="p">;</span>
 <span class="p">}</span>
 <span class="n">CWnd</span> <span class="o">*</span><span class="n">hDistillerCWnd</span> <span class="o">=</span> <span class="n">FindWindow</span><span class="p">(</span><span class="s2">&quot;Distiller&quot;</span><span class="p">,</span> <span class="n">NULL</span><span class="p">);</span>
 <span class="k">if</span> <span class="p">(</span><span class="n">hDistillerCWnd</span> <span class="o">!=</span> <span class="n">NULL</span><span class="p">)</span>
 <span class="p">{</span>
         <span class="n">strcpy</span><span class="p">(</span><span class="n">dr</span><span class="o">.</span><span class="n">outputFile</span><span class="p">,</span> <span class="s2">&quot;c: OUT.PDF&quot;</span><span class="p">);</span>
         <span class="n">strcpy</span><span class="p">(</span><span class="n">dr</span><span class="o">.</span><span class="n">fileList</span><span class="p">,</span> <span class="s2">&quot;C: TEST.PS&quot;</span><span class="p">);</span>
         <span class="n">dr</span><span class="o">.</span><span class="n">param</span> <span class="o">=</span> <span class="n">EQ_NO_SAVE_DIALOG</span><span class="p">;</span><span class="o">/*</span> <span class="kn">from</span> <span class="nn">distctrl.h</span> <span class="o">*/</span>
         <span class="n">cds</span><span class="o">.</span><span class="n">dwData</span> <span class="o">=</span> <span class="n">DM_DISTILL</span><span class="p">;</span>
         <span class="n">cds</span><span class="o">.</span><span class="n">cbData</span> <span class="o">=</span> <span class="n">sizeof</span><span class="p">(</span><span class="n">DISTILLRECORD</span><span class="p">);</span>
         <span class="n">cds</span><span class="o">.</span><span class="n">lpData</span> <span class="o">=</span> <span class="p">(</span><span class="n">PVOID</span><span class="p">)</span><span class="o">&amp;</span><span class="n">dr</span><span class="p">;</span>
         <span class="n">ok</span> <span class="o">=</span> <span class="p">(</span><span class="n">BOOL</span><span class="p">)</span><span class="n">hDistillerCWnd</span><span class="o">-&gt;</span><span class="n">SendMessage</span><span class="p">(</span><span class="n">WM_COPYDATA</span><span class="p">,</span>
                     <span class="p">(</span><span class="n">WPARAM</span><span class="p">)</span><span class="n">m_hWnd</span><span class="p">,</span> <span class="p">(</span><span class="n">LPARAM</span><span class="p">)</span><span class="o">&amp;</span><span class="n">cds</span><span class="p">);</span>
         <span class="k">if</span> <span class="p">(</span><span class="n">ok</span><span class="p">)</span>
                     <span class="o">/*</span> <span class="n">wake</span> <span class="n">up</span> <span class="n">Distiller</span> <span class="o">*/</span>
                     <span class="n">hDistillerCWnd</span><span class="o">-&gt;</span><span class="n">PostMessage</span><span class="p">(</span><span class="n">WM_TIMER</span><span class="p">,</span> <span class="n">ID_TIMER</span><span class="p">,</span> <span class="mi">0</span><span class="n">L</span><span class="p">);</span>
 <span class="p">}</span>
</pre></div>
</div>
<p>If the sending application is specified in the <code class="docutils literal notranslate"><span class="pre">WPARAM</span></code> parameter of the <code class="docutils literal notranslate"><span class="pre">SendMessage</span></code> call, a <code class="docutils literal notranslate"><span class="pre">WM_COPYDATA</span></code> message is returned to the application after each file specified has been distilled. The <code class="docutils literal notranslate"><span class="pre">LPARAM</span></code> parameter of this <code class="docutils literal notranslate"><span class="pre">WM_COPYDATA</span></code> message will contain a <code class="docutils literal notranslate"><span class="pre">COPYDATASTRUCT</span></code> that will include a Distiller <code class="docutils literal notranslate"><span class="pre">DM_DONE</span></code> message and a pointer to a structure of type <code class="docutils literal notranslate"><span class="pre">DISTILLRECORD</span></code>.  The <code class="docutils literal notranslate"><span class="pre">fileList</span></code> member of the structure contains the name of the PostScript language file that was processed, and the <code class="docutils literal notranslate"><span class="pre">outputFile</span></code> member contains the name of the resulting PDF file.</p>
</div>
<div class="section" id="determining-the-version-number">
<h2>Determining the version number<a class="headerlink" href="#determining-the-version-number" title="Permalink to this headline">¶</a></h2>
<p>To determine the Distiller program version number, send a <code class="docutils literal notranslate"><span class="pre">COPYDATASTRUCT</span></code> containing the <code class="docutils literal notranslate"><span class="pre">DM_VERSION</span></code> message to Distiller. The Distiller version number will be returned in the return value. The high word has the major version information and the low word has the minor version information.</p>
<ol class="arabic simple">
<li><p>Obtaining the Distiller version number</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">COPYDATASTRUCT</span> <span class="n">cds</span><span class="o">=</span><span class="p">{</span><span class="mi">0</span><span class="p">};</span>
 <span class="n">DWORD</span> <span class="n">dwVersion</span><span class="p">;</span>
 <span class="n">CWnd</span> <span class="o">*</span><span class="n">hDistillerCWnd</span> <span class="o">=</span> <span class="n">FindWindow</span><span class="p">(</span><span class="s2">&quot;Distiller&quot;</span><span class="p">,</span> <span class="n">NULL</span><span class="p">);</span>

 <span class="k">if</span> <span class="p">(</span><span class="n">hDistillerCWnd</span> <span class="o">!=</span> <span class="n">NULL</span><span class="p">)</span>
 <span class="p">{</span>
         <span class="n">cds</span><span class="o">.</span><span class="n">dwData</span> <span class="o">=</span> <span class="n">DM_VERSION</span><span class="p">;</span>
         <span class="n">cds</span><span class="o">.</span><span class="n">cbData</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
         <span class="n">cds</span><span class="o">.</span><span class="n">lpData</span> <span class="o">=</span> <span class="n">NULL</span><span class="p">;</span>
         <span class="n">dwVersion</span> <span class="o">=</span> <span class="p">(</span><span class="n">DWORD</span><span class="p">)</span><span class="n">hDistillerCWnd</span><span class="o">-&gt;</span>
 <span class="n">SendMessage</span><span class="p">(</span><span class="n">WM_COPYDATA</span><span class="p">,</span><span class="n">NULL</span><span class="p">,(</span><span class="n">LPARAM</span><span class="p">)</span><span class="o">&amp;</span><span class="n">cds</span><span class="p">);</span>
 <span class="k">if</span> <span class="p">(</span><span class="n">HIWORD</span><span class="p">(</span><span class="n">dwVersion</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">6</span><span class="p">)</span>
 <span class="p">;</span> <span class="o">//</span><span class="mf">6.</span><span class="n">x</span> <span class="ow">and</span> <span class="n">above</span><span class="p">;</span> <span class="n">LOWORD</span><span class="p">(</span><span class="n">dwVersion</span><span class="p">)</span> <span class="n">has</span> <span class="n">the</span> <span class="n">minor</span> <span class="n">version</span> <span class="n">number</span><span class="o">.</span>
 <span class="k">else</span>
 <span class="p">;</span> <span class="o">//</span> <span class="n">Distiller</span> <span class="mf">5.</span><span class="n">x</span> <span class="ow">and</span> <span class="n">below</span>
 <span class="p">}</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">distctrl.h</span></code> file for 32-bit Windows is different from the one for 16-bit Windows since the <code class="docutils literal notranslate"><span class="pre">WM_COPYDATA</span></code> message and <code class="docutils literal notranslate"><span class="pre">COPYDATASTRUCT</span></code> structure are not defined for 16-bit Windows. Make sure you use the correct <code class="docutils literal notranslate"><span class="pre">distctrl.h</span></code> for your application.</p>
</div>
<div class="section" id="passing-in-command-lines">
<h2>Passing in command lines<a class="headerlink" href="#passing-in-command-lines" title="Permalink to this headline">¶</a></h2>
<p>In addition to the old <code class="docutils literal notranslate"><span class="pre">WM_COPYDATA</span></code> interface that uses the limited <code class="docutils literal notranslate"><span class="pre">DISTILLRECORD</span></code> structure, the newer <code class="docutils literal notranslate"><span class="pre">WM_COPYDATA</span></code> interface simply lets you pass a command line. This way you can use any of the command line options, such as <code class="docutils literal notranslate"><span class="pre">/J</span></code> to specify the Adobe PDF settings file (which the old <code class="docutils literal notranslate"><span class="pre">WM_COPYDATA</span></code> interface does not allow).</p>
<p>Using the new <code class="docutils literal notranslate"><span class="pre">WM_COPYDATA</span></code> interface is similar to the old, except you create a command line string instead of a data structure.</p>
<ol class="arabic simple">
<li><p>Creating a command line string</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">char</span> <span class="n">szCmdLine</span><span class="p">[]</span> <span class="o">=</span> <span class="s2">&quot;/O outfile.pdf /J myoptions.joboptions infile.ps&quot;</span>
     <span class="n">COPYDATASTRUCT</span> <span class="n">cds</span><span class="p">;</span>
     <span class="n">cds</span><span class="o">.</span><span class="n">dwData</span> <span class="o">=</span> <span class="n">DM_CMDLINE</span><span class="p">;</span>
     <span class="n">cds</span><span class="o">.</span><span class="n">cbData</span> <span class="o">=</span> <span class="n">strlen</span><span class="p">(</span><span class="n">szCmdLine</span><span class="p">)</span> <span class="o">+</span> <span class="n">sizeof</span><span class="p">(</span><span class="n">char</span><span class="p">);</span>
     <span class="n">cds</span><span class="o">.</span><span class="n">lpData</span> <span class="o">=</span> <span class="n">szCmdLine</span><span class="p">;</span>
     <span class="n">SendMessage</span><span class="p">(</span> <span class="n">hwndDistiller</span><span class="p">,</span> <span class="n">WM_COPYDATA</span><span class="p">,</span>
             <span class="p">(</span><span class="n">WPARAM</span><span class="p">)</span><span class="n">hwndMyWindow</span><span class="p">,</span> <span class="p">(</span><span class="n">LPARAM</span><span class="p">)</span><span class="o">&amp;</span><span class="n">cds</span> <span class="p">);</span>
</pre></div>
</div>
<ol class="arabic simple">
<li><p>Getting the Distiller version number</p></li>
</ol>
<p>To get the Distiller version number, a COPYDATASTRUCT containing the DM_VERSION message is sent to Distiller.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">COPYDATASTRUCT</span> <span class="n">cds</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">};</span>
 <span class="n">cds</span><span class="o">.</span><span class="n">dwData</span> <span class="o">=</span> <span class="n">DM_VERSION</span><span class="p">;</span>
 <span class="n">DWORD</span> <span class="n">dwVersion</span> <span class="o">=</span> <span class="n">SendMessage</span><span class="p">(</span> <span class="n">hwndDistiller</span><span class="p">,</span> <span class="n">WM_COPYDATA</span><span class="p">,</span>
 <span class="n">WPARAM</span><span class="p">)</span><span class="n">hwndMyWindow</span><span class="p">,</span> <span class="p">(</span><span class="n">LPARAM</span><span class="p">)</span><span class="o">&amp;</span><span class="n">cds</span> <span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="command-line-options">
<h2>Command line options<a class="headerlink" href="#command-line-options" title="Permalink to this headline">¶</a></h2>
<p>Distiller 6.0 and above support command line and <code class="docutils literal notranslate"><span class="pre">WM_COPYDATA</span></code> interfaces and add the <code class="docutils literal notranslate"><span class="pre">--deletelog</span></code> and <code class="docutils literal notranslate"><span class="pre">--nosecurity</span></code> switches. Options can be passed as arguments on the command line.</p>
<p>The command line syntax is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">acrodist</span> <span class="p">[</span><span class="n">switches</span><span class="p">]</span> <span class="p">[</span><span class="n">inputFiles</span><span class="p">]</span>
</pre></div>
</div>
<p>If any switches are present, they must come before any input files. Switches and input file names are both optional. The command <code class="docutils literal notranslate"><span class="pre">acrodist</span></code> by itself runs Distiller, or if a normal instance of Distiller is already running, it brings Distiller to the foreground.</p>
<p>The switches parameter is a list of optional commands. Either the dash (-) or slash (/) character can begin a switch, which is identified by a single case-independent letter. (Note, however, that the <code class="docutils literal notranslate"><span class="pre">deletelog</span></code> and <code class="docutils literal notranslate"><span class="pre">nosecurity</span></code> switches can only be preceded by a double dash (–).) There should be a space after the switch letter, and if the switch takes a parameter, another space after the parameter. The parameter should be in quotes if it contains any spaces. Do not combine switches—give each one its own prefix (- or /).</p>
<p>The parameter inputFiles is a list of file names, separated by spaces or commas. Spaces and commas are both legal file name characters; if a file name contains spaces or commas, enclose it in double quotes.</p>
<p>To process a list of PostScript files, use this syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">acrodist</span> <span class="p">[</span><span class="n">switches</span><span class="p">]</span> <span class="n">inputFiles</span><span class="p">[,</span> <span class="n">inputFiles</span><span class="o">...</span><span class="p">]</span>
</pre></div>
</div>
<p>The following table lists the optional command line switches.</p>
<p>Command line switches</p>
<table class="docutils align-default" id="section-2">
<colgroup>
<col style="width: 7%" />
<col style="width: 93%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Switch</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>–deletelog:on
–deletelog:off</p></td>
<td><p>Forces Distiller to create or delete the log file after the PDF file is created. <code class="docutils literal notranslate"><span class="pre">--deletelog:on</span></code> turns on logging for the generated PDF. <code class="docutils literal notranslate"><span class="pre">--deletelog:off</span></code> turns off logging for the generated PDF.</p></td>
</tr>
<tr class="row-odd"><td><p>/E [pdfSettingsFilePath]</p></td>
<td><p>Opens the Distiller Adobe PDF Settings dialog box to edit the specified Adobe PDF settings file. If you specify a file name with no path, Distiller looks in its Settings folder for the file. If you omit the file name, Distiller uses the current default settings file.</p>
<p>This switch cannot be combined with any other command line options. Distiller will not process any PostScript files and does not display its main window. It just opens the Adobe PDF Settings dialog box and exits when you close that window.</p>
<p>Put quotes around Adobe PDF settings file names that contain spaces. For example:</p>
<p><code class="docutils literal notranslate"><span class="pre">&quot;High</span> <span class="pre">Quality&quot;</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">&quot;High</span> <span class="pre">Quality.joboptions&quot;</span></code></p>
</td>
</tr>
<tr class="row-even"><td><p>/F</p></td>
<td><p>Enables or restricts files that can be accessed by PostScript operators, depending on the version of Distiller. Typically, this switch affects file embedding. Between Distiller 8.0 and 8.1, the sense of this switch was reversed to address security concerns.</p>
<p>For Acrobat Distiller 8.1 and greater, the <code class="docutils literal notranslate"><span class="pre">/F</span></code> switch permits the PostScript file operators unlimited file access.</p>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>Enabling unlimited file access can pose security problems.</p>
</div>
<p>For Acrobat Distiller 5.0 through 8.0, the <code class="docutils literal notranslate"><span class="pre">/F</span></code> switch restricts PostScript file operators to fonts, color profiles, and other system resources needed for normal operation.</p>
<p>Regardless of the <code class="docutils literal notranslate"><span class="pre">/F</span></code> switch, all versions of Acrobat Distiller can access fonts, color profiles, and other system resources needed for normal operation.</p>
</td>
</tr>
<tr class="row-odd"><td><p>/J [pdfSettingsFilePath]</p></td>
<td><p>Uses pdfSettingsFilePath as the Adobe PDF settings file for any input files specified on the command line. If you specify a file name with no path, Distiller looks in its Settings folder for the file. If you omit the file name, Distiller uses the current default settings file. Does not affect any of the Adobe PDF settings you can set with the user interface.</p>
<p>Put quotes around job option file names that contain spaces. For example:</p>
<p><code class="docutils literal notranslate"><span class="pre">&quot;High</span> <span class="pre">Quality&quot;</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">&quot;High</span> <span class="pre">Quality.joboptions&quot;</span></code></p>
</td>
</tr>
<tr class="row-even"><td><p>/N</p></td>
<td><p>Runs a new instance of Distiller, even if another Distiller instance is already running. Without this switch, Distiller switches to any “normal” previous instance. The Distiller instance created with this switch does not process watched folders and is marked so that it will not get activated by other “normal” Distillers that get launched later. The number of new instances of Distiller that can be created with this switch is limited by system resources.</p>
<ul class="simple">
<li><p>When using this switch, do not use the command line <code class="docutils literal notranslate"><span class="pre">start</span></code> command with the <code class="docutils literal notranslate"><span class="pre">/wait</span></code> option. The command “<code class="docutils literal notranslate"><span class="pre">start</span> <span class="pre">/Wait</span></code> ” negates the effect of using <code class="docutils literal notranslate"><span class="pre">/N</span></code> with Distiller.</p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p>–nosecurity</p></td>
<td><p>Suppresses the Confirm Security dialog box. No security will be applied to the file.</p>
<ul class="simple">
<li><p>This option was implemented only for the Adobe PDF printer and should be passed as a <code class="docutils literal notranslate"><span class="pre">WM_COPYDATA</span></code> message or through the COM interface. If it is used as a command line option, then the PDF file (from the command line PostScript stream) will not have any security. But if the user drags and drops another PostScript file from the user interface, then the security settings in the registry will be applied; this is the reason to show the Confirm Security dialog box.</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p>/O outputFileOrFolderPath</p></td>
<td><p>Specifies the output PDF file name or a directory name to put PDF files in. If you specify a directory name, Distiller uses the input file name for each input file.</p>
<p>To process a PostScript language file and name the output PDF file use this syntax:</p>
<blockquote>
<div><p>acrodist /o destFile srcFile</p>
</div></blockquote>
<p>To process a list of PostScript language files and place the output PDF files in a specified directory, use this syntax:</p>
<blockquote>
<div><p>acrodist /o directory srcFile1[, srcFile2…]</p>
</div></blockquote>
</td>
</tr>
<tr class="row-odd"><td><p>/Q [:seconds]</p></td>
<td><p>Instructs Distiller to exit immediately when it becomes idle. Distiller checks this switch only if Distiller is launched as a new instance (<code class="docutils literal notranslate"><span class="pre">/N</span></code> ); otherwise idle time is limited by the watched folder timer.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">/N</span></code> is also used, Distiller quits after processing all files on the command line. If <code class="docutils literal notranslate"><span class="pre">/N</span></code> is not used, Distiller quits after processing all PostScript files in watched directories and any that were specified on the command line.</p>
<p>To force Distiller to terminate when it has finished distilling all PostScript files in watched directories and any that were specified on the command line, use this syntax:</p>
<blockquote>
<div><p>acrodist /q [sourceFile1[, sourceFile2…]]</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">/Q</span></code> also accepts an optional timeout value in seconds, <code class="docutils literal notranslate"><span class="pre">/Q:n</span></code>.  Use the timeout to instruct Distiller to wait for <code class="docutils literal notranslate"><span class="pre">n</span></code> seconds of idle time before exiting. <code class="docutils literal notranslate"><span class="pre">n</span></code> must be a positive integer and cannot be greater than 2147483 seconds (<code class="docutils literal notranslate"><span class="pre">Ox7fffffff/1000</span></code> ), or about 24.8 days.</p>
<p>The default watched folder timer is set to 10 seconds, so every 10 seconds Distiller wakes up to check the watched folder. Since it is checking every 10 seconds, it is idle for no more than 10 seconds.</p>
<p>If the <code class="docutils literal notranslate"><span class="pre">SetTimer</span></code> value is less than 10 seconds, then the system rounds this value to 10 seconds.</p>
</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="disabling-prompts-for-output-file-names">
<h2>Disabling prompts for output file names<a class="headerlink" href="#disabling-prompts-for-output-file-names" title="Permalink to this headline">¶</a></h2>
<p>Distiller prompts for output file names based on settings that can be managed with a user interface or by programmatic control.</p>
<div class="section" id="turning-prompting-off-for-the-current-user">
<h3>Turning prompting off for the current user<a class="headerlink" href="#turning-prompting-off-for-the-current-user" title="Permalink to this headline">¶</a></h3>
<p>Prompting can be turned off for the current user for all Adobe PDF document creation regardless of the application using the Adobe PDF printer.</p>
<ol class="arabic simple">
<li><p>To turn prompting off for the current user:</p></li>
<li><p>From the Windows Start menu, click Control Panel and open Printers and Faxes folder.</p></li>
<li><p>Right click on Adobe PDF printer and select Printing Preferences from the context menu. Select the default document folder from Adobe PDF Output Folder menu, or click the Browse button to create your own output folder.</p></li>
<li><p>Click OK.</p></li>
</ol>
<p>Prompting can be turned off for the current user for Adobe PDF document creation using the Acrobat Distiller.</p>
<ol class="arabic simple">
<li><p>To turn prompting off for the current user using Distiller:</p></li>
<li><p>Start Acrobat Distiller, from the Distiller menu choose <strong>File &gt; Preferences</strong>.</p></li>
<li><p>In the Preferences - Acrobat Distiller dialog box, deselect the <strong>Ask for PDF file destination</strong> option.</p></li>
<li><p>Click <strong>OK</strong>.</p></li>
</ol>
</div>
<div class="section" id="customizing-deployment-options-to-turn-off-prompting">
<h3>Customizing deployment options to turn off prompting<a class="headerlink" href="#customizing-deployment-options-to-turn-off-prompting" title="Permalink to this headline">¶</a></h3>
<p>You can disable prompts via the Customization Wizard for Windows prior to application deployment</p>
</div>
<div class="section" id="programmatic-control">
<h3>Programmatic control<a class="headerlink" href="#programmatic-control" title="Permalink to this headline">¶</a></h3>
<p>Prompting can be turned off programmatically by adding a key to the Windows registry. This method applies to the creation of only one PDF document by a specific application for the current user. To use this method, add the following registry key:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">HKEY_CURRENT_USERSoftwareAdobeAcrobat</span> <span class="n">DistillerPrinterJobControl</span>
</pre></div>
</div>
<p>This key takes as subkeys:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">Default</span><span class="p">)</span>

  <span class="n">application</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">(Default)</span></code> entry is reserved for possible future use and is not to be used.</p>
<p>The application subkey is the full path of the application for which prompting is to be turned off. The value of the application subkey is a <code class="docutils literal notranslate"><span class="pre">REG_SZ</span></code> value that is the full path of the output file. For example, the following registry script would turn off prompting for the next printing performed by <code class="docutils literal notranslate"><span class="pre">wordpad.exe</span></code> , printing to the file <code class="docutils literal notranslate"><span class="pre">c:MyPDFoutputFileName.pdf</span></code> :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Windows</span> <span class="n">Registry</span> <span class="n">Editor</span> <span class="n">Version</span> <span class="mf">5.00</span>
 <span class="p">[</span><span class="n">HKEY_CURRENT_USERSoftwareAdobeAcrobat</span> <span class="n">DistillerPrinterJobControl</span><span class="p">]</span>

  <span class="s2">&quot;C:Program FilesWindows NTAccessorieswordpad.exe&quot;</span> <span class="o">=</span>
 <span class="s2">&quot;c:MyPDFoutputFileName.pdf&quot;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Though the programming language may require that your backslashes are escaped (for example, <code class="docutils literal notranslate"><span class="pre">&quot;c:MyPDFoutputFileName.pdf&quot;</span></code> ), the value of the registry entry must use single slashes. This key, once established, remains until used and is removed once the Windows API function <code class="docutils literal notranslate"><span class="pre">StartDoc(HDC</span> <span class="pre">hdc,</span> <span class="pre">CONST</span> <span class="pre">DOCINFO*</span> <span class="pre">lpdi)</span></code> has successfully completed. Also note that the output folder path must already exist with read and write access for the current user and the destination file must not exist.</p>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2022, Adobe Inc..
      <span class="lastupdated">
        Last update: Jun 30, 2022. 
        <img src="../../_static/adobelogo.png" class="logo"/> 
      </span>

    </p>
  </div> 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>