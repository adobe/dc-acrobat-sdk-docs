
<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Learn how to integrate PDF products and features in your apps with the Acrobat and PDFL APIs. Create apps that integrate with Adobe's enterprise-class product lineup."/>
  <meta name=viewport content="width=device-width, initial-scale=1">
  
  <title>Acrobat- PDFL SDK: Using Batch Sequences &mdash; Acrobat-PDFL SDK:  Using Batch Sequences</title>
  

  
   <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link href="../../_static/jquery-ui.css" rel="stylesheet" />  
  <link href="../../_static/copybutton.css" rel="stylesheet" />
  <link rel="stylesheet" href="../../_static/theme_overrides.css" type="text/css" />

    
  
  
  <link rel="canonical" href="https://www.adobe.com/go/acrobatsdk_homeindex.html" />
  

  
  
  
  <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
  <script type="text/javascript" src="../../_static/jquery.js"></script>
  <script type="text/javascript" src="../../_static/underscore.js"></script>
  <script type="text/javascript" src="../../_static/doctools.js"></script>
  <script type="text/javascript" src="../../_static/language_data.js"></script>
  <script type="text/javascript" src="../../_static/searchtools.js"></script>
  <script type="text/javascript" src="../../_static/clipboard.min.js"></script>
  <script type="text/javascript" src="../../_static/copybutton.js"></script>
  <script type="text/javascript" src="../../_static/js/theme.js"></script>
   
  
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Acrobat-PDFL SDK: Batch Sequences" href="toc.html" /> 
  
<script type='text/javascript'> window.marketingtech = { adobe: { launch: { property: "global", environment: "production" } }, };</script>
<script src="https://www.adobe.com/marketingtech/main.min.js"></script>

	<script>
    $(document).ready(function () {
      $(window).scroll(function () {
        if ($(this).scrollTop() >= 50) {
          $('.fixedbar, .wy-nav-side').addClass('scroll');
          $('.wy-top-menu-wrapper').fadeOut();
        } else {
          $('.fixedbar, .wy-nav-side').removeClass('scroll');
          $('.wy-top-menu-wrapper').fadeIn();
        }
      });
      $(window).scroll(function () {
        if ($(this).scrollTop() > 100) {
          $('#scroll').fadeIn();
        } else {
          $('#scroll').fadeOut();
        }
      });
      $('#scroll').click(function () {
        $("html, body").animate({ scrollTop: 0 }, 600);
        return false;
      });
    });
  </script>

<style>
  .wy-nav-content {max-width:90%}
  </style>
</head>

<body class="wy-body-for-nav">

  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
	  
	  	  
<!-- @@@@@@@@@@@@@@@@ Custom @@@@@@@@@@@@@@@@ -->
        <div class="wy-logo-wrapper"> 
          <a href="https://www.adobe.com/go/dc_developer">
            <img src="../../_static/acrobaticon.png" class="logo"/> 
          Acrobat and PDFL Developer Guides
          </a>
        </div> 
 <!-- @@@@@@@@@@@@@@@@ Custom @@@@@@@@@@@@@@@@ -->
 
        <div class="wy-side-nav-search" >
          

          
            <a href="toc.html" class="icon icon-home"> Acrobat-PDFL SDK:  Using Batch Sequences
          

          
          </a>

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Acrobat- PDFL SDK: Using Batch Sequences</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#creating-and-running-a-batch-sequence">Creating and running a batch sequence</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#create-a-batch-sequence-that-sets-the-disclosed-property-to-true">Create a batch sequence that sets the disclosed property to true:</a></li>
<li class="toctree-l3"><a class="reference internal" href="#to-select-files">To select files:</a></li>
<li class="toctree-l3"><a class="reference internal" href="#to-run-a-batch-sequence">To run a batch sequence:</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#batch-processing-objects">Batch processing objects</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#aborting-a-script">Aborting a script</a></li>
<li class="toctree-l3"><a class="reference internal" href="#using-the-this-object">Using the this object</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#global-variables">Global variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="#beginning-and-ending-a-batch-job">Beginning and ending a batch job</a></li>
<li class="toctree-l2"><a class="reference internal" href="#debugging-and-testing-tips">Debugging and testing tips</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference external" href="../index.html#://">Master Doc Search and TOC</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

        <!--- @@@@@@@@@@@@@@@@ Custom @@@@@@@@@@@@@@@@ -->
        <div class="fixedbar">  
          <div class="wy-menu-items">
            <a href="https://www.adobe.com/go/dc_developer" class="topbarlink">Acrobat Developer Home</a>
            <a href="https://www.adobe.io/apis/documentcloud/dcsdk/" class="topbarlink">Document Services SDK</a>
            <a href="https://www.adobe.com/go/acrobatsigndevguide" class="topbarlink">Acrobat Sign SDK</a>
            <a href="https://www.adobe.com/go/acrobatsdk_home" class="topbarlink">Acrobat SDK</a>
            <a href="https://www.adobe.com/go/pdflibrary" class="topbarlink">PDF Library SDK</a>
          </div>  
          <div class="sign-in">
            <a href="https://adminconsole.adobe.com//" class="btn btn-console">Console</a>
           <!-- <a href="https://auth.services.adobe.com/en_US/index.html">Sign in</a>-->
          </div>
        </div>
        <!--- @@@@@@@@@@@@@@@@ Custom @@@@@@@@@@@@@@@@ -->




   
      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="toc.html">Acrobat-PDFL SDK:  Using Batch Sequences</a>
        
      </nav>


      <div class="wy-nav-content">
      <a href="#" id="scroll" style="display:inline;"><span></span></a>
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="toc.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Acrobat- PDFL SDK: Using Batch Sequences</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
    
  </ul>

  
  <div class="rst-breadcrumbs-buttons" role="navigation" aria-label="breadcrumb navigation">
      
      
        <a href="toc.html" class="btn btn-neutral float-left" title="Acrobat-PDFL SDK: Batch Sequences" accesskey="p"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
      
  </div>
  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="acrobat-pdfl-sdk-using-batch-sequences">
<h1>Acrobat- PDFL SDK: Using Batch Sequences<a class="headerlink" href="#acrobat-pdfl-sdk-using-batch-sequences" title="Permalink to this headline">¶</a></h1>
<p>A batch sequence performs repetitive operations on a collection of <em>selected files</em> . Batch processing sequences, like all JavaScript code, are executed as a result of a particular event. During the event, the script is repeatedly executed on each of the selected files.</p>
<p>This chapter addresses some of the principles of writing a batch sequence that uses the Execute JavaScript batch command. With these principles in mind, and a knowledge of the JavaScript API for Acrobat, you will be able to write your own batch sequences.</p>
<div class="section" id="creating-and-running-a-batch-sequence">
<h2>Creating and running a batch sequence<a class="headerlink" href="#creating-and-running-a-batch-sequence" title="Permalink to this headline">¶</a></h2>
<p>A batch sequence is created through the UI of Acrobat Pro. In version 8, the batch sequence feature is accessed by selecting Advanced &gt; Document Processing &gt; Batch Sequences. The following batch sequence files are shipped with Acrobat Pro:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Embed</span> <span class="n">Page</span> <span class="n">Thumbnails</span><span class="o">.</span><span class="n">sequ</span>
<span class="n">Open</span> <span class="n">All</span><span class="o">.</span><span class="n">sequ</span>
<span class="n">Print</span> <span class="n">All</span><span class="o">.</span><span class="n">sequ</span>
<span class="n">Save</span> <span class="n">All</span> <span class="k">as</span> <span class="n">RTF</span><span class="o">.</span><span class="n">sequ</span>
<span class="n">Fast</span> <span class="n">Web</span> <span class="n">View</span><span class="o">.</span><span class="n">sequ</span>
<span class="n">Print</span> <span class="mi">1</span><span class="n">st</span> <span class="n">Page</span> <span class="n">of</span> <span class="n">All</span><span class="o">.</span><span class="n">sequ</span>
<span class="n">Remove</span> <span class="n">File</span> <span class="n">Attachments</span><span class="o">.</span><span class="n">sequ</span>
<span class="n">Set</span> <span class="n">Security</span> <span class="n">to</span> <span class="n">No</span> <span class="n">Changes</span><span class="o">.</span><span class="n">sequ</span>
</pre></div>
</div>
<p>The batch sequence is saved to a text file with an extension of <code class="docutils literal notranslate"><span class="pre">sequ</span></code>.  Acrobat Help covers how to use the batch processing feature, and, in particular, how to use these sequences.</p>
<p>You are more interested in writing your own, so let’s walk through the creation of a simple, yet useful, batch sequence.</p>
<p>Task: For each of the selected files, set the <code class="docutils literal notranslate"><span class="pre">disclosed</span></code> property to <code class="docutils literal notranslate"><span class="pre">true</span></code>.  (The <code class="docutils literal notranslate"><span class="pre">disclosed</span></code> property of the Doc object is very important to certain document processing operations. When <code class="docutils literal notranslate"><span class="pre">disclosed</span></code> is set to <code class="docutils literal notranslate"><span class="pre">true</span></code> , the <code class="docutils literal notranslate"><span class="pre">app.activeDocs</span></code> and <code class="docutils literal notranslate"><span class="pre">app.openDoc</span></code> methods return Doc objects rather than <code class="docutils literal notranslate"><span class="pre">null</span></code>.</p>
<p>The procedure below steps you through the creation of a batch sequence. The sequence inserts the script <code class="docutils literal notranslate"><span class="pre">this.disclosed</span> <span class="pre">=</span> <span class="pre">true</span></code> in each of the selected documents as document JavaScript.</p>
<div class="section" id="create-a-batch-sequence-that-sets-the-disclosed-property-to-true">
<h3>Create a batch sequence that sets the disclosed property to true:<a class="headerlink" href="#create-a-batch-sequence-that-sets-the-disclosed-property-to-true" title="Permalink to this headline">¶</a></h3>
<ol class="arabic simple">
<li><p>Select Tools Pane &gt; Action Wizard &gt; Create New Action.</p></li>
<li><p>Click New Sequence, and type Make disclosed in the Name Sequence dialog box.</p></li>
<li><p>In the Edit Batch Sequence dialog box, click the Select Command button to get to the Edit Sequence dialog box.</p></li>
<li><p>In the Edit Sequence dialog box, double-click Execute JavaScript to move it to the right side.</p></li>
<li><p>Click the Edit button to open the JavaScript editor.</p></li>
<li><p>Type the following code:</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/*</span> <span class="n">Make</span> <span class="n">disclosed</span> <span class="o">*/</span>
 <span class="n">this</span><span class="o">.</span><span class="n">addScript</span><span class="p">(</span><span class="s2">&quot;This Doc is Disclosed&quot;</span><span class="p">,</span> <span class="s2">&quot;this.disclosed = true;&quot;</span><span class="p">);</span>
</pre></div>
</div>
<ol class="arabic simple" start="7">
<li><p>Close all the dialog boxes.</p></li>
</ol>
<p><code class="docutils literal notranslate"><span class="pre">Make</span> <span class="pre">disclosed</span></code> now appears in the list of actions.</p>
<p>To run this new script you must first select the collection of files that the batch sequence will process. The general procedure below assumes the Edit Sequence dialog box is not open. Follow the procedure for the new Make disclosed batch sequence.</p>
</div>
<div class="section" id="to-select-files">
<h3>To select files:<a class="headerlink" href="#to-select-files" title="Permalink to this headline">¶</a></h3>
<ol class="arabic simple">
<li><p>Choose Tools Pane &gt; Action Wizard.</p></li>
<li><p>In the Batch Sequences dialog box, highlight one of the listed sequences, and click Edit Sequence.</p></li>
<li><p>In the Edit Batch Sequence dialog box, select one of the following items from the Run Commands On list:</p>
<ul class="simple">
<li><p>Selected Files</p></li>
<li><p>Selected Folders</p></li>
<li><p>Ask When Sequence is Run</p></li>
<li><p>Files Open in Acrobat</p></li>
</ul>
</li>
<li><p>Close all the dialog boxes.</p></li>
</ol>
<p>Finally, run your new batch sequence.</p>
</div>
<div class="section" id="to-run-a-batch-sequence">
<h3>To run a batch sequence:<a class="headerlink" href="#to-run-a-batch-sequence" title="Permalink to this headline">¶</a></h3>
<ol class="arabic simple">
<li><p>Choose <strong>Advanced</strong> &gt; <strong>Document Processing</strong> &gt; <strong>Batch Processing</strong>.</p></li>
<li><p>In the <strong>Batch Sequences</strong> dialog box, highlight one of the listed sequences, and click <strong>Edit Sequence</strong>.</p></li>
<li><p>In the <strong>Edit Batch Sequence</strong> dialog box, verify that the files selected are the ones you want to process. Click <strong>OK</strong>.</p></li>
<li><p>In the <strong>Batch Sequences</strong> dialog box, click <strong>Run Sequence</strong>.  In the <strong>Run Sequence Confirmation</strong> dialog box, click <strong>OK</strong>.</p></li>
<li><p>After processing is over, close the <strong>Batch Sequences</strong> dialog box.</p></li>
</ol>
<p>When creating a batch sequence to perform a task, you can use one or more of the batch commands listed in the Edit Sequence dialog box in combination with the Execute JavaScript batch command; for example, one sample sequence uses Execute JavaScript to sign the document, and then uses the Security batch command to set the security of the document.</p>
</div>
</div>
<div class="section" id="batch-processing-objects">
<h2>Batch processing objects<a class="headerlink" href="#batch-processing-objects" title="Permalink to this headline">¶</a></h2>
<p>When you run a batch sequence that contains an Execute JavaScript batch command, a <em>batch event</em> occurs and an <code class="docutils literal notranslate"><span class="pre">event</span></code> object is created. This object contains the following properties:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 13%" />
<col style="width: 87%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>target</p></td>
<td><p>During a batch sequence, the <code class="docutils literal notranslate"><span class="pre">target</span></code> property of the <code class="docutils literal notranslate"><span class="pre">event</span></code> object points to the Doc object of the file currently being processed. For example, <code class="docutils literal notranslate"><span class="pre">event.target.path</span></code> is the device-independent path of the file currently being processed.</p>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">this</span></code> object also points to the Doc object of the file currently being processed in the batch.</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p>rc</p></td>
<td><p>The <code class="docutils literal notranslate"><span class="pre">rc</span></code> property contains a return code for each application of the sequence. Setting <code class="docutils literal notranslate"><span class="pre">rc</span></code> to <code class="docutils literal notranslate"><span class="pre">false</span></code> aborts the batch process, so that no further files are processed (if any remain in the selected files collection).</p></td>
</tr>
</tbody>
</table>
<div class="section" id="aborting-a-script">
<h3>Aborting a script<a class="headerlink" href="#aborting-a-script" title="Permalink to this headline">¶</a></h3>
<p>Setting <code class="docutils literal notranslate"><span class="pre">event.rc</span></code> <code class="docutils literal notranslate"><span class="pre">=</span></code> <code class="docutils literal notranslate"><span class="pre">false</span></code> aborts the batch process, but does not abort the script itself. The remaining code in the program flow is executed. One strategy to avoid the continuation of the flow is to throw an exception, and set <code class="docutils literal notranslate"><span class="pre">event.rc</span></code> <code class="docutils literal notranslate"><span class="pre">=</span></code> <code class="docutils literal notranslate"><span class="pre">false</span></code> with the catch:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">try</span> <span class="p">{</span>
     <span class="o">...</span> <span class="n">JS</span> <span class="n">script</span> <span class="k">for</span> <span class="n">batch</span> <span class="n">processing</span> <span class="o">.....</span>
     <span class="k">if</span> <span class="p">(</span> <span class="n">somethingGoesWrong</span> <span class="p">)</span> <span class="n">throw</span> <span class="s2">&quot;Aborting Process&quot;</span>
     <span class="o">....</span><span class="n">JS</span> <span class="n">script</span> <span class="k">for</span> <span class="n">batch</span> <span class="n">processing</span> <span class="o">....</span>
     <span class="p">}</span> <span class="n">catch</span> <span class="p">(</span><span class="n">e</span><span class="p">)</span>
     <span class="p">{</span>
     <span class="o">...</span> <span class="n">clean</span> <span class="n">up</span> <span class="n">code</span> <span class="n">lines</span> <span class="o">....</span>
     <span class="n">event</span><span class="o">.</span><span class="n">rc</span> <span class="o">=</span> <span class="n">false</span><span class="p">;</span>
     <span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="using-the-this-object">
<h3>Using the this object<a class="headerlink" href="#using-the-this-object" title="Permalink to this headline">¶</a></h3>
<p>The this object points to the Doc object, for example, the following script gathers all annotations in the document currently being processed, sorts them by author, and returns an array of annotation objects for further manipulation:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">var</span> <span class="n">annots</span> <span class="o">=</span> <span class="n">this</span><span class="o">.</span><span class="n">getAnnots</span><span class="p">({</span><span class="n">nSortBy</span><span class="p">:</span> <span class="n">ANSB_Author</span><span class="p">});</span>
</pre></div>
</div>
<p>Alternatively, you can also use <code class="docutils literal notranslate"><span class="pre">event.target</span></code> :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">var</span> <span class="n">annots</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">getAnnots</span><span class="p">({</span><span class="n">nSortBy</span><span class="p">:</span> <span class="n">ANSB_Author</span><span class="p">});</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="global-variables">
<h2>Global variables<a class="headerlink" href="#global-variables" title="Permalink to this headline">¶</a></h2>
<p>Variables that must hold their values across document processing must be declared as global.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">global</span><span class="o">.</span><span class="n">report</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Report</span><span class="p">()</span>
 <span class="k">global</span><span class="o">.</span><span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</pre></div>
</div>
<p>This declaration causes the <code class="docutils literal notranslate"><span class="pre">global.report</span></code> object to be available for each application of the script to a selected file. For example, the script that processes a file might contain the following code:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">global</span><span class="o">.</span><span class="n">counter</span><span class="o">++</span>
 <span class="k">global</span><span class="o">.</span><span class="n">report</span><span class="o">.</span><span class="n">writeText</span><span class="p">(</span><span class="s2">&quot;Report on File #&quot;</span><span class="o">+</span><span class="k">global</span><span class="o">.</span><span class="n">counter</span><span class="p">);</span>
</pre></div>
</div>
<p>At the end of the batch job, any global variables can be removed. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">delete</span> <span class="k">global</span><span class="o">.</span><span class="n">counter</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="section" id="beginning-and-ending-a-batch-job">
<h2>Beginning and ending a batch job<a class="headerlink" href="#beginning-and-ending-a-batch-job" title="Permalink to this headline">¶</a></h2>
<p>More complicated batch jobs that involve cross-document reporting may need some start-up, or <em>Begin Job</em> code, to initialize global variables before processing begins. After the files are processed, you can use <em>End Job</em> code to clean up or write a report.</p>
<p>The batch feature of Acrobat Pro does not have a built-in capability for <em>Begin Job</em> and <em>End Job</em> code. The approach the sample sequences takes for detecting the begin and end of job is to use two global variables, <code class="docutils literal notranslate"><span class="pre">global.counter</span></code> and <code class="docutils literal notranslate"><span class="pre">global.FileCnt</span></code>.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">global.counter</span></code> : This variable detects the beginning of the job, counts the files as they are processed and determines when the end of the job occurs. When the batch is run, the variable is initialized to zero and incremented with each iteration of the script, or is initialized to the number of files to be processed and decremented with each iteration. The <em>End Job</em> code runs when the variable reaches the number of files being processed, or 0.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">global.FileCnt</span></code> : Most of the work is done by <code class="docutils literal notranslate"><span class="pre">global.counter</span></code> ; however, you do need to know how many files are to be processed. This is the role the <code class="docutils literal notranslate"><span class="pre">global.FileCnt</span></code> plays. The value of <code class="docutils literal notranslate"><span class="pre">global.FileCnt</span></code> can be manually set (by executing <code class="docutils literal notranslate"><span class="pre">global.FileCnt</span></code> <code class="docutils literal notranslate"><span class="pre">=</span></code> <code class="docutils literal notranslate"><span class="pre">5</span></code> in the console, for example <code class="docutils literal notranslate"><span class="pre">)</span></code> or programmatically by another batch sequence. Set the value of <code class="docutils literal notranslate"><span class="pre">global.FileCnt</span></code> to the number of files selected.</p></li>
<li><p>Specify the number of files to process</p></li>
</ul>
<p>The following code is a general outline of how you can insert <em>Begin Job</em> and <em>End Job</em> code: it uses <code class="docutils literal notranslate"><span class="pre">global.counter</span></code> to detect the beginning of the job and uses another global variable <code class="docutils literal notranslate"><span class="pre">global.FileCnt</span></code> set earlier by another batch sequence that counts the number of files to be processed to detect the end of the job.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span> <span class="n">Begin</span> <span class="n">job</span>
 <span class="k">if</span> <span class="p">(</span> <span class="n">typeof</span> <span class="k">global</span><span class="o">.</span><span class="n">counter</span> <span class="o">==</span> <span class="s2">&quot;undefined&quot;</span> <span class="p">)</span> <span class="p">{</span>
         <span class="n">console</span><span class="o">.</span><span class="n">println</span><span class="p">(</span><span class="s2">&quot;Begin Job Code&quot;</span><span class="p">);</span>
         <span class="k">global</span><span class="o">.</span><span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
         <span class="o">//</span> <span class="n">insert</span> <span class="n">beginJob</span> <span class="n">code</span> <span class="n">here</span>
         <span class="o">................</span>
 <span class="p">}</span>
 <span class="o">//</span> <span class="n">Main</span> <span class="n">code</span> <span class="n">to</span> <span class="n">process</span> <span class="n">each</span> <span class="n">of</span> <span class="n">the</span> <span class="n">selected</span> <span class="n">files</span>
 <span class="k">try</span> <span class="p">{</span>
     <span class="k">global</span><span class="o">.</span><span class="n">counter</span><span class="o">++</span>
     <span class="n">console</span><span class="o">.</span><span class="n">println</span><span class="p">(</span><span class="s2">&quot;Processing File #&quot;</span> <span class="o">+</span> <span class="k">global</span><span class="o">.</span><span class="n">counter</span><span class="p">);</span>
     <span class="o">//</span>  <span class="n">insert</span> <span class="n">batch</span> <span class="n">code</span> <span class="n">here</span><span class="o">.</span>
     <span class="o">...............</span>
 <span class="p">}</span> <span class="n">catch</span><span class="p">(</span><span class="n">e</span><span class="p">)</span> <span class="p">{</span>
     <span class="n">console</span><span class="o">.</span><span class="n">println</span><span class="p">(</span><span class="s2">&quot;Batch aborted on run #&quot;</span> <span class="o">+</span> <span class="k">global</span><span class="o">.</span><span class="n">counter</span><span class="p">);</span>
     <span class="n">delete</span> <span class="k">global</span><span class="o">.</span><span class="n">counter</span><span class="p">;</span>      <span class="o">//</span> <span class="n">Try</span> <span class="n">again</span><span class="p">,</span> <span class="ow">and</span> <span class="n">avoid</span> <span class="n">End</span> <span class="n">Job</span> <span class="n">code</span>
     <span class="n">event</span><span class="o">.</span><span class="n">rc</span> <span class="o">=</span> <span class="n">false</span><span class="p">;</span>         <span class="o">//</span> <span class="n">Abort</span> <span class="n">batch</span>
 <span class="p">}</span>
 <span class="o">//</span> <span class="n">End</span> <span class="n">job</span>
 <span class="k">if</span> <span class="p">(</span> <span class="k">global</span><span class="o">.</span><span class="n">counter</span> <span class="o">==</span> <span class="k">global</span><span class="o">.</span><span class="n">FileCnt</span> <span class="p">)</span> <span class="p">{</span>
     <span class="n">console</span><span class="o">.</span><span class="n">println</span><span class="p">(</span><span class="s2">&quot;End Job Code&quot;</span><span class="p">);</span>
     <span class="o">//</span> <span class="n">Insert</span> <span class="n">endJob</span> <span class="n">code</span> <span class="n">here</span>
     <span class="o">.................</span>
     <span class="o">//</span> <span class="n">Remove</span> <span class="nb">any</span> <span class="k">global</span> <span class="n">variables</span> <span class="n">used</span> <span class="ow">in</span> <span class="n">case</span> <span class="n">user</span> <span class="n">wants</span> <span class="n">to</span> <span class="n">run</span>
     <span class="o">//</span> <span class="n">another</span> <span class="n">batch</span> <span class="n">sequence</span> <span class="n">using</span> <span class="n">the</span> <span class="n">same</span> <span class="n">variables</span>
     <span class="n">delete</span> <span class="k">global</span><span class="o">.</span><span class="n">counter</span><span class="p">;</span>
 <span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="debugging-and-testing-tips">
<h2>Debugging and testing tips<a class="headerlink" href="#debugging-and-testing-tips" title="Permalink to this headline">¶</a></h2>
<p>The batch feature is very useful for performing a number of tasks on large scale. However, it poses its own dangers. Any automated utility that saves files to a hard drive can potentially create havoc on that drive.</p>
<p>Here are some debugging and testing tips:</p>
<ul class="simple">
<li><p>When testing the script, use test documents rather than real documents.</p></li>
<li><p>Initially, work with a small number of test documents.</p></li>
<li><p>Use test directories containing files that can be safely overwritten.</p></li>
<li><p>Make sure your paths exist. If an <code class="docutils literal notranslate"><span class="pre">app.openDoc</span></code> is executed with a path that does not exist, an exception is thrown.</p></li>
<li><p>Use <code class="docutils literal notranslate"><span class="pre">try/catch/throw</span></code> to exit gracefully from a batch if something goes wrong (such as bad paths), and to better control the flow of the code. (See “Aborting a script”.</p></li>
<li><p>Use <code class="docutils literal notranslate"><span class="pre">console.println()</span></code> to write information to the console for feedback as to the value of different variables as the batch runs.</p></li>
<li><p>When potentially executing an infinite loop, during the testing phase limit the loop to a finite number of executions until you are sure the code is correct.</p></li>
<li><p>If you use the <em>Begin Job/End Job</em> technique illustrated above, make sure the global counter variable is undefined before the job runs.</p></li>
</ul>
</div>
</div>


           </div>
           
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2022, Adobe Inc..
      <span class="lastupdated">
        Last update: Jul 11, 2022. 
        <img src="../../_static/adobelogo.png" class="logo"/> 
      </span>

    </p>
  </div> 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>