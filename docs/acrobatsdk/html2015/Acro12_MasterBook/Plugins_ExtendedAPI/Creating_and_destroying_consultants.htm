<!DOCTYPE HTML>
<html>
<head><meta http-equiv="refresh" content="2;url=https://opensource.adobe.com/dc-acrobat-sdk-docs/acrobatsdk/" /><meta name="robots" content="noindex, nofollow">

 <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
 <title>Creating and destroying consultants</title>

 <meta name="generator" content="Adobe FrameMaker 2015" />
 <meta name="Originator" content="ImportMif" />
 <meta name="OriginalFile" content="C:\Users\Perforce\Work\Groups\SDK\main\Documents\Common\docs_fm\PluginAppsDeveloperGuide\Plugins_ExtendedAPI.fm" />
 <link rel="stylesheet" href="Plugins_ExtendedAPI.css" type="text/css" />


<script type="text/javascript" language="JavaScript">
//<![CDATA[
function reDo() {
  if (innerWidth != origWidth || innerHeight != origHeight)
     location.reload();
}
if ((parseInt(navigator.appVersion) == 4) && (navigator.appName == "Netscape")) {
	origWidth = innerWidth;
	origHeight = innerHeight;
	onresize = reDo;
}
onerror = null; 
//]]>
</script>
<style type="text/css">
<!--
div.WebHelpPopupMenu { position:absolute;
left:0px;
top:0px;
z-index:4;
visibility:hidden; }
p.WebHelpNavBar { text-align:right; }
-->
</style>

<script type="text/javascript" src="../../template/scripts/rh.min.js"></script>
<script type="text/javascript" src="../../template/scripts/common.min.js"></script>
<script type="text/javascript" src="../../template/scripts/topic.min.js"></script>
<script type="text/javascript" src="../../template/scripts/constants.js"></script>
<script type="text/javascript" src="../../template/scripts/utils.js"></script>
<script type="text/javascript" src="../../template/scripts/mhutils.js"></script>
<script type="text/javascript" src="../../template/scripts/mhlang.js"></script>
<script type="text/javascript" src="../../template/scripts/mhver.js"></script>
<script type="text/javascript" src="../../template/scripts/settings.js"></script>
<script type="text/javascript" src="../../template/scripts/XmlJsReader.js"></script>
<script type="text/javascript" src="../../template/scripts/loadparentdata.js"></script>
<script type="text/javascript" src="../../template/scripts/loadscreen.js"></script>
<script type="text/javascript" src="../../template/scripts/loadprojdata.js"></script>
<script type="text/javascript" src="../../template/scripts/mhtopic.js"></script>
 <link rel="stylesheet" type="text/css" href="../../template/styles/topic.min.css">
<script type="text/javascript" >
gRootRelPath = "../..";
gCommonRootRelPath = "../..";
gTopicId = "2.1.21.1.0_4";
</script>
 <meta name="brsprev" value="Acro12_MasterBook/Plugins_ExtendedAPI/Importing_the_consultant_HFTs_into_a_plug-in.htm">
 <meta name="brsnext" value="Acro12_MasterBook/Plugins_ExtendedAPI/Registering_agents_with_consultants.htm">
 <meta name="topic-breadcrumbs" content="Plug-ins and Applications > Overview > Working with Acrobat Extended APIs > PDF Consultant and Accessibility Checker extended API" />
</head>

<body dir="ltr">
<script type="text/javascript" src="../../ehlpdhtm.js"></script>
<div dir="ltr">
  <h3>Creating and destroying consultants</h3>
  <p class="BodyLevel1">The consultant’s HFT allows you to create a consultant for your own use. Once you have finished writing your agent class, you are ready to register it with the consultant and begin processing documents. You should keep your agent separate from the consultant object—that is, do not make the consultant object a member of your agent class. Use a plug-in as the owner for both the consultant and your agent object.</p>
  <p class="BodyLevel1">Because there is some memory overhead in creating a consultant, you should only create a <span class="FM_Courier">Consultant</span>&#160;object when it is required, not before. If your target application is a plug-in, the most logical place to perform all operations is in the menu item execute procedure. Whether or not it makes sense to destroy the <span class="FM_Courier">Consultant</span> object after each execution of the menu item depends on your project.</p>
  <p class="BodyLevel1">The consultant HFT provides the functions <span class="FM_Courier">ConsultantCreate</span>&#160;and <span class="FM_Courier">ConsultantDestroy</span>, for creating and destroying <span class="FM_Courier">Consultant</span>&#160;objects. It also provides the Consultant data type, an opaque type for passing handles to <span class="FM_Courier">Consultant</span>&#160;objects. The <span class="FM_Courier">ConsultantCreate</span>&#160;method returns variables of that type and requires them as parameters to all other HFT functions having the <span class="FM_Courier">Consultant</span> prefix.</p>
  <p class="BodyLevel1">After each run the consultant unregisters all the agents that were registered with it; however the memory for the <span class="FM_Courier">Consultant</span>&#160;object itself remains, and the object must be explicitly destroyed to free the memory. Depending on the duties you assign your consultant, you may want to destroy it after each execution of the menu item that launches it, or you may wish to keep it running.</p>
  </div>
</body>
</html>