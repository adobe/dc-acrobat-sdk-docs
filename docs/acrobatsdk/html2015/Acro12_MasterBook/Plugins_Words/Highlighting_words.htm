<!DOCTYPE HTML>
<html>
<head><meta http-equiv="refresh" content="2;url=https://opensource.adobe.com/dc-acrobat-sdk-docs/acrobatsdk/" /><meta name="robots" content="noindex, nofollow">

 <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
 <title>Highlighting words</title>

 <meta name="generator" content="Adobe FrameMaker 2015" />
 <meta name="Originator" content="ImportMif" />
 <meta name="OriginalFile" content="C:\Users\Perforce\Work\Groups\SDK\main\Documents\Common\docs_fm\PluginAppsDeveloperGuide\Plugins_Words.fm" />
 <link rel="stylesheet" href="Plugins_Words.css" type="text/css" />


<script type="text/javascript" language="JavaScript">
//<![CDATA[
function reDo() {
  if (innerWidth != origWidth || innerHeight != origHeight)
     location.reload();
}
if ((parseInt(navigator.appVersion) == 4) && (navigator.appName == "Netscape")) {
	origWidth = innerWidth;
	origHeight = innerHeight;
	onresize = reDo;
}
onerror = null; 
//]]>
</script>
<style type="text/css">
<!--
div.WebHelpPopupMenu { position:absolute;
left:0px;
top:0px;
z-index:4;
visibility:hidden; }
p.WebHelpNavBar { text-align:right; }
-->
</style>

<script type="text/javascript" src="../../template/scripts/rh.min.js"></script>
<script type="text/javascript" src="../../template/scripts/common.min.js"></script>
<script type="text/javascript" src="../../template/scripts/topic.min.js"></script>
<script type="text/javascript" src="../../template/scripts/constants.js"></script>
<script type="text/javascript" src="../../template/scripts/utils.js"></script>
<script type="text/javascript" src="../../template/scripts/mhutils.js"></script>
<script type="text/javascript" src="../../template/scripts/mhlang.js"></script>
<script type="text/javascript" src="../../template/scripts/mhver.js"></script>
<script type="text/javascript" src="../../template/scripts/settings.js"></script>
<script type="text/javascript" src="../../template/scripts/XmlJsReader.js"></script>
<script type="text/javascript" src="../../template/scripts/loadparentdata.js"></script>
<script type="text/javascript" src="../../template/scripts/loadscreen.js"></script>
<script type="text/javascript" src="../../template/scripts/loadprojdata.js"></script>
<script type="text/javascript" src="../../template/scripts/mhtopic.js"></script>
 <link rel="stylesheet" type="text/css" href="../../template/styles/topic.min.css">
<script type="text/javascript" >
gRootRelPath = "../..";
gCommonRootRelPath = "../..";
gTopicId = "2.1.11.1_3";
</script>
 <meta name="brsprev" value="Acro12_MasterBook/Plugins_Words/Extracting_and_displaying_words.htm">
 <meta name="brsnext" value="Acro12_MasterBook/Plugins_Handlers/Creating_Handlers.htm">
 <meta name="topic-breadcrumbs" content="Plug-ins and Applications > Overview > Working with Words" />
</head>

<body dir="ltr">
<script type="text/javascript" src="../../ehlpdhtm.js"></script>
<div dir="ltr">
  <h2><a name="XREF_84894_Highlighting_words"></a>Highlighting words</h2>
  <p class="BodyLevel1">You can use the <uservariable x-value="Acrobat" x-showvalue="TRUE" name="AcrobatProd" x-format="AcrobatProd">Acrobat</uservariable>&#160;core API to highlight a word or a group of words located within a PDF document. By highlighting a word, you can make a specific word or group of words stand out. The following illustration shows the word <span class="FM_Italic">Adobe</span> highlighted.</p>
  <p class="FM_GraphicBody"><img alt="Screen shot of a PDF document where the word &quot;Adobe&quot; is highlighted using the highlight tool." style=" width:100%; margin-bottom:0.000pt; max-width:368.719pt;" id="image0" src="highlight.jpg" />&nbsp;</p>
  <p class="BodyLevel1">To highlight a word you must create a <span class="FM_Courier">HiliteEntry</span>&#160;object and set its <span class="FM_Courier">offset</span>&#160;and length <span class="FM_Courier">attributes</span>. The <span class="FM_Courier">offset</span>&#160;attribute specifies the location of the word from the beginning of the document. For example, if you specify 1, then the second word in the document is highlighted (this value is a 0-based index). The <span class="FM_Courier">length</span>&#160;attribute specifies the number of words that are highlighted. If you specify 1, then a single word is highlighted.</p>
  <p class="BodyLevel1">You can highlight a word that is located in the current page by performing the following tasks:</p>
  <p class="FM_StepReset"><span style="padding-left: 66pt;" class="FMAutoNumber_1"></span>1.<span style="padding-left: 2pt;" class="FMAutoNumber_2"></span>Create a <span class="FM_Courier">HiliteEntry</span>&#160;object and set its <span class="FM_Courier">offset</span>&#160;and length <span class="FM_Courier">attributes</span>.</p>
  <p class="FM_Step"><a name="IX_AVAppGetActiveDoc_2"></a><a name="IX_AVAppGetActiveDoc_method_2"></a><span style="padding-left: 66pt;" class="FMAutoNumber_1"></span>2.<span style="padding-left: 2pt;" class="FMAutoNumber_2"></span>Create an <span class="FM_Courier">AVDoc</span>&#160;object by invoking the <span class="FM_Courier">AVAppGetActiveDoc</span>&#160;method. (See <a href="../Plugins_Documents/Opening_PDF_documents.htm#XREF_65430_Opening_a_PDF">Opening PDF documents</a>.)</p>
  <p class="FM_Step"><a name="IX_AVDocGetPDDoc_4"></a><a name="IX_AVDocGetPDDoc_method_4"></a><span style="padding-left: 66pt;" class="FMAutoNumber_1"></span>3.<span style="padding-left: 2pt;" class="FMAutoNumber_2"></span>Create a <span class="FM_Courier">PDDoc</span>&#160;object by invoking the <span class="FM_Courier">AVDocGetPDDoc</span>&#160;method and passing the <span class="FM_Courier">AVDoc</span> object.</p>
  <p class="FM_Step"><a name="IX_AVDocGetPageView_4"></a><a name="IX_AVDocGetPageView_method_4"></a><span style="padding-left: 66pt;" class="FMAutoNumber_1"></span>4.<span style="padding-left: 2pt;" class="FMAutoNumber_2"></span>Get the page view by invoking the <span class="FM_Courier">AVDocGetPageView</span>&#160;method and passing the <span class="FM_Courier">AVDoc</span>&#160;object. This method returns an <span class="FM_Courier">AVPageView</span>&#160;object. (See <a href="../Plugins_Pages/Displaying_page_views.htm#XREF_52579_Displaying_a_page">Displaying page views </a>.) </p>
  <p class="FM_Step"><a name="IX_AVPageViewGetPageNum_3"></a><a name="IX_AVPageViewGetPageNum_2"></a><span style="padding-left: 66pt;" class="FMAutoNumber_1"></span>5.<span style="padding-left: 2pt;" class="FMAutoNumber_2"></span>Get the current page number by invoking the <span class="FM_Courier">AVPageViewGetPageNum</span>&#160;method and passing the <span class="FM_Courier">AVPageView</span>&#160;object. This method returns the page number of the current page view, which is required to highlight a word or group of words. </p>
  <p class="FM_Step"><a name="IX_PDDocAcquirePage_4"></a><a name="IX_PDDocAcquirePage_method_4"></a><span style="padding-left: 66pt;" class="FMAutoNumber_1"></span>6.<span style="padding-left: 2pt;" class="FMAutoNumber_2"></span>Create a <span class="FM_Courier">PDPage</span>&#160;object by invoking the <span class="FM_Courier">PDDocAcquirePage</span>&#160;method and passing the following arguments:</p>
  <ul type="disc" style="Direction:Direction:ltr;
;
">
   <li>
   <p class="FM_Bullet2">A <span class="FM_Courier">PDDoc</span> object.</p>
</li>
   <li>
   <p class="FM_Bullet2">The page number of the current page view.</p>
</li>
  </ul>
  <p class="FM_Indent1">The <span class="FM_Courier">PDDocAcquirePage</span>&#160;method returns a <span class="FM_Courier">PDPage</span> object.</p>
  <p class="FM_Step"><a name="IX_PDTextSelectCreateWordHil_1"></a><a name="IX_PDTextSelectCreateWordHil"></a><span style="padding-left: 66pt;" class="FMAutoNumber_1"></span>7.<span style="padding-left: 2pt;" class="FMAutoNumber_2"></span>Highlight a word or group of words by invoking the <span class="FM_Courier">PDTextSelectCreateWordHilite</span>&#160;method and passing the following arguments:</p>
  <ul type="disc" style="Direction:Direction:ltr;
;
">
   <li>
   <p class="FM_Bullet2">A <span class="FM_Courier">PDPage</span> object that represents the page that will contain the highlighted word(s).</p>
</li>
   <li>
   <p class="FM_Bullet2">The address of the <span class="FM_Courier">HiliteEntry</span> object.</p>
</li>
   <li>
   <p class="FM_Bullet2">An <span class="FM_Courier">ASInt32</span> value that specifies the number of highlight entries.</p>
</li>
  </ul>
  <p class="FM_Indent1">This method returns a <span class="FM_Courier">PDTextSelect</span> object.</p>
  <p class="FM_Step"><a name="IX_AVDocSetSelection"></a><a name="IX_AVDocSetSelection_method"></a><span style="padding-left: 66pt;" class="FMAutoNumber_1"></span>8.<span style="padding-left: 2pt;" class="FMAutoNumber_2"></span>Set the PDF document's text selection type by invoking the <span class="FM_Courier">AVDocSetSelection</span>&#160;method. This method does not have a return value and requires the following arguments:</p>
  <ul type="disc" style="Direction:Direction:ltr;
;
">
   <li>
   <p class="FM_Bullet2">An <span class="FM_Courier">AVDoc</span> object that represents the PDF document in which the highlighted words appear.</p>
</li>
   <li>
   <p class="FM_Bullet2">An <span class="FM_Courier">ASAtom</span>&#160;object that specifies the selection type. Because words are highlighted, you can specify <span class="FM_Courier">text</span>. </p>
</li>
   <li>
   <p class="FM_Bullet2">A <span class="FM_Courier">PDTextSelect</span>&#160;object that represents the text selection. Cast the <span class="FM_Courier">PDTextSelect</span>&#160;object as a void pointer.</p>
</li>
   <li>
   <p class="FM_Bullet2">An <span class="FM_Courier">ASBool</span>&#160;object that specifies whether to highlight the selection. Pass the value <span class="FM_Courier">true</span>&#160;to highlight the specified word(s). </p>
</li>
  </ul>
  <p class="FM_Step"><a name="IX_AVDocShowSelection"></a><a name="IX_AVDocShowSelection_method"></a><span style="padding-left: 66pt;" class="FMAutoNumber_1"></span>9.<span style="padding-left: 2pt;" class="FMAutoNumber_2"></span>Display the current selection by invoking the <span class="FM_Courier">AVDocShowSelection</span>&#160;method and passing the <span class="FM_Courier">AVDoc</span>&#160;that represents the PDF document that contains the highlighted word(s).</p>
  <p class="FM_Step"><span style="padding-left: 66pt;" class="FMAutoNumber_1"></span>10.Release the <span class="FM_Courier">PDPage</span>&#160;object by invoking the <span class="FM_Courier">PDPageRelease</span>&#160;method and passing the <span class="FM_Courier">PDPage</span> object.</p>
  <p class="BodyLevel1">The following code example highlights the tenth word that is located in the page of the current PDF document. </p>
  <ul type="disc" style="Direction:Direction:ltr;
;
">
   <li>
   <p class="FM_5Head_Example">Highlighting a word in a PDF document</p>
</li>
  </ul>
  <p class="FM_CodeComment">//Create a HiliteEntry object and set its attributes</p>
  <p class="FM_CodeReference">HiliteEntry hilite;</p>
  <p class="FM_CodeReference">hilite.offset = 10;</p>
  <p class="FM_CodeReference">hilite.length = 1;</p>
  <p class="FM_CodeReference">&nbsp;</p>
  <p class="FM_CodeComment">//Get the page number of the current page view</p>
  <p class="FM_CodeReference">AVDoc currentAVDoc = AVAppGetActiveDoc();</p>
  <p class="FM_CodeReference">PDDoc currentPDDoc = AVDocGetPDDoc(currentAVDoc);</p>
  <p class="FM_CodeReference">AVPageView currentPageView = AVDocGetPageView(currentAVDoc);</p>
  <p class="FM_CodeReference">ASInt32 pageNum = AVPageViewGetPageNum(currentPageView); </p>
  <p class="FM_CodeReference">&nbsp;</p>
  <p class="FM_CodeComment">//Highlight the tenth word</p>
  <p class="FM_CodeReference">PDPage pdPage = PDDocAcquirePage (currentPDDoc, pageNum);</p>
  <p class="FM_CodeReference">PDTextSelect textSelection = PDTextSelectCreateWordHilite(pdPage, <br />&amp;hilite, 1);</p>
  <p class="FM_CodeReference">AVDocSetSelection(currentAVDoc, ASAtomFromString(&quot;Text&quot;), <br />(void *)textSelection, true);</p>
  <p class="FM_CodeReference">AVDocShowSelection (currentAVDoc);</p>
  <p class="FM_CodeReference">PDPageRelease (pdPage);</p>
 </div>
</body>
</html>