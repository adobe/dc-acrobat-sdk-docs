<!DOCTYPE HTML>
<html>
<head>

 <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
 <title>Displaying an open dialog box</title>

 <meta name="generator" content="Adobe FrameMaker 2015" />
 <meta name="Originator" content="ImportMif" />
 <meta name="OriginalFile" content="C:\Users\Perforce\Work\Groups\SDK\main\Documents\Common\docs_fm\PluginAppsDeveloperGuide\Plugins_Documents.fm" />
 <link rel="stylesheet" href="Plugins_Documents.css" type="text/css" />


<script type="text/javascript" language="JavaScript">
//<![CDATA[
function reDo() {
  if (innerWidth != origWidth || innerHeight != origHeight)
     location.reload();
}
if ((parseInt(navigator.appVersion) == 4) && (navigator.appName == "Netscape")) {
	origWidth = innerWidth;
	origHeight = innerHeight;
	onresize = reDo;
}
onerror = null; 
//]]>
</script>
<style type="text/css">
<!--
div.WebHelpPopupMenu { position:absolute;
left:0px;
top:0px;
z-index:4;
visibility:hidden; }
p.WebHelpNavBar { text-align:right; }
-->
</style>

<script type="text/javascript" src="../../template/scripts/rh.min.js"></script>
<script type="text/javascript" src="../../template/scripts/common.min.js"></script>
<script type="text/javascript" src="../../template/scripts/topic.min.js"></script>
<script type="text/javascript" src="../../template/scripts/constants.js"></script>
<script type="text/javascript" src="../../template/scripts/utils.js"></script>
<script type="text/javascript" src="../../template/scripts/mhutils.js"></script>
<script type="text/javascript" src="../../template/scripts/mhlang.js"></script>
<script type="text/javascript" src="../../template/scripts/mhver.js"></script>
<script type="text/javascript" src="../../template/scripts/settings.js"></script>
<script type="text/javascript" src="../../template/scripts/XmlJsReader.js"></script>
<script type="text/javascript" src="../../template/scripts/loadparentdata.js"></script>
<script type="text/javascript" src="../../template/scripts/loadscreen.js"></script>
<script type="text/javascript" src="../../template/scripts/loadprojdata.js"></script>
<script type="text/javascript" src="../../template/scripts/mhtopic.js"></script>
 <link rel="stylesheet" type="text/css" href="../../template/styles/topic.min.css">
<script type="text/javascript" >
gRootRelPath = "../..";
gCommonRootRelPath = "../..";
gTopicId = "2.1.5.1.0_4";
</script>
 <meta name="brsprev" value="Acro12_MasterBook/Plugins_Documents/Creating_a_handler_for_an_external_window.htm">
 <meta name="brsnext" value="Acro12_MasterBook/Plugins_Documents/Displaying_a_PDF_document_within_a_window.htm">
 <meta name="topic-breadcrumbs" content="Plug-ins and Applications > Overview > Working with Documents and Files > Opening a PDF document in an external window" />
</head>

<body dir="ltr">
<script type="text/javascript" src="../../ehlpdhtm.js"></script>
<div dir="ltr">
  <h3><a name="IX_an_open_dialog_box"></a><a name="IX_AVOpenSaveDialogParamsRec_1"></a><a name="IX_AVOpenSaveDialogParamsRec"></a><a name="IX_open_dialog_box"></a><a name="XREF_57499_Displaying_an_open"></a>Displaying an open dialog box</h3>
  <p class="BodyLevel1">You can display an open dialog box that enables a user to select a PDF document to open. In addition to describing how to create an open dialog box, this section also describes how to use a dialog box to create an <span class="FM_Courier">ASPathName</span>&#160;object and an <span class="FM_Courier">ASFileSys</span> object, which are both used to open a PDF document.</p>
  <p class="BodyLevel1">The <uservariable x-value="Acrobat" x-showvalue="TRUE" name="AcrobatProd" x-format="AcrobatProd">Acrobat</uservariable>&#160;core API has a typedef named <span class="FM_Courier">AVOpenSaveDialogParamsRec</span>&#160;that you use to display an open dialog box. The <span class="FM_Courier">AVOpenSaveDialogParamsRec</span>&#160;typedef contains the following attributes that you programmatically set:</p>
  <p class="FM_Indent1"><span class="FM_Bold">size</span>: The size of the <span class="FM_Courier">AVOpenSaveDialogParamsRec</span> object’s buffer.</p>
  <p class="FM_Indent1"><span class="FM_Bold">flags</span>: An <span class="FM_Courier">AVOpenSaveDialogFlags</span>&#160;value that specifies the dialog box’s appearance. The following values are valid:</p>
  <ul type="disc" style="Direction:Direction:ltr;
;
">
   <li>
   <p class="FM_Bullet2"><span class="FM_Bold">kAVOpenSaveAllowAllFlag</span>: Specifies <span class="FM_Courier">All Files</span>&#160;<span class="FM_Courier">(*.*)</span>&#160;for the dialog box. This value is only applicable for an open dialog box.</p>
</li>
   <li>
   <p class="FM_Bullet2"><span class="FM_Bold">kAVOpenSaveAllowMultiple</span>: Allows multiple files to be opened through the dialog box. This value is only applicable for an open dialog box.</p>
</li>
   <li>
   <p class="FM_Bullet2"><span class="FM_Bold">kAVOpenSaveAllowForeignFileSystems</span>: Allows file systems other than the default to be used to open the files. You need to select this value to open Unicode-named files. This value is only applicable for an open dialog box.</p>
</li>
   <li>
   <p class="FM_Bullet2"><span class="FM_Bold">kAVOpenSaveAllowSettingsButton</span>: Adds a settings button to the dialog box. This value is applicable to both open and save dialog boxes.</p>
</li>
   <li>
   <p class="FM_Bullet2"><span class="FM_Bold">kAVOpenSaveMergeTogetherPassedFilters</span>: Meaningful only for open dialog boxes with more than one filter.</p>
</li>
  </ul>
  <p class="FM_Indent1"><span class="FM_Bold">parentWindow</span>: An <span class="FM_Courier">AVWindow</span>&#160;object that specifies the parent window for the dialog box. This attribute is ignored on Mac OS. </p>
  <p class="FM_Indent1"><span class="FM_Bold">windowTitle</span>: An <span class="FM_Courier">ASText</span>&#160;object that specifies the title for the dialog box. This attribute can be <span class="FM_Courier">NULL</span>, in which case the default title is used. </p>
  <p class="FM_Indent1"><span class="FM_Bold">actionButtonTitle</span>: An <span class="FM_Courier">ASText</span>&#160;object that specifies the title of the action button. This attribute can be <span class="FM_Courier">NULL</span>, in which case the default title is used. </p>
  <p class="FM_Indent1"><span class="FM_Bold">cancelButtonTitle</span>: An <span class="FM_Courier">ASText</span>&#160;object that specifies the title of the cancel button. This attribute can be <span class="FM_Courier">NULL</span>, in which case the default title is used.</p>
  <p class="FM_Indent1"><span class="FM_Bold">initialFileSys</span>: An <span class="FM_Courier">ASFileSys</span>&#160;object that specifies the default file system. This value can be <span class="FM_Courier">NULL</span>&#160;if the <span class="FM_Courier">flags</span>&#160;attribute does not contain <span class="FM_Courier">kAVOpenSaveAllowForeignFileSystems</span>.</p>
  <p class="FM_Indent1"><span class="FM_Bold">initialPathName</span>: An <span class="FM_Courier">ASPathName</span>&#160;object that specifies an initial path location. This value can be &#160;<span class="FM_Courier">NULL</span>.</p>
  <p class="FM_Indent1"><span class="FM_Bold">initialFileName</span>: Specifies an initial file to save. This value is ignored for an open dialog box. </p>
  <p class="FM_Indent1"><span class="FM_Bold">fileFilters</span>: An array of pointers to addresses of <span class="FM_Courier">AVFileFilterRec</span>&#160;objects that act as a file filter (this attribute is set in the example that is described in this section). </p>
  <p class="FM_Indent1"><span class="FM_Bold">numFileFilters</span>: Specifies the number of <span class="FM_Courier">AVFileFilterRec</span>&#160;pointers assigned to the <span class="FM_Courier">fileFilters</span>&#160;attribute.</p>
  <p class="BodyLevel1">To display an open dialog box, perform the following tasks:</p>
  <p class="FM_StepReset"><span style="padding-left: 66pt;" class="FMAutoNumber_1"></span>1.<span style="padding-left: 2pt;" class="FMAutoNumber_2"></span>Create an <span class="FM_Courier">AVOpenSaveDialogParamsRec</span> object.</p>
  <p class="FM_CodeReference"><span style="font-family:'Times New Roman'; font-size:7.0pt">&nbsp;&nbsp;&nbsp;</span>AVOpenSaveDialogParamsRec dialogParams;</p>
  <p class="FM_Step"><span style="padding-left: 66pt;" class="FMAutoNumber_1"></span>2.<span style="padding-left: 2pt;" class="FMAutoNumber_2"></span>Create an <span class="FM_Courier">AVFileFilterRec</span>&#160;object used to store a series of file type descriptors that define a file filter for an open or save dialog box. Secondly, create a pointer to an <span class="FM_Courier">AVFileFilterRec</span>. </p>
  <p class="FM_CodeReference"><span style="font-family:'Times New Roman'; font-size:7.0pt">&nbsp;&nbsp;&nbsp;</span>AVFileFilterRec filterRec,*filterRecP;</p>
  <p class="FM_Step"><span style="padding-left: 66pt;" class="FMAutoNumber_1"></span>3.<span style="padding-left: 2pt;" class="FMAutoNumber_2"></span>Create an <span class="FM_Courier">AVFileDescRec</span> object used to store file extensions in an open dialog box.</p>
  <p class="FM_CodeReference"><span style="font-family:'Times New Roman'; font-size:7.0pt">&nbsp;&nbsp;&nbsp;</span>AVFileDescRec descRec;</p>
  <p class="FM_Step"><span style="padding-left: 66pt;" class="FMAutoNumber_1"></span>4.<span style="padding-left: 2pt;" class="FMAutoNumber_2"></span>Set the <span class="FM_Courier">AVFileDescRec</span>&#160;object’s <span class="FM_Courier">extension</span>&#160;attribute with the value <span class="FM_Courier">PDF</span>.</p>
  <p class="FM_CodeReference"><span style="font-family:'Times New Roman'; font-size:7.0pt">&nbsp;&nbsp;&nbsp;</span>strcpy (descRec.extension, &quot;pdf&quot;);</p>
  <p class="FM_Step"><span style="padding-left: 66pt;" class="FMAutoNumber_1"></span>5.<span style="padding-left: 2pt;" class="FMAutoNumber_2"></span>Allocate the size of the <span class="FM_Courier">AVFileFilterRec</span>&#160;object’s buffer by using the <span class="FM_Courier">memset</span>&#160;method. Next, set the <span class="FM_Courier">AVFileFilterRec</span>&#160;object’s <span class="FM_Courier">fileDescs</span>&#160;and <span class="FM_Courier">numFileDescs</span>&#160;attributes. The <span class="FM_Courier">fileDescs</span>&#160;attribute defines file type and extension information. You can assign the address of the <span class="FM_Courier">AVFileDescRec</span>&#160;object to the <span class="FM_Courier">fileDescs</span>&#160;attribute. The <span class="FM_Courier">numFileDescs</span>&#160;attribute specifies the number of <span class="FM_Courier">AVFileDescRecs</span>&#160;objects assigned to the <span class="FM_Courier">fileDescs</span>&#160;attribute. </p>
  <p class="FM_CodeReference"><span style="font-family:'Times New Roman'; font-size:7.0pt">&nbsp;&nbsp;&nbsp;</span>memset (&amp;filterRec, 0, sizeof(AVFileFilterRec));</p>
  <p class="FM_CodeReference"><span style="font-family:'Times New Roman'; font-size:7.0pt">&nbsp;&nbsp;&nbsp;</span>filterRec.fileDescs = &amp;descRec;</p>
  <p class="FM_CodeReference"><span style="font-family:'Times New Roman'; font-size:7.0pt">&nbsp;&nbsp;&nbsp;</span>filterRec.numFileDescs = 1;</p>
  <p class="FM_Step"><span style="padding-left: 66pt;" class="FMAutoNumber_1"></span>6.<span style="padding-left: 2pt;" class="FMAutoNumber_2"></span>Assign the <span class="FM_Courier">AVFileFilterRec</span>&#160;pointer with the address of the <span class="FM_Courier">AVFileFilterRec</span>&#160;object (this pointer is used to set an attribute that belongs to the <span class="FM_Courier">AVOpenSaveDialogParamsRec</span> object).</p>
  <p class="FM_CodeReference"><span style="font-family:'Times New Roman'; font-size:7.0pt">&nbsp;&nbsp;&nbsp;</span>filterRecP = &amp;filterRec;</p>
  <p class="FM_Step"><span style="padding-left: 66pt;" class="FMAutoNumber_1"></span>7.<span style="padding-left: 2pt;" class="FMAutoNumber_2"></span>Set attributes that belong to the <span class="FM_Courier">AVOpenSaveDialogParamsRec</span>&#160;object. In this example, the <span class="FM_Courier">size</span>, <span class="FM_Courier">fileFilters</span>, and <span class="FM_Courier">numFileFilters</span>&#160;attributes are set. Assign the <span class="FM_Courier">fileFilters</span>&#160;attribute with the address of the pointer that points to <span class="FM_Courier">AVFileFilterRec</span>.</p>
  <p class="FM_CodeReference"><span style="font-family:'Times New Roman'; font-size:7.0pt">&nbsp;&nbsp;&nbsp;</span>memset (&amp;dialogParams, 0, sizeof (AVOpenSaveDialogParamsRec));</p>
  <p class="FM_CodeReference"><span style="font-family:'Times New Roman'; font-size:7.0pt">&nbsp;&nbsp;&nbsp;</span>dialogParams.size = sizeof(AVOpenSaveDialogParamsRec);</p>
  <p class="FM_CodeReference"><span style="font-family:'Times New Roman'; font-size:7.0pt">&nbsp;&nbsp;&nbsp;</span>dialogParams.fileFilters = &amp;filterRecP;</p>
  <p class="FM_CodeReference"><span style="font-family:'Times New Roman'; font-size:7.0pt">&nbsp;&nbsp;&nbsp;</span>dialogParams.numFileFilters = 1;</p>
  <p class="FM_Step"><span style="padding-left: 66pt;" class="FMAutoNumber_1"></span>8.<span style="padding-left: 2pt;" class="FMAutoNumber_2"></span>Set the <span class="FM_Courier">AVFileFilterRec</span>&#160;object’s <span class="FM_Courier">filterDescription</span>&#160;attribute by invoking the <span class="FM_Courier">ASTextSetEncoded</span> method and passing the following arguments:</p>
  <ul type="disc" style="Direction:Direction:ltr;
;
">
   <li>
   <p class="FM_Bullet2">An <span class="FM_Courier">ASText</span> object that is used to store the string value.</p>
</li>
   <li>
   <p class="FM_Bullet2">A pointer to a <span class="FM_Courier">char</span> data type.</p>
</li>
   <li>
   <p class="FM_Bullet2">An <span class="FM_Courier">ASHostEncoding</span>&#160;value that specifies an encoding type. </p>
</li>
  </ul>
  <p class="FM_CodeReference"><span style="font-family:'Times New Roman'; font-size:7.0pt">&nbsp;&nbsp;&nbsp;</span>filterRec.filterDescription = ASTextNew();</p>
  <p class="FM_CodeReference"><span style="font-family:'Times New Roman'; font-size:7.0pt">&nbsp;&nbsp;&nbsp;</span>ASTextSetEncoded (filterRec.filterDescription, &quot;Adobe PDF Files&quot;,</p>
  <p class="FM_CodeReference"><span style="font-family:'Times New Roman'; font-size:7.0pt">&nbsp;&nbsp;&nbsp;</span>ASScriptToHostEncoding(kASRomanScript));</p>
  <p class="FM_Step"><span style="padding-left: 66pt;" class="FMAutoNumber_1"></span>9.<span style="padding-left: 2pt;" class="FMAutoNumber_2"></span>Set the <span class="FM_Courier">AVOpenSaveDialogParamsRec</span>&#160;object’s <span class="FM_Courier">windowTitle</span>&#160;attribute by invoking the <span class="FM_Courier">ASTextSetEncoded</span> method (see step 8 for a description of this method).</p>
  <p class="FM_CodeReference"><span style="font-family:'Times New Roman'; font-size:7.0pt">&nbsp;&nbsp;&nbsp;</span>dialogParams.windowTitle = ASTextNew();</p>
  <p class="FM_CodeReference"><span style="font-family:'Times New Roman'; font-size:7.0pt">&nbsp;&nbsp;&nbsp;</span>ASTextSetEncoded (dialogParams.windowTitle, &quot;Select A PDF Document </p>
  <p class="FM_CodeReference"><span style="font-family:'Times New Roman'; font-size:7.0pt">&nbsp;&nbsp;&nbsp;</span>To Open&quot;,</p>
  <p class="FM_CodeReference"><span style="font-family:'Times New Roman'; font-size:7.0pt">&nbsp;&nbsp;&nbsp;</span>ASScriptToHostEncoding(kASRomanScript));</p>
  <p class="FM_Step"><span style="padding-left: 66pt;" class="FMAutoNumber_1"></span>10.Display the open dialog box by invoking the <span class="FM_Courier">AVAppOpenDialog</span>&#160;method and passing the following arguments:</p>
  <ul type="disc" style="Direction:Direction:ltr;
;
">
   <li>
   <p class="FM_Bullet2">The address of an <span class="FM_Courier">AVOpenSaveDialogParams</span> object that represents the dialog box to open.</p>
</li>
   <li>
   <p class="FM_Bullet2">The address of an <span class="FM_Courier">ASFileSys</span>&#160;object. This method will populate the <span class="FM_Courier">ASFileSys</span>&#160;object with the file system in which the file that the user selects is located. This argument can be <span class="FM_Courier">NULL</span>&#160;if <span class="FM_Courier">kAVOpenSaveAllowForeignFileSystems</span>&#160;is not set as the <span class="FM_Courier">flags</span> value.</p>
</li>
   <li>
   <p class="FM_Bullet2">The address of a pointer that points to an <span class="FM_Courier">ASPathName</span>&#160;typedef. This argument is populated with the file that was select by the user. </p>
</li>
   <li>
   <p class="FM_Bullet2">The address of an <span class="FM_Courier">AVArraySize</span>&#160;object. This value can be NULL if <span class="FM_Courier">kAVOpenSaveAllowMultiple</span>&#160;is not set as the <span class="FM_Courier">flags</span> value.</p>
</li>
   <li>
   <p class="FM_Bullet2">The address of an <span class="FM_Courier">AVFilterIndex</span>&#160;object. This value can be NULL. </p>
</li>
  </ul>
  <p class="FM_Indent1">The <span class="FM_Courier">AVAppOpenDialog</span>&#160;method returns <span class="FM_Courier">true</span>&#160;if the user clicks the action button (for example, the Open button). If the user clicks the Cancel button, the method returns <span class="FM_Courier">false</span>. </p>
  <p class="FM_CodeReference"><span style="font-family:'Times New Roman'; font-size:7.0pt">&nbsp;&nbsp;&nbsp;</span>ASPathName * pathName = NULL;</p>
  <p class="FM_CodeReference"><span style="font-family:'Times New Roman'; font-size:7.0pt">&nbsp;&nbsp;&nbsp;</span>ASBool bSelected = AVAppOpenDialog(&amp;dialogParams, NULL,(ASPathName**)&amp;pathName, NULL, NULL);</p>
  <p class="FM_Step"><span style="padding-left: 66pt;" class="FMAutoNumber_1"></span>11.Release existing <span class="FM_Courier">ASText</span>&#160;objects by invoking the <span class="FM_Courier">ASTextDestroy</span> method.</p>
  <p class="FM_CodeReference"><span style="font-family:'Times New Roman'; font-size:7.0pt">&nbsp;&nbsp;&nbsp;</span>ASTextDestroy (filterRec.filterDescription);</p>
  <p class="FM_CodeReference"><span style="font-family:'Times New Roman'; font-size:7.0pt">&nbsp;&nbsp;&nbsp;</span>ASTextDestroy (dialogParams.windowTitle);</p>
  <p class="FM_Note"><span class="FM_Z_NoteCaution">Note:<span style="padding-left: 4pt;" class="FMAutoNumber_1"></span></span>This application logic is shown in <a href="Displaying_a_PDF_document_within_a_window.htm#XREF_11768_Example1_1_Opening">Opening a PDF document in an external window</a>.</p>
  </div>
</body>
</html>