<!DOCTYPE HTML>
<html>
<head>

 <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
 <title>Displaying a PDF document within a window</title>

 <meta name="generator" content="Adobe FrameMaker 2015" />
 <meta name="Originator" content="ImportMif" />
 <meta name="OriginalFile" content="C:\Users\Perforce\Work\Groups\SDK\main\Documents\Common\docs_fm\PluginAppsDeveloperGuide\Plugins_Documents.fm" />
 <link rel="stylesheet" href="Plugins_Documents.css" type="text/css" />


<script type="text/javascript" language="JavaScript">
//<![CDATA[
function reDo() {
  if (innerWidth != origWidth || innerHeight != origHeight)
     location.reload();
}
if ((parseInt(navigator.appVersion) == 4) && (navigator.appName == "Netscape")) {
	origWidth = innerWidth;
	origHeight = innerHeight;
	onresize = reDo;
}
onerror = null; 
//]]>
</script>
<style type="text/css">
<!--
div.WebHelpPopupMenu { position:absolute;
left:0px;
top:0px;
z-index:4;
visibility:hidden; }
p.WebHelpNavBar { text-align:right; }
-->
</style>

<script type="text/javascript" src="../../template/scripts/rh.min.js"></script>
<script type="text/javascript" src="../../template/scripts/common.min.js"></script>
<script type="text/javascript" src="../../template/scripts/topic.min.js"></script>
<script type="text/javascript" src="../../template/scripts/constants.js"></script>
<script type="text/javascript" src="../../template/scripts/utils.js"></script>
<script type="text/javascript" src="../../template/scripts/mhutils.js"></script>
<script type="text/javascript" src="../../template/scripts/mhlang.js"></script>
<script type="text/javascript" src="../../template/scripts/mhver.js"></script>
<script type="text/javascript" src="../../template/scripts/settings.js"></script>
<script type="text/javascript" src="../../template/scripts/XmlJsReader.js"></script>
<script type="text/javascript" src="../../template/scripts/loadparentdata.js"></script>
<script type="text/javascript" src="../../template/scripts/loadscreen.js"></script>
<script type="text/javascript" src="../../template/scripts/loadprojdata.js"></script>
<script type="text/javascript" src="../../template/scripts/mhtopic.js"></script>
 <link rel="stylesheet" type="text/css" href="../../template/styles/topic.min.css">
<script type="text/javascript" >
gRootRelPath = "../..";
gCommonRootRelPath = "../..";
gTopicId = "2.1.5.1.0_5";
</script>
 <meta name="brsprev" value="Acro12_MasterBook/Plugins_Documents/Displaying_an_open_dialog_box.htm">
 <meta name="brsnext" value="Acro12_MasterBook/Plugins_Documents/Determining_the_PDF_version_of_a_document.htm">
 <meta name="topic-breadcrumbs" content="Plug-ins and Applications > Overview > Working with Documents and Files > Opening a PDF document in an external window" />
</head>

<body dir="ltr">
<script type="text/javascript" src="../../ehlpdhtm.js"></script>
<div dir="ltr">
  <h3>Displaying a PDF document within a window</h3>
  <p class="BodyLevel1">Before you attempt to display a PDF document in an external window, you must programmatically create the window. (See <a href="Creating_a_Window.htm#XREF_99182_Creating_a_Window">Creating a Window</a>.)</p>
  <p class="BodyLevel1">To display a PDF document within an external window, perform the following tasks:</p>
  <p class="FM_StepReset"><a name="IX_ASFileSysOpenFile"></a><a name="IX_ASFileSysOpenFile_method"></a><span style="padding-left: 66pt;" class="FMAutoNumber_1"></span>1.<span style="padding-left: 2pt;" class="FMAutoNumber_2"></span>Open a PDF file by invoking the <span class="FM_Courier">ASFileSysOpenFile</span> method and passing the following arguments:</p>
  <ul type="disc" style="Direction:Direction:ltr;
;
">
   <li>
   <p class="FM_Bullet2">An <span class="FM_Courier">ASFileSys</span>&#160;object that represents the file system in which the PDF file is located. (See <a href="../Plugins_Unicode/Creating_an_ASFileSys_object.htm#XREF_67382_Creating_an">Creating an ASFileSys object</a>.)</p>
</li>
   <li>
   <p class="FM_Bullet2">An <span class="FM_Courier">ASPathName</span> object that represents the path in which the PDF file is located.</p>
</li>
   <li>
   <p class="FM_Bullet2">An <span class="FM_Courier">ASFileMode</span>&#160;object that represents the mode in which to open the file. For example, specify <span class="FM_Courier">ASFILE_READ</span> to open the PDF document in read mode.</p>
</li>
   <li>
   <p class="FM_Bullet2">The address of an <span class="FM_Courier">ASFile</span>&#160;object. This method populates this argument with the file that was opened (file information is obtained from the <span class="FM_Courier">ASPathName</span> object).</p>
</li>
  </ul>
  <p class="FM_Indent1">If the <span class="FM_Courier">ASFileSysOpenFile</span>&#160;method is successful, then <span class="FM_Courier">0</span>&#160;is returned. Otherwise, an error value is returned.</p>
  <p class="FM_Step"><span style="padding-left: 66pt;" class="FMAutoNumber_1"></span>2.<span style="padding-left: 2pt;" class="FMAutoNumber_2"></span>Display the PDF document within the window by invoking the <span class="FM_Courier">AVDocOpenFromASFileWithParams</span>&#160;method and passing the following arguments:</p>
  <ul type="disc" style="Direction:Direction:ltr;
;
">
   <li>
   <p class="FM_Bullet2">An <span class="FM_Courier">ASFile</span>&#160;object that specifies a PDF file to display (you can use the same <span class="FM_Courier">ASFile</span>&#160;object whose address was passed to the <span class="FM_Courier">ASFileSysOpenFile</span> method).</p>
</li>
   <li>
   <p class="FM_Bullet2">An <span class="FM_Courier">ASText</span>&#160;object that specifies the text to display in the window’s title bar. Create an <span class="FM_Courier">ASText</span>&#160;object by invoking the <span class="FM_Courier">ASTextFromScriptText</span> method.</p>
</li>
   <li>
   <p class="FM_Bullet2">The address of the <span class="FM_Courier">AVDocOpenParamsRec</span>&#160;object that you created. (See <a href="Defining_the_parameters_for_an_external_window.htm#XREF_64706_Creating_an">Defining the parameters for an external window </a>.)</p>
</li>
  </ul>
  <p class="BodyLevel1">The following code example opens a PDF document in an external window. The application logic that is located within the <span class="FM_Courier">OpenExternalWindow</span>&#160;user-defined function creates the window and displays a PDF document within the window. A structure named <span class="FM_Courier">gDocInfo</span>&#160;that stores information such as the file to open is also defined.</p>
  <p class="BodyLevel1">This code example contains a user-defined method named <span class="FM_Courier">AVWndProc</span>&#160;that acts as a window procedure and another user-defined function named <span class="FM_Courier">InitializeWindowHandler</span>&#160;that registers the windows class that is specified as an argument to <span class="FM_Courier">CreateWindow</span>. </p>
  <p class="BodyLevel1">Also shown in this code example is application logic that displays an open dialog box that enables a user to select a PDF file to open. This application logic is located within a user-defined function named <span class="FM_Courier">OpenPDFFile</span>. (See <a href="Displaying_an_open_dialog_box.htm#XREF_57499_Displaying_an_open">Displaying an open dialog box</a>.) </p>
  <ul type="disc" style="Direction:Direction:ltr;
;
">
   <li>
   <p class="FM_5Head_Example"><a name="XREF_11768_Example1_1_Opening"></a>Opening a PDF document in an external window</p>
</li>
  </ul>
  <p class="FM_CodeReference"><span class="FM_Courier">struct t_ExternDocInfo</span></p>
  <p class="FM_CodeReference"><span class="FM_Courier">{</span></p>
  <p class="FM_CodeReference"><span class="FM_Courier"><span style="font-family:'Times New Roman'; font-size:7.0pt">&nbsp;&nbsp;&nbsp;</span>AVDoc doc;</span></p>
  <p class="FM_CodeReference"><span class="FM_Courier"><span style="font-family:'Times New Roman'; font-size:7.0pt">&nbsp;&nbsp;&nbsp;</span>ASFile file;</span></p>
  <p class="FM_CodeReference"><span class="FM_Courier">} gDocInfo; </span></p>
  <p class="FM_CodeReference">&nbsp;</p>
  <p class="FM_CodeComment">//Create a function that opens a PDF document in an external window</p>
  <p class="FM_CodeReference"><span class="FM_Bold">ACCB1 void ACCB2 OpenExternalWindow (void * data)</span>&#160;</p>
  <p class="FM_CodeReference">{</p>
  <p class="FM_CodeComment">//Declare local variables</p>
  <p class="FM_CodeReference">ASPathName pathName;</p>
  <p class="FM_CodeReference">ASInt32 retVal;</p>
  <p class="FM_CodeReference">ASFileSys myFileSys;</p>
  <p class="FM_CodeReference">bool bWindowIsOpen = false;</p>
  <p class="FM_CodeReference">&nbsp;</p>
  <p class="FM_CodeComment">//Create an AVDocOpenParamsRec object</p>
  <p class="FM_CodeReference">AVDocOpenParamsRec params;</p>
  <p class="FM_CodeReference">&nbsp;</p>
  <p class="FM_CodeComment">//Declare an ExternalDocServerCreationDataRec object</p>
  <p class="FM_CodeReference">ExternalDocServerCreationDataRec creationData;</p>
  <p class="FM_CodeReference">&nbsp;</p>
  <p class="FM_CodeComment">//Invoke CreateWindow to obtain a handle to a window</p>
  <p class="FM_CodeReference">HWND externHWnd = CreateWindow (&quot;ExternalWindow&quot;, &quot;PDFViewer&quot;,</p>
  <p class="FM_CodeReference">WS_OVERLAPPEDWINDOW,50, 50, 500, 500, 0, 0, gHINSTANCE, NULL);</p>
  <p class="FM_CodeReference">if (externHWnd)</p>
  <p class="FM_CodeReference"><span style="font-family:'Times New Roman'; font-size:7.0pt">&nbsp;&nbsp;&nbsp;</span>{</p>
  <p class="FM_CodeComment"><span style="font-family:'Times New Roman'; font-size:7.0pt">&nbsp;&nbsp;&nbsp;</span>//Set attributes that belong to the AVDocOpenParamsRec object</p>
  <p class="FM_CodeReference"><span style="font-family:'Times New Roman'; font-size:7.0pt">&nbsp;&nbsp;&nbsp;</span>memset(&amp;params, 0, sizeof(AVDocOpenParamsRec));</p>
  <p class="FM_CodeReference"><span style="font-family:'Times New Roman'; font-size:7.0pt">&nbsp;&nbsp;&nbsp;</span>params.size = sizeof(AVDocOpenParamsRec);</p>
  <p class="FM_CodeReference"><span style="font-family:'Times New Roman'; font-size:7.0pt">&nbsp;&nbsp;&nbsp;</span>params.useFrame = false;</p>
  <p class="FM_CodeReference"><span style="font-family:'Times New Roman'; font-size:7.0pt">&nbsp;&nbsp;&nbsp;</span>params.useVisible = true;</p>
  <p class="FM_CodeReference"><span style="font-family:'Times New Roman'; font-size:7.0pt">&nbsp;&nbsp;&nbsp;</span>params.visible = true;</p>
  <p class="FM_CodeReference"><span style="font-family:'Times New Roman'; font-size:7.0pt">&nbsp;&nbsp;&nbsp;</span>params.useServerType = true;</p>
  <p class="FM_CodeReference"><span style="font-family:'Times New Roman'; font-size:7.0pt">&nbsp;&nbsp;&nbsp;</span>params.serverType = &quot;EXTERNAL&quot;;</p>
  <p class="FM_CodeReference"><span style="font-family:'Times New Roman'; font-size:7.0pt">&nbsp;&nbsp;&nbsp;</span>params.serverCreationData = (void*) &amp;creationData;</p>
  <p class="FM_CodeReference"><span style="font-family:'Times New Roman'; font-size:7.0pt">&nbsp;&nbsp;&nbsp;</span>params.useViewType = true;</p>
  <p class="FM_CodeReference"><span style="font-family:'Times New Roman'; font-size:7.0pt">&nbsp;&nbsp;&nbsp;</span>params.viewType = &quot;AVDocView&quot;;</p>
  <p class="FM_CodeReference"><span style="font-family:'Times New Roman'; font-size:7.0pt">&nbsp;&nbsp;&nbsp;</span>params.useReadOnly = true;</p>
  <p class="FM_CodeReference"><span style="font-family:'Times New Roman'; font-size:7.0pt">&nbsp;&nbsp;&nbsp;</span>params.readOnly = true;</p>
  <p class="FM_CodeReference"><span style="font-family:'Times New Roman'; font-size:7.0pt">&nbsp;&nbsp;&nbsp;</span>params.useSourceDoc = false;</p>
  <p class="FM_CodeReference"><span style="font-family:'Times New Roman'; font-size:7.0pt">&nbsp;&nbsp;&nbsp;</span>params.useViewDef = false;</p>
  <p class="FM_CodeReference">&nbsp;</p>
  <p class="FM_CodeComment"><span style="font-family:'Times New Roman'; font-size:7.0pt">&nbsp;&nbsp;&nbsp;</span>//Set attributes that belong to the ExternalDocServerCreationDataRec object</p>
  <p class="FM_CodeReference"><span style="font-family:'Times New Roman'; font-size:7.0pt">&nbsp;&nbsp;&nbsp;</span>memset(&amp;creationData, 0, sizeof(ExternalDocServerCreationDataRec));</p>
  <p class="FM_CodeReference"><span style="font-family:'Times New Roman'; font-size:7.0pt">&nbsp;&nbsp;&nbsp;</span>creationData.size = sizeof(ExternalDocServerCreationDataRec);</p>
  <p class="FM_CodeReference"><span style="font-family:'Times New Roman'; font-size:7.0pt">&nbsp;&nbsp;&nbsp;</span>creationData.platformWindow = (ExternalDocWindowData)externHWnd;</p>
  <p class="FM_CodeReference"><span style="font-family:'Times New Roman'; font-size:7.0pt">&nbsp;&nbsp;&nbsp;</span>creationData.acrobatProc = NULL;</p>
  <p class="FM_CodeReference"><span style="font-family:'Times New Roman'; font-size:7.0pt">&nbsp;&nbsp;&nbsp;</span>creationData.crossDocLinkWithDestData = (void *)externHWnd;</p>
  <p class="FM_CodeReference">&nbsp;</p>
  <p class="FM_CodeComment"><span style="font-family:'Times New Roman'; font-size:7.0pt">&nbsp;&nbsp;&nbsp;</span>//Invoke OpenPDFFile to display an open dialog box that</p>
  <p class="FM_CodeComment"><span style="font-family:'Times New Roman'; font-size:7.0pt">&nbsp;&nbsp;&nbsp;</span>//enables a user to select a PDF file</p>
  <p class="FM_CodeComment"><span style="font-family:'Times New Roman'; font-size:7.0pt">&nbsp;&nbsp;&nbsp;</span>//Pass the address of the ASFileSys object</p>
  <p class="FM_CodeReference"><span style="font-family:'Times New Roman'; font-size:7.0pt">&nbsp;&nbsp;&nbsp;</span>pathName = OpenPDFFile(&amp;myFileSys); </p>
  <p class="FM_CodeReference">&nbsp;</p>
  <p class="FM_CodeComment"><span style="font-family:'Times New Roman'; font-size:7.0pt">&nbsp;&nbsp;&nbsp;</span>//If PathName is valid</p>
  <p class="FM_CodeReference"><span style="font-family:'Times New Roman'; font-size:7.0pt">&nbsp;&nbsp;&nbsp;</span>if (pathName) {</p>
  <p class="FM_CodeReference">&nbsp;</p>
  <p class="FM_CodeComment"><span style="font-family:'Times New Roman'; font-size:7.0pt">&nbsp;&nbsp;&nbsp;</span>//Open the file specified in the file system</p>
  <p class="FM_CodeReference"><span style="font-family:'Times New Roman'; font-size:7.0pt">&nbsp;&nbsp;&nbsp;</span>retVal = ASFileSysOpenFile (myFileSys, pathName, ASFILE_READ,</p>
  <p class="FM_CodeReference"><span style="font-family:'Times New Roman'; font-size:7.0pt">&nbsp;&nbsp;&nbsp;</span>&amp;gDocInfo.file);</p>
  <p class="FM_CodeReference">&nbsp;</p>
  <p class="FM_CodeReference"><span style="font-family:'Times New Roman'; font-size:7.0pt">&nbsp;&nbsp;&nbsp;</span>if (retVal ==0) {</p>
  <p class="FM_CodeComment"><span style="font-family:'Times New Roman'; font-size:7.0pt">&nbsp;&nbsp;&nbsp;</span><span style="font-family:'Times New Roman'; font-size:7.0pt">&nbsp;&nbsp;&nbsp;</span>//Create a ASText object used to display in the new window </p>
  <p class="FM_CodeReference"><span style="font-family:'Times New Roman'; font-size:7.0pt">&nbsp;&nbsp;&nbsp;</span><span style="font-family:'Times New Roman'; font-size:7.0pt">&nbsp;&nbsp;&nbsp;</span>ASText title = ASTextFromScriptText (&quot;PDF Viewer&quot;, kASRomanScript);</p>
  <p class="FM_CodeReference"><span style="font-family:'Times New Roman'; font-size:7.0pt">&nbsp;&nbsp;&nbsp;</span><span style="font-family:'Times New Roman'; font-size:7.0pt">&nbsp;&nbsp;&nbsp;</span><span style="font-family:'Times New Roman'; font-size:7.0pt">&nbsp;&nbsp;&nbsp;</span><span style="font-family:'Times New Roman'; font-size:7.0pt">&nbsp;&nbsp;&nbsp;</span><span style="font-family:'Times New Roman'; font-size:7.0pt">&nbsp;&nbsp;&nbsp;</span></p>
  <p class="FM_CodeComment"><span style="font-family:'Times New Roman'; font-size:7.0pt">&nbsp;&nbsp;&nbsp;</span><span style="font-family:'Times New Roman'; font-size:7.0pt">&nbsp;&nbsp;&nbsp;</span>//Opens and displays a document from a file, using the specified </p>
  <p class="FM_CodeComment"><span style="font-family:'Times New Roman'; font-size:7.0pt">&nbsp;&nbsp;&nbsp;</span><span style="font-family:'Times New Roman'; font-size:7.0pt">&nbsp;&nbsp;&nbsp;</span>//parameters to control the window's size, location, and visibility</p>
  <p class="FM_CodeReference"><span style="font-family:'Times New Roman'; font-size:7.0pt">&nbsp;&nbsp;&nbsp;</span><span style="font-family:'Times New Roman'; font-size:7.0pt">&nbsp;&nbsp;&nbsp;</span>AVDocOpenFromASFileWithParams (gDocInfo.file, title, &amp;params);</p>
  <p class="FM_CodeReference"><span style="font-family:'Times New Roman'; font-size:7.0pt">&nbsp;&nbsp;&nbsp;</span><span style="font-family:'Times New Roman'; font-size:7.0pt">&nbsp;&nbsp;&nbsp;</span>ASTextDestroy(title);</p>
  <p class="FM_CodeReference"><span style="font-family:'Times New Roman'; font-size:7.0pt">&nbsp;&nbsp;&nbsp;</span><span style="font-family:'Times New Roman'; font-size:7.0pt">&nbsp;&nbsp;&nbsp;</span>bWindowIsOpen = true;</p>
  <p class="FM_CodeReference">} else</p>
  <p class="FM_CodeReference"><span style="font-family:'Times New Roman'; font-size:7.0pt">&nbsp;&nbsp;&nbsp;</span><span style="font-family:'Times New Roman'; font-size:7.0pt">&nbsp;&nbsp;&nbsp;</span>AVAlertNote(&quot;Failed to open document.&quot;);</p>
  <p class="FM_CodeReference"><span style="font-family:'Times New Roman'; font-size:7.0pt">&nbsp;&nbsp;&nbsp;</span>}</p>
  <p class="FM_CodeReference"> }</p>
  <p class="FM_CodeReference">}</p>
  <p class="FM_CodeReference">&nbsp;</p>
  <p class="FM_CodeComment">//Define the AVWndProc function</p>
  <p class="FM_CodeReference"><span class="FM_CourierBold">LRESULT CALLBACK AVWndProc(HWND hwnd, UINT msg, WPARAM wParam, LPARAM lParam)</span>&#160;</p>
  <p class="FM_CodeReference">{</p>
  <p class="FM_CodeReference">if (msg == WM_DESTROY)</p>
  <p class="FM_CodeReference"><span style="font-family:'Times New Roman'; font-size:7.0pt">&nbsp;&nbsp;&nbsp;</span>memset (&amp;gDocInfo, 0, sizeof(gDocInfo));</p>
  <p class="FM_CodeReference">return DefWindowProc (hwnd, msg, wParam, lParam);</p>
  <p class="FM_CodeReference">}</p>
  <p class="FM_CodeReference">&nbsp;</p>
  <p class="FM_CodeComment">//Define the InitializeWindowHandler function</p>
  <p class="FM_CodeReference">ASBool InitializeWindowHandler (void)</p>
  <p class="FM_CodeReference">{</p>
  <p class="FM_CodeReference">WNDCLASS wndClass ;</p>
  <p class="FM_CodeReference">&nbsp;</p>
  <p class="FM_CodeComment">//This is the window class used to display the PDF</p>
  <p class="FM_CodeReference">wndClass.cbClsExtra &#160;&#160;&#160;&#160;= 0;</p>
  <p class="FM_CodeReference">wndClass.hInstance &#160;&#160;&#160;&#160;&#160;= gHINSTANCE;</p>
  <p class="FM_CodeReference">wndClass.style<span style="font-family:'Times New Roman'; font-size:7.0pt">&nbsp;&nbsp;&nbsp;</span> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;= CS_DBLCLKS;</p>
  <p class="FM_CodeReference">wndClass.hCursor<span style="font-family:'Times New Roman'; font-size:7.0pt">&nbsp;&nbsp;&nbsp;</span> &#160;&#160;&#160;&#160;&#160;&#160;&#160;= (HCURSOR)NULL;</p>
  <p class="FM_CodeReference">wndClass.hbrBackground &#160;= (HBRUSH)NULL;</p>
  <p class="FM_CodeReference">wndClass.lpfnWndProc &#160;&#160;&#160;= AVWndProc;</p>
  <p class="FM_CodeReference">wndClass.hIcon<span style="font-family:'Times New Roman'; font-size:7.0pt">&nbsp;&nbsp;&nbsp;</span> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;= (HICON)NULL;</p>
  <p class="FM_CodeReference">wndClass.lpszMenuName &#160;&#160;= NULL;</p>
  <p class="FM_CodeReference">wndClass.cbWndExtra &#160;&#160;&#160;&#160;= 0;</p>
  <p class="FM_CodeReference">wndClass.lpszClassName &#160;= &quot;ExternalWindow&quot;;</p>
  <p class="FM_CodeReference"><span style="font-family:'Times New Roman'; font-size:7.0pt">&nbsp;&nbsp;&nbsp;</span></p>
  <p class="FM_CodeReference">if (!RegisterClass(&amp;wndClass))</p>
  <p class="FM_CodeReference"><span style="font-family:'Times New Roman'; font-size:7.0pt">&nbsp;&nbsp;&nbsp;</span>return false;</p>
  <p class="FM_CodeReference">return true;</p>
  <p class="FM_CodeReference">}</p>
  <p class="FM_CodeReference">&nbsp;</p>
  <p class="FM_CodeComment">//Display an open dialog box that enables a user to select a PDF file</p>
  <p class="FM_CodeReference"><span class="FM_Bold">ASPathName OpenPDFFile(ASFileSys * ASF)</span>&#160;</p>
  <p class="FM_CodeReference">{</p>
  <p class="FM_CodeComment">//Declare an AVOpenSaveDialogParamsRec object</p>
  <p class="FM_CodeReference">AVOpenSaveDialogParamsRec dialogParams;</p>
  <p class="FM_CodeReference">&nbsp;</p>
  <p class="FM_CodeComment">//Create local variables</p>
  <p class="FM_CodeReference">AVFileFilterRec filterRec,*filterRecP ;</p>
  <p class="FM_CodeReference">AVFileDescRec descRec;</p>
  <p class="FM_CodeReference">ASPathName * pathName = NULL;</p>
  <p class="FM_CodeReference">ASFileSys fileSys = NULL;</p>
  <p class="FM_CodeReference">ASBool bSelected = false; </p>
  <p class="FM_CodeReference">char errorBuf[256];</p>
  <p class="FM_CodeReference">&nbsp;</p>
  <p class="FM_CodeComment">//Set up the PDF file filter description</p>
  <p class="FM_CodeReference">strcpy (descRec.extension, &quot;pdf&quot;);</p>
  <p class="FM_CodeReference">descRec.macFileType = 'PDF ';</p>
  <p class="FM_CodeReference">descRec.macFileCreator = 'CARO';</p>
  <p class="FM_CodeReference">&nbsp;</p>
  <p class="FM_CodeComment">//Set attributes that belong to the AVFileFilterRec object</p>
  <p class="FM_CodeReference">memset (&amp;filterRec, 0, sizeof(AVFileFilterRec));</p>
  <p class="FM_CodeReference">filterRec.fileDescs = &amp;descRec;</p>
  <p class="FM_CodeReference">filterRec.numFileDescs = 1;</p>
  <p class="FM_CodeReference">filterRecP = &amp;filterRec;</p>
  <p class="FM_CodeReference">&nbsp;</p>
  <p class="FM_CodeComment">//Set attributes that belong to the AVOpenSaveDialogParamsRec object</p>
  <p class="FM_CodeReference">memset (&amp;dialogParams, 0, sizeof (AVOpenSaveDialogParamsRec));</p>
  <p class="FM_CodeReference">dialogParams.size = sizeof(AVOpenSaveDialogParamsRec);</p>
  <p class="FM_CodeReference">dialogParams.fileFilters = &amp;filterRecP;</p>
  <p class="FM_CodeReference">dialogParams.numFileFilters = 1;</p>
  <p class="FM_CodeReference">&nbsp;</p>
  <p class="FM_CodeReference">DURING</p>
  <p class="FM_CodeComment"><span style="font-family:'Times New Roman'; font-size:7.0pt">&nbsp;&nbsp;&nbsp;</span>//Set the AVFileFilterRec object’s filterDescription attribute</p>
  <p class="FM_CodeReference"><span style="font-family:'Times New Roman'; font-size:7.0pt">&nbsp;&nbsp;&nbsp;</span>filterRec.filterDescription = ASTextNew();</p>
  <p class="FM_CodeReference"><span style="font-family:'Times New Roman'; font-size:7.0pt">&nbsp;&nbsp;&nbsp;</span>ASTextSetEncoded (filterRec.filterDescription, &quot;Adobe PDF Files&quot;,</p>
  <p class="FM_CodeReference"><span style="font-family:'Times New Roman'; font-size:7.0pt">&nbsp;&nbsp;&nbsp;</span>ASScriptToHostEncoding(kASRomanScript));</p>
  <p class="FM_CodeReference">&nbsp;</p>
  <p class="FM_CodeComment"><span style="font-family:'Times New Roman'; font-size:7.0pt">&nbsp;&nbsp;&nbsp;</span>//Set the AVOpenSaveDialogParamsRec object's windowTitle attribute</p>
  <p class="FM_CodeReference"><span style="font-family:'Times New Roman'; font-size:7.0pt">&nbsp;&nbsp;&nbsp;</span>dialogParams.windowTitle = ASTextNew();</p>
  <p class="FM_CodeReference"><span style="font-family:'Times New Roman'; font-size:7.0pt">&nbsp;&nbsp;&nbsp;</span>ASTextSetEncoded (dialogParams.windowTitle, &quot;Select A PDF Document To<br />Open&quot;,ASScriptToHostEncoding(kASRomanScript));</p>
  <p class="FM_CodeReference">&nbsp;</p>
  <p class="FM_CodeComment"><span style="font-family:'Times New Roman'; font-size:7.0pt">&nbsp;&nbsp;&nbsp;</span>//Display the Open dialog box - pass the address of the ASFileSys object</p>
  <p class="FM_CodeReference"><span style="font-family:'Times New Roman'; font-size:7.0pt">&nbsp;&nbsp;&nbsp;</span>bSelected = AVAppOpenDialog(&amp;dialogParams, &amp;fileSys, (ASPathName**)&amp;pathName, NULL, NULL);</p>
  <p class="FM_CodeReference">&nbsp;</p>
  <p class="FM_CodeReference">HANDLER</p>
  <p class="FM_CodeComment"><span style="font-family:'Times New Roman'; font-size:7.0pt">&nbsp;&nbsp;&nbsp;</span>//Display an error message to the user</p>
  <p class="FM_CodeReference"><span style="font-family:'Times New Roman'; font-size:7.0pt">&nbsp;&nbsp;&nbsp;</span>ASGetErrorString (ASGetExceptionErrorCode(), errorBuf, 256);</p>
  <p class="FM_CodeReference"><span style="font-family:'Times New Roman'; font-size:7.0pt">&nbsp;&nbsp;&nbsp;</span>AVAlertNote (errorBuf);</p>
  <p class="FM_CodeReference">END_HANDLER</p>
  <p class="FM_CodeReference">&nbsp;</p>
  <p class="FM_CodeComment">//Destroy the ASText object then return</p>
  <p class="FM_CodeReference">ASTextDestroy (filterRec.filterDescription);</p>
  <p class="FM_CodeReference">ASTextDestroy (dialogParams.windowTitle);</p>
  <p class="FM_CodeReference">&nbsp;</p>
  <p class="FM_CodeComment">//Point the ASFileSys argument to the address of the ASFileSys object</p>
  <p class="FM_CodeReference">*ASF = fileSys;</p>
  <p class="FM_CodeReference">&nbsp;</p>
  <p class="FM_CodeReference">return bSelected ? *pathName : NULL;</p>
  <p class="FM_CodeReference">}</p>
  <p class="FM_Note"><span class="FM_Z_NoteCaution">Note:<span style="padding-left: 4pt;" class="FMAutoNumber_1"></span></span>The <span class="FM_Courier">OpenExternalWindow</span>&#160;function can be invoked from an <uservariable x-value="Acrobat&nbsp;Reader" x-showvalue="TRUE" name="AdobeReaderProd" x-format="AdobeReaderProd">Acrobat&nbsp;Reader</uservariable>&#160;or <uservariable x-value="Acrobat" x-showvalue="TRUE" name="AcrobatProd" x-format="AcrobatProd">Acrobat</uservariable>&#160;user interface component, such as a toolbar button or a menu command. Ensure that the <span class="FM_Courier">InitializeWindowHandler</span>&#160;method is invoked before the <span class="FM_Courier">OpenExternalWindow</span>&#160;method; otherwise, the window class is not registered and the PDF file is not displayed in the external window.</p>
  </div>
</body>
</html>