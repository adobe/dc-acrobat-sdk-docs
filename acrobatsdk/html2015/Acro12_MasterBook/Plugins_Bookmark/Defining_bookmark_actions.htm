<!DOCTYPE HTML>
<html>
<head>

 <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
 <title>Defining bookmark actions</title>

 <meta name="generator" content="Adobe FrameMaker 2015" />
 <meta name="Originator" content="ImportMif" />
 <meta name="OriginalFile" content="C:\Users\Perforce\Work\Groups\SDK\main\Documents\Common\docs_fm\PluginAppsDeveloperGuide\Plugins_Bookmark.fm" />
 <link rel="stylesheet" href="Plugins_Bookmark.css" type="text/css" />


<script type="text/javascript" language="JavaScript">
//<![CDATA[
function reDo() {
  if (innerWidth != origWidth || innerHeight != origHeight)
     location.reload();
}
if ((parseInt(navigator.appVersion) == 4) && (navigator.appName == "Netscape")) {
	origWidth = innerWidth;
	origHeight = innerHeight;
	onresize = reDo;
}
onerror = null; 
//]]>
</script>
<style type="text/css">
<!--
div.WebHelpPopupMenu { position:absolute;
left:0px;
top:0px;
z-index:4;
visibility:hidden; }
p.WebHelpNavBar { text-align:right; }
-->
</style>

<script type="text/javascript" src="../../template/scripts/rh.min.js"></script>
<script type="text/javascript" src="../../template/scripts/common.min.js"></script>
<script type="text/javascript" src="../../template/scripts/topic.min.js"></script>
<script type="text/javascript" src="../../template/scripts/constants.js"></script>
<script type="text/javascript" src="../../template/scripts/utils.js"></script>
<script type="text/javascript" src="../../template/scripts/mhutils.js"></script>
<script type="text/javascript" src="../../template/scripts/mhlang.js"></script>
<script type="text/javascript" src="../../template/scripts/mhver.js"></script>
<script type="text/javascript" src="../../template/scripts/settings.js"></script>
<script type="text/javascript" src="../../template/scripts/XmlJsReader.js"></script>
<script type="text/javascript" src="../../template/scripts/loadparentdata.js"></script>
<script type="text/javascript" src="../../template/scripts/loadscreen.js"></script>
<script type="text/javascript" src="../../template/scripts/loadprojdata.js"></script>
<script type="text/javascript" src="../../template/scripts/mhtopic.js"></script>
 <link rel="stylesheet" type="text/css" href="../../template/styles/topic.min.css">
<script type="text/javascript" >
gRootRelPath = "../..";
gCommonRootRelPath = "../..";
gTopicId = "2.1.9.1.1";
</script>
 <meta name="brsprev" value="Acro12_MasterBook/Plugins_Bookmark/Creating_bookmarks.htm">
 <meta name="brsnext" value="Acro12_MasterBook/Plugins_Bookmark/Removing_bookmark_actions.htm">
 <meta name="topic-breadcrumbs" content="Plug-ins and Applications > Overview > Working with Bookmarks > Creating bookmarks" />
</head>

<body dir="ltr">
<script type="text/javascript" src="../../ehlpdhtm.js"></script>
<div dir="ltr">
  <h3>Defining bookmark actions</h3>
  <p class="BodyLevel1">After you create a new bookmark, you must define an action that occurs when a user clicks on the bookmark. Otherwise, nothing occurs when a user clicks on the bookmark. </p>
  <p class="BodyLevel1">To create an action for a bookmark, you must create a <span class="FM_Courier">PDAction</span>&#160;object that represents the action that occurs when a user clicks on a bookmark. Once you create a <span class="FM_Courier">PDAction</span>&#160;object, you can assign it to a bookmark. (See <a href="#XREF_70965_Assigning_an">Assigning an action to a bookmark</a>.) </p>
  <p class="BodyLevel1">As specified earlier in this chapter, a typical bookmark action is to move to another location in the current document. To illustrate how to create a bookmark action, this section defines a bookmark action that displays a specific page in a PDF document when a user clicks the bookmark.</p>
  <p class="BodyLevel1"><a name="IX_PDActionNewFromDest_1"></a><a name="IX_PDActionNewFromDest"></a>To define a bookmark action that generates a specific view of a PDF document, you create a <span class="FM_Courier">PDAction</span>&#160;object by invoking the <span class="FM_Courier">PDActionNewFromDest</span>&#160;method. This method creates a new action that directs the user to the specified destination view and requires the following arguments:</p>
  <ul type="disc" style="Direction:Direction:ltr;
;
">
   <li>
   <p class="FM_Bullet1">A <span class="FM_Courier">PDDoc</span> that represents the PDF document for which the action is created.</p>
</li>
   <li>
   <p class="FM_Bullet1">A <span class="FM_Courier">PDViewDestination</span>&#160;object that represents a specific view in the PDF document. (See <a href="#XREF_74543_Creating_a">Creating a PDViewDestination object</a>.)</p>
</li>
   <li>
   <p class="FM_Bullet1">A <span class="FM_Courier">PDDoc</span>&#160;that represents the destination document. This object is the same object that is specified as the first parameter. </p>
</li>
  </ul>
  <p class="BodyLevel1">The <span class="FM_Courier">PDActionNewFromDest</span>&#160;method returns a <span class="FM_Courier">PDAction</span> method.</p>
  <h4><a name="TOC_Creating_a1"></a><a name="XREF_74543_Creating_a"></a>Creating a PDViewDestination object</h4>
  <p class="BodyLevel1"><a name="IX_AVPageViewToViewDest_1"></a><a name="IX_AVPageViewToViewDest"></a>You must create a <span class="FM_Courier">PDViewDestination</span>&#160;object in order to invoke the <span class="FM_Courier">PDActionNewFromDest</span>&#160;method. To create a <span class="FM_Courier">PDViewDestination</span>&#160;object, invoke the <span class="FM_Courier">AVPageViewToViewDest</span>&#160;method and pass the following arguments:</p>
  <ul type="disc" style="Direction:Direction:ltr;
;
">
   <li>
   <p class="FM_Bullet1">An <span class="FM_Courier">AVPageView</span>&#160;object that represents the page view from which the destination is created. For information about creating this object, see <a href="#XREF_24473_Creating_a">Creating a AVPageView object</a>.</p>
</li>
   <li>
   <p class="FM_Bullet1">An <span class="FM_Courier">ASAtom</span> object that specifies the fit type of the view destination (see the table that follows this list).</p>
</li>
   <li>
   <p class="FM_Bullet1">A <span class="FM_Courier">PDDoc</span>&#160;object that represents the PDF document for which the view is established. </p>
</li>
  </ul>
  <p class="BodyLevel1">The <span class="FM_Courier">AVPageViewToViewDest</span>&#160;method returns a <span class="FM_Courier">PDViewDestination</span>&#160;object. The following table specifies the fit type values that you pass to the <span class="FM_Courier">AVPageViewToViewDest</span>&#160;method as the second argument.</p>
<div width="100%" align="left">
  <table dir="ltr" style=" border-spacing:0; padding-top:6.00pt; padding-right:6.00pt; padding-bottom:6.00pt; float:alignleft; width:100%; direction:ltr; max-width:460.80pt;" cellspacing="0">
   <tr style=" height : 22.50pt;">
   <th style="width : 46.800pt; border-top-style: solid; border-top-width: 1px; border-top-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-bottom-color: #000000; vertical-align : top;padding-left: 6.00pt; padding-top: 3.00pt; padding-right: 6.00pt; padding-bottom: 3.00pt;">
   <p class="FM_TableHead">Value</p>
</th>
   <th style="width : 414.000pt; border-top-style: solid; border-top-width: 1px; border-top-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; border-bottom-color: #000000; vertical-align : top;padding-left: 6.00pt; padding-top: 3.00pt; padding-right: 6.00pt; padding-bottom: 3.00pt;">
   <p class="FM_TableHead">Description</p>
</th>
</tr>
   <tr style=" height : 22.50pt;">
   <td style="width : 46.800pt; border-bottom-style: solid; border-bottom-width: 0px; border-bottom-color: #999999; vertical-align : top;padding-left: 6.00pt; padding-top: 3.00pt; padding-right: 6.00pt; padding-bottom: 3.00pt;">
   <p class="FM_CodeReference">XYZ</p>
</td>
   <td style="width : 414.000pt; border-bottom-style: solid; border-bottom-width: 0px; border-bottom-color: #999999; vertical-align : top;padding-left: 6.00pt; padding-top: 3.00pt; padding-right: 6.00pt; padding-bottom: 3.00pt;">
   <p class="FM_TableBody">Destination specified as upper-left corner point and a zoom factor.</p>
</td>
</tr>
   <tr style=" height : 22.50pt;">
   <td style="width : 46.800pt; border-bottom-style: solid; border-bottom-width: 0px; border-bottom-color: #999999; vertical-align : top;padding-left: 6.00pt; padding-top: 3.00pt; padding-right: 6.00pt; padding-bottom: 3.00pt;">
   <p class="FM_CodeReference">Fit</p>
</td>
   <td style="width : 414.000pt; border-bottom-style: solid; border-bottom-width: 0px; border-bottom-color: #999999; vertical-align : top;padding-left: 6.00pt; padding-top: 3.00pt; padding-right: 6.00pt; padding-bottom: 3.00pt;">
   <p class="FM_TableBody">Fits the page into the window, corresponding to the <uservariable x-value="Acrobat" x-showvalue="TRUE" name="AcrobatProd" x-format="AcrobatProd">Acrobat</uservariable> viewer’s Fit Page menu item.</p>
</td>
</tr>
   <tr style=" height : 35.00pt;">
   <td style="width : 46.800pt; border-bottom-style: solid; border-bottom-width: 0px; border-bottom-color: #999999; vertical-align : top;padding-left: 6.00pt; padding-top: 3.00pt; padding-right: 6.00pt; padding-bottom: 3.00pt;">
   <p class="FM_CodeReference">FitH</p>
</td>
   <td style="width : 414.000pt; border-bottom-style: solid; border-bottom-width: 0px; border-bottom-color: #999999; vertical-align : top;padding-left: 6.00pt; padding-top: 3.00pt; padding-right: 6.00pt; padding-bottom: 3.00pt;">
   <p class="FM_TableBody">Fits the width of the page into the window, corresponding to the <uservariable x-value="Acrobat" x-showvalue="TRUE" name="AcrobatProd" x-format="AcrobatProd">Acrobat</uservariable>&#160;viewer’s Fit Width menu item.</p>
</td>
</tr>
   <tr style=" height : 22.50pt;">
   <td style="width : 46.800pt; border-bottom-style: solid; border-bottom-width: 0px; border-bottom-color: #999999; vertical-align : top;padding-left: 6.00pt; padding-top: 3.00pt; padding-right: 6.00pt; padding-bottom: 3.00pt;">
   <p class="FM_CodeReference">FitV</p>
</td>
   <td style="width : 414.000pt; border-bottom-style: solid; border-bottom-width: 0px; border-bottom-color: #999999; vertical-align : top;padding-left: 6.00pt; padding-top: 3.00pt; padding-right: 6.00pt; padding-bottom: 3.00pt;">
   <p class="FM_TableBody">Fits the height of the page into a window.</p>
</td>
</tr>
   <tr style=" height : 22.50pt;">
   <td style="width : 46.800pt; border-bottom-style: solid; border-bottom-width: 0px; border-bottom-color: #999999; vertical-align : top;padding-left: 6.00pt; padding-top: 3.00pt; padding-right: 6.00pt; padding-bottom: 3.00pt;">
   <p class="FM_CodeReference">FitR</p>
</td>
   <td style="width : 414.000pt; border-bottom-style: solid; border-bottom-width: 0px; border-bottom-color: #999999; vertical-align : top;padding-left: 6.00pt; padding-top: 3.00pt; padding-right: 6.00pt; padding-bottom: 3.00pt;">
   <p class="FM_TableBody">Fits the rectangle specified by its upper-left and lower-right corner points into the window.</p>
</td>
</tr>
   <tr style=" height : 35.00pt;">
   <td style="width : 46.800pt; border-bottom-style: solid; border-bottom-width: 0px; border-bottom-color: #999999; vertical-align : top;padding-left: 6.00pt; padding-top: 3.00pt; padding-right: 6.00pt; padding-bottom: 3.00pt;">
   <p class="FM_CodeReference">FitB</p>
</td>
   <td style="width : 414.000pt; border-bottom-style: solid; border-bottom-width: 0px; border-bottom-color: #999999; vertical-align : top;padding-left: 6.00pt; padding-top: 3.00pt; padding-right: 6.00pt; padding-bottom: 3.00pt;">
   <p class="FM_TableBody">Fits the rectangle containing all visible elements on the page (known as the bounding box) into the window (corresponds to the <uservariable x-value="Acrobat" x-showvalue="TRUE" name="AcrobatProd" x-format="AcrobatProd">Acrobat</uservariable> viewer’s Fit Visible menu item).</p>
</td>
</tr>
   <tr style=" height : 22.50pt;">
   <td style="width : 46.800pt; border-bottom-style: solid; border-bottom-width: 0px; border-bottom-color: #999999; vertical-align : top;padding-left: 6.00pt; padding-top: 3.00pt; padding-right: 6.00pt; padding-bottom: 3.00pt;">
   <p class="FM_CodeReference">FitBH</p>
</td>
   <td style="width : 414.000pt; border-bottom-style: solid; border-bottom-width: 0px; border-bottom-color: #999999; vertical-align : top;padding-left: 6.00pt; padding-top: 3.00pt; padding-right: 6.00pt; padding-bottom: 3.00pt;">
   <p class="FM_TableBody">Fits the width of the bounding box into the window.</p>
</td>
</tr>
   <tr style=" height : 22.50pt;">
   <td style="width : 46.800pt; border-bottom-style: solid; border-bottom-width: 1px; border-bottom-color: #000000; vertical-align : top;padding-left: 6.00pt; padding-top: 3.00pt; padding-right: 6.00pt; padding-bottom: 3.00pt;">
   <p class="FM_CodeReference">FitBV</p>
</td>
   <td style="width : 414.000pt; border-bottom-style: solid; border-bottom-width: 1px; border-bottom-color: #000000; vertical-align : top;padding-left: 6.00pt; padding-top: 3.00pt; padding-right: 6.00pt; padding-bottom: 3.00pt;">
   <p class="FM_TableBody">Fits the height of the bounding box into the window.</p>
</td>
</tr>
  </table>
</div>
  <h4><a name="TOC_Creating_a_AVPageView"></a><a name="IX_AVDocFromPDDoc"></a><a name="IX_AVDocFromPDDoc_method"></a><a name="IX_AVDocGetPageView"></a><a name="IX_AVDocGetPageView_method"></a><a name="IX_page_views"></a><a name="XREF_24473_Creating_a"></a>Creating a AVPageView object</h4>
  <p class="BodyLevel1">You must create an <span class="FM_Courier">AVPageView</span>&#160;object that represents the page view in order to invoke the <span class="FM_Courier">AVPageViewToViewDest</span>&#160;method. You can create an <span class="FM_Courier">AVPageView</span>&#160;object by invoking the <span class="FM_Courier">AVDocGetPageView</span>&#160;method. This method requires an <span class="FM_Courier">AVDoc</span>&#160;that represents a PDF document whose page view is obtained and returns an <span class="FM_Courier">AVPageView</span>&#160;object. </p>
  <p class="BodyLevel1">You can create an <span class="FM_Courier">AVDoc</span>&#160;object that is based on the <span class="FM_Courier">PDDoc</span>&#160;object that already exists by invoking the <span class="FM_Courier">AVDocFromPDDo</span>c method and passing the <span class="FM_Courier">PDDoc</span>&#160;object. You can invoke this method as an argument for the <span class="FM_Courier">AVDocGetPageView</span>&#160;method. </p>
  <p class="FM_CodeReference"><span style="font-family:'Times New Roman'; font-size:7.0pt">&nbsp;&nbsp;&nbsp;</span>AVPageView myPageView = AVDocGetPageView(AVDocFromPDDoc(myPDDoc));</p>
  <p class="BodyLevel1">Once you create an <span class="FM_Courier">AVPageView</span>&#160;object, you can specify a specific PDF document page number by invoking the <span class="FM_Courier">AVPageViewGoTo</span>&#160;method and passing the <span class="FM_Courier">AVPageView</span>&#160;object and an <span class="FM_Courier">ASInt32</span>&#160;object that represents the page number: </p>
  <p class="FM_CodeReference"><span style="font-family:'Times New Roman'; font-size:7.0pt">&nbsp;&nbsp;&nbsp;</span>ASInt32 pNum = 2; </p>
  <p class="FM_CodeReference"><span style="font-family:'Times New Roman'; font-size:7.0pt">&nbsp;&nbsp;&nbsp;</span>AVPageViewGoTo(myPageView,pNum);</p>
  <h4><a name="TOC_Assigning_an_action_to_a"></a><a name="IX_PDBookmarkSetAction_1"></a><a name="IX_PDBookmarkSetAction"></a><a name="IX_bookmark_actions"></a><a name="IX_assigning_actions"></a><a name="XREF_70965_Assigning_an"></a>Assigning an action to a bookmark</h4>
  <p class="BodyLevel1">After you create both an <span class="FM_Courier">AVPageView</span>&#160;object and an <span class="FM_Courier">PDViewDestination</span>&#160;object, you can create a <span class="FM_Courier">PDAction</span>&#160;object and assign it to a specific bookmark by invoking the <span class="FM_Courier">PDBookmarkSetAction</span>&#160;method and passing the <span class="FM_Courier">PDBookmark</span>&#160;object and the <span class="FM_Courier">PDAction</span>&#160;object as arguments. </p>
  <p class="BodyLevel1">The following code example creates a <span class="FM_Courier">PDAction</span>&#160;object and assigns it to a bookmark that is represented by a <span class="FM_Courier">PDBookmark</span>&#160;object named <span class="FM_Courier">childBookmark</span>. </p>
  <ul type="disc" style="Direction:Direction:ltr;
;
">
   <li>
   <p class="FM_5Head_Example">Assigning an action to a bookmark</p>
</li>
  </ul>
  <p class="FM_CodeComment">//Create a PDDoc object based on the current PDF document</p>
  <p class="FM_CodeReference">AVDoc avDoc = AVAppGetActiveDoc();</p>
  <p class="FM_CodeReference">AVPageView pageView = AVDocGetPageView(avDoc);</p>
  <p class="FM_CodeReference">PDPageNumber pageNum = AVPageViewGetPageNum(pageView);</p>
  <p class="FM_CodeReference">PDDoc myPDDoc = AVDocGetPDDoc(avDoc);</p>
  <p class="FM_CodeReference">&nbsp;</p>
  <p class="FM_CodeComment">//Create a AVPageView object that represents the page view of a document</p>
  <p class="FM_CodeReference">AVPageView myPageView = AVDocGetPageView(AVDocFromPDDoc(myPDDoc)); </p>
  <p class="FM_CodeReference">&nbsp;</p>
  <p class="FM_CodeComment">//Set the page view to the second page</p>
  <p class="FM_CodeReference">ASInt32 pNum = 2;</p>
  <p class="FM_CodeReference">AVPageViewGoTo(myPageView,pNum);</p>
  <p class="FM_CodeReference">&nbsp;</p>
  <p class="FM_CodeComment">//Create an PDViewDestination object that is used to create a PDAction object</p>
  <p class="FM_CodeReference">PDViewDestination pdvDes = AVPageViewToViewDest(myPageView,ASAtomFromString(&quot;Fit&quot;),myPDDoc);</p>
  <p class="FM_CodeReference">&nbsp;</p>
  <p class="FM_CodeComment">//Create a PDAction object </p>
  <p class="FM_CodeReference">PDAction myAction = PDActionNewFromDest(myPDDoc,pdvDes,myPDDoc);</p>
  <p class="FM_CodeReference">&nbsp;</p>
  <p class="FM_CodeComment">//Attach an action to the bookmark</p>
  <p class="FM_CodeReference">PDBookmarkSetAction(childBookmark,myAction); </p>
  <p class="FM_NoteCaution"><span class="FM_Z_NoteCaution">Caution:<span style="padding-left: 7pt;" class="FMAutoNumber_1"></span></span>When running this code example, you must have the PDF document on which the <span class="FM_Courier">PDDoc</span>&#160;object is based open. Otherwise, a run-time error occurs. Also, you must create a <span class="FM_Courier">PDBookmark</span>&#160;object named <span class="FM_Courier">childBookmark</span>. (See <a href="Creating_bookmarks.htm#XREF_40935_Creating_bookmarks">Creating bookmarks</a>.) </p>
  </div>
</body>
</html>